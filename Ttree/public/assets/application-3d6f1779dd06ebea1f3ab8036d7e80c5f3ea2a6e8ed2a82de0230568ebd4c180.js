function Matrix(){}(function(){}).call(this),function(){var e=[].slice;this.ActionCable={INTERNAL:{message_types:{welcome:"welcome",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]},createConsumer:function(e){var t;return null==e&&(e=null!=(t=this.getConfig("url"))?t:this.INTERNAL.default_mount_path),new ActionCable.Consumer(this.createWebSocketURL(e))},getConfig:function(e){var t;return t=document.head.querySelector("meta[name='action-cable-"+e+"']"),null!=t?t.getAttribute("content"):void 0},createWebSocketURL:function(e){var t;return e&&!/^wss?:/i.test(e)?(t=document.createElement("a"),t.href=e,t.href=t.href,t.protocol=t.protocol.replace("http","ws"),t.href):e},startDebugging:function(){return this.debugging=!0},stopDebugging:function(){return this.debugging=null},log:function(){var t;if(t=1<=arguments.length?e.call(arguments,0):[],this.debugging)return t.push(Date.now()),console.log.apply(console,["[ActionCable]"].concat(e.call(t)))}},"undefined"!=typeof window&&null!==window&&(window.ActionCable=this.ActionCable),"undefined"!=typeof module&&null!==module&&(module.exports=this.ActionCable)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};ActionCable.ConnectionMonitor=function(){function t(t){this.connection=t,this.visibilityDidChange=e(this.visibilityDidChange,this),this.reconnectAttempts=0}var n,r,i;return t.pollInterval={min:3,max:30},t.staleThreshold=6,t.prototype.start=function(){if(!this.isRunning())return this.startedAt=r(),delete this.stoppedAt,this.startPolling(),document.addEventListener("visibilitychange",this.visibilityDidChange),ActionCable.log("ConnectionMonitor started. pollInterval = "+this.getPollInterval()+" ms")},t.prototype.stop=function(){if(this.isRunning())return this.stoppedAt=r(),this.stopPolling(),document.removeEventListener("visibilitychange",this.visibilityDidChange),ActionCable.log("ConnectionMonitor stopped")},t.prototype.isRunning=function(){return null!=this.startedAt&&null==this.stoppedAt},t.prototype.recordPing=function(){return this.pingedAt=r()},t.prototype.recordConnect=function(){return this.reconnectAttempts=0,this.recordPing(),delete this.disconnectedAt,ActionCable.log("ConnectionMonitor recorded connect")},t.prototype.recordDisconnect=function(){return this.disconnectedAt=r(),ActionCable.log("ConnectionMonitor recorded disconnect")},t.prototype.startPolling=function(){return this.stopPolling(),this.poll()},t.prototype.stopPolling=function(){return clearTimeout(this.pollTimeout)},t.prototype.poll=function(){return this.pollTimeout=setTimeout(function(e){return function(){return e.reconnectIfStale(),e.poll()}}(this),this.getPollInterval())},t.prototype.getPollInterval=function(){var e,t,r,i;return i=this.constructor.pollInterval,r=i.min,t=i.max,e=5*Math.log(this.reconnectAttempts+1),Math.round(1e3*n(e,r,t))},t.prototype.reconnectIfStale=function(){if(this.connectionIsStale())return ActionCable.log("ConnectionMonitor detected stale connection. reconnectAttempts = "+this.reconnectAttempts+", pollInterval = "+this.getPollInterval()+" ms, time disconnected = "+i(this.disconnectedAt)+" s, stale threshold = "+this.constructor.staleThreshold+" s"),this.reconnectAttempts++,this.disconnectedRecently()?ActionCable.log("ConnectionMonitor skipping reopening recent disconnect"):(ActionCable.log("ConnectionMonitor reopening"),this.connection.reopen())},t.prototype.connectionIsStale=function(){var e;return i(null!=(e=this.pingedAt)?e:this.startedAt)>this.constructor.staleThreshold},t.prototype.disconnectedRecently=function(){return this.disconnectedAt&&i(this.disconnectedAt)<this.constructor.staleThreshold},t.prototype.visibilityDidChange=function(){if("visible"===document.visibilityState)return setTimeout(function(e){return function(){if(e.connectionIsStale()||!e.connection.isOpen())return ActionCable.log("ConnectionMonitor reopening stale connection on visibilitychange. visbilityState = "+document.visibilityState),e.connection.reopen()}}(this),200)},r=function(){return(new Date).getTime()},i=function(e){return(r()-e)/1e3},n=function(e,t,n){return Math.max(t,Math.min(n,e))},t}()}.call(this),function(){var e,t,n,r,i,s,o=[].slice,a=function(e,t){return function(){return e.apply(t,arguments)}},l=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r=ActionCable.INTERNAL,t=r.message_types,n=r.protocols,i=2<=n.length?o.call(n,0,e=n.length-1):(e=0,[]),s=n[e++],ActionCable.Connection=function(){function e(e){this.consumer=e,this.open=a(this.open,this),this.subscriptions=this.consumer.subscriptions,this.monitor=new ActionCable.ConnectionMonitor(this),this.disconnected=!0}return e.reopenDelay=500,e.prototype.send=function(e){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(e)),!0)},e.prototype.open=function(){if(this.isActive())throw ActionCable.log("Attempted to open WebSocket, but existing socket is "+this.getState()),new Error("Existing connection must be closed before opening");return ActionCable.log("Opening WebSocket, current state is "+this.getState()+", subprotocols: "+n),null!=this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new WebSocket(this.consumer.url,n),this.installEventHandlers(),this.monitor.start(),!0},e.prototype.close=function(e){var t,n;if(t=(null!=e?e:{allowReconnect:!0}).allowReconnect,t||this.monitor.stop(),this.isActive())return null!=(n=this.webSocket)?n.close():void 0},e.prototype.reopen=function(){var e;if(ActionCable.log("Reopening WebSocket, current state is "+this.getState()),!this.isActive())return this.open();try{return this.close()}catch(t){return e=t,ActionCable.log("Failed to reopen WebSocket",e)}finally{ActionCable.log("Reopening WebSocket in "+this.constructor.reopenDelay+"ms"),setTimeout(this.open,this.constructor.reopenDelay)}},e.prototype.getProtocol=function(){var e;return null!=(e=this.webSocket)?e.protocol:void 0},e.prototype.isOpen=function(){return this.isState("open")},e.prototype.isActive=function(){return this.isState("open","connecting")},e.prototype.isProtocolSupported=function(){var e;return e=this.getProtocol(),l.call(i,e)>=0},e.prototype.isState=function(){var e,t;return t=1<=arguments.length?o.call(arguments,0):[],e=this.getState(),l.call(t,e)>=0},e.prototype.getState=function(){var e,t,n;for(t in WebSocket)if(n=WebSocket[t],n===(null!=(e=this.webSocket)?e.readyState:void 0))return t.toLowerCase();return null},e.prototype.installEventHandlers=function(){var e,t;for(e in this.events)t=this.events[e].bind(this),this.webSocket["on"+e]=t},e.prototype.uninstallEventHandlers=function(){var e;for(e in this.events)this.webSocket["on"+e]=function(){}},e.prototype.events={message:function(e){var n,r,i,s;if(this.isProtocolSupported())switch(i=JSON.parse(e.data),n=i.identifier,r=i.message,s=i.type,s){case t.welcome:return this.monitor.recordConnect(),this.subscriptions.reload();case t.ping:return this.monitor.recordPing();case t.confirmation:return this.subscriptions.notify(n,"connected");case t.rejection:return this.subscriptions.reject(n);default:return this.subscriptions.notify(n,"received",r)}},open:function(){if(ActionCable.log("WebSocket onopen event, using '"+this.getProtocol()+"' subprotocol"),this.disconnected=!1,!this.isProtocolSupported())return ActionCable.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close:function(){if(ActionCable.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error:function(){return ActionCable.log("WebSocket onerror event")}},e}()}.call(this),function(){var e=[].slice;ActionCable.Subscriptions=function(){function t(e){this.consumer=e,this.subscriptions=[]}return t.prototype.create=function(e,t){var n,r,i;return n=e,r="object"==typeof n?n:{channel:n},i=new ActionCable.Subscription(this.consumer,r,t),this.add(i)},t.prototype.add=function(e){return this.subscriptions.push(e),this.consumer.ensureActiveConnection(),this.notify(e,"initialized"),this.sendCommand(e,"subscribe"),e},t.prototype.remove=function(e){return this.forget(e),this.findAll(e.identifier).length||this.sendCommand(e,"unsubscribe"),e},t.prototype.reject=function(e){var t,n,r,i,s;for(r=this.findAll(e),i=[],t=0,n=r.length;t<n;t++)s=r[t],this.forget(s),this.notify(s,"rejected"),i.push(s);return i},t.prototype.forget=function(e){var t;return this.subscriptions=function(){var n,r,i,s;for(i=this.subscriptions,s=[],n=0,r=i.length;n<r;n++)t=i[n],t!==e&&s.push(t);return s}.call(this),e},t.prototype.findAll=function(e){var t,n,r,i,s;for(r=this.subscriptions,i=[],t=0,n=r.length;t<n;t++)s=r[t],s.identifier===e&&i.push(s);return i},t.prototype.reload=function(){var e,t,n,r,i;for(n=this.subscriptions,r=[],e=0,t=n.length;e<t;e++)i=n[e],r.push(this.sendCommand(i,"subscribe"));return r},t.prototype.notifyAll=function(){var t,n,r,i,s,o,a;for(n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],s=this.subscriptions,o=[],r=0,i=s.length;r<i;r++)a=s[r],o.push(this.notify.apply(this,[a,n].concat(e.call(t))));return o},t.prototype.notify=function(){var t,n,r,i,s,o,a;for(o=arguments[0],n=arguments[1],t=3<=arguments.length?e.call(arguments,2):[],a="string"==typeof o?this.findAll(o):[o],s=[],r=0,i=a.length;r<i;r++)o=a[r],s.push("function"==typeof o[n]?o[n].apply(o,t):void 0);return s},t.prototype.sendCommand=function(e,t){var n;return n=e.identifier,this.consumer.send({command:t,identifier:n})},t}()}.call(this),function(){ActionCable.Subscription=function(){function e(e,n,r){this.consumer=e,null==n&&(n={}),this.identifier=JSON.stringify(n),t(this,r)}var t;return e.prototype.perform=function(e,t){return null==t&&(t={}),t.action=e,this.send(t)},e.prototype.send=function(e){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(e)})},e.prototype.unsubscribe=function(){return this.consumer.subscriptions.remove(this)},t=function(e,t){var n,r;if(null!=t)for(n in t)r=t[n],e[n]=r;return e},e}()}.call(this),function(){ActionCable.Consumer=function(){function e(e){this.url=e,this.subscriptions=new ActionCable.Subscriptions(this),this.connection=new ActionCable.Connection(this)}return e.prototype.send=function(e){return this.connection.send(e)},e.prototype.connect=function(){return this.connection.open()},e.prototype.disconnect=function(){return this.connection.close({allowReconnect:!1})},e.prototype.ensureActiveConnection=function(){if(!this.connection.isActive())return this.connection.open()},e}()}.call(this),function(){this.App||(this.App={}),App.cable=ActionCable.createConsumer()}.call(this);var CircularJSON=function(e,t){function n(e,t,n){var r,i=[],s=[e],o=[e],a=[n?d:"[Circular]"],l=e,c=1;return function(e,p){return t&&(p=t.call(this,e,p)),""!==e&&(l!==this&&(r=c-_.call(s,this)-1,c-=r,s.splice(c,s.length),i.splice(c-1,i.length),l=this),"object"==typeof p&&p?(_.call(s,p)<0&&s.push(l=p),c=s.length,r=_.call(o,p),r<0?(r=o.push(p)-1,n?(i.push((""+e).replace(f,h)),a[r]=d+i.join(d)):a[r]=a[0]):p=a[r]):"string"==typeof p&&n&&(p=p.replace(h,u).replace(d,h))),p}}function r(e,t){for(var n=0,r=t.length;n<r;e=e[t[n++].replace(p,d)]);return e}function i(e){return function(t,n){var r="string"==typeof n;return r&&n.charAt(0)===d?new m(n.slice(1)):(""===t&&(n=a(n,n,{})),r&&(n=n.replace(g,"$1"+d).replace(u,h)),e?e.call(this,t,n):n)}}function s(e,t,n){for(var r=0,i=t.length;r<i;r++)t[r]=a(e,t[r],n);return t}function o(e,t,n){for(var r in t)t.hasOwnProperty(r)&&(t[r]=a(e,t[r],n));return t}function a(e,t,n){return t instanceof Array?s(e,t,n):t instanceof m?t.length?n.hasOwnProperty(t)?n[t]:n[t]=r(e,t.split(d)):e:t instanceof Object?o(e,t,n):t}function l(t,r,i,s){return e.stringify(t,n(t,r,!s),i)}function c(t,n){return e.parse(t,i(n))}var d="~",h="\\x"+("0"+d.charCodeAt(0).toString(16)).slice(-2),u="\\"+h,f=new t(h,"g"),p=new t(u,"g"),g=new t("(?:^|([^\\\\]))"+u),_=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},m=String;return{stringify:l,parse:c}}(JSON,RegExp);!function(e,t){function n(e,t,n){var r=h[t.type]||{};return null==e?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function r(t){var n=c(),r=n._rgba=[];return t=t.toLowerCase(),p(l,function(e,i){var s,o=i.re.exec(t),a=o&&i.parse(o),l=i.space||"rgba";if(a)return s=n[l](a),n[d[l].cache]=s[d[l].cache],r=n._rgba=s._rgba,!1}),r.length?("0,0,0,0"===r.join()&&e.extend(r,s.transparent),n):s[t]}function i(e,t,n){return n=(n+1)%1,6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}var s,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],c=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},d={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=c.support={},f=e("<p>")[0],p=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=f.style.backgroundColor.indexOf("rgba")>-1,p(d,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),c.fn=e.extend(c.prototype,{parse:function(i,o,a,l){if(i===t)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=e(i).css(o),o=t);var h=this,u=e.type(i),f=this._rgba=[];return o!==t&&(i=[i,o,a,l],u="array"),"string"===u?this.parse(r(i)||s._default):"array"===u?(p(d.rgba.props,function(e,t){f[t.idx]=n(i[t.idx],t)}),this):"object"===u?(i instanceof c?p(d,function(e,t){i[t.cache]&&(h[t.cache]=i[t.cache].slice())}):p(d,function(t,r){var s=r.cache;p(r.props,function(e,t){if(!h[s]&&r.to){if("alpha"===e||null==i[e])return;h[s]=r.to(h._rgba)}h[s][t.idx]=n(i[e],t,!0)}),h[s]&&e.inArray(null,h[s].slice(0,3))<0&&(h[s][3]=1,r.from&&(h._rgba=r.from(h[s])))}),this):void 0},is:function(e){var t=c(e),n=!0,r=this;return p(d,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],p(i.props,function(e,t){if(null!=o[t.idx])return n=o[t.idx]===s[t.idx]})),n}),n},_space:function(){var e=[],t=this;return p(d,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=c(e),i=r._space(),s=d[i],o=0===this.alpha()?c("transparent"):this,a=o[s.cache]||s.to(o._rgba),l=a.slice();return r=r[s.cache],p(s.props,function(e,i){var s=i.idx,o=a[s],c=r[s],d=h[i.type]||{};null!==c&&(null===o?l[s]=c:(d.mod&&(c-o>d.mod/2?o+=d.mod:o-c>d.mod/2&&(o-=d.mod)),l[s]=n((c-o)*t+o,i)))}),this[i](l)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),r=n.pop(),i=c(t)._rgba;return c(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(255*r)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,d.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,r=e[0]/255,i=e[1]/255,s=e[2]/255,o=e[3],a=Math.max(r,i,s),l=Math.min(r,i,s),c=a-l,d=a+l,h=.5*d;return t=l===a?0:r===a?60*(i-s)/c+360:i===a?60*(s-r)/c+120:60*(r-i)/c+240,n=0===h||1===h?h:h<=.5?c/d:c/(2-d),[Math.round(t)%360,n,h,null==o?1:o]},d.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],s=e[3],o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;return[Math.round(255*i(a,o,t+1/3)),Math.round(255*i(a,o,t)),Math.round(255*i(a,o,t-1/3)),s]},p(d,function(r,i){var s=i.props,o=i.cache,l=i.to,d=i.from;c.fn[r]=function(r){if(l&&!this[o]&&(this[o]=l(this._rgba)),r===t)return this[o].slice();var i,a=e.type(r),h="array"===a||"object"===a?r:arguments,u=this[o].slice();return p(s,function(e,t){var r=h["object"===a?e:t.idx];null==r&&(r=u[t.idx]),u[t.idx]=n(r,t)}),d?(i=c(d(u)),i[o]=u,i):c(u)},p(s,function(t,n){c.fn[t]||(c.fn[t]=function(i){var s,o=e.type(i),l="alpha"===t?this._hsla?"hsla":"rgba":r,c=this[l](),d=c[n.idx];return"undefined"===o?d:("function"===o&&(i=i.call(this,d),o=e.type(i)),null==i&&n.empty?this:("string"===o&&(s=a.exec(i),s&&(i=d+parseFloat(s[2])*("+"===s[1]?1:-1))),c[n.idx]=i,this[l](c)))})})}),c.hook=function(t){var n=t.split(" ");p(n,function(t,n){e.cssHooks[n]={set:function(t,i){var s,o,a="";if("string"!==e.type(i)||(s=r(i))){if(i=c(s||i),!u.rgba&&1!==i._rgba[3]){for(o="backgroundColor"===n?t.parentNode:t;(""===a||"transparent"===a)&&o&&o.style;)try{a=e.css(o,"backgroundColor"),o=o.parentNode}catch(e){}i=i.blend(a&&"transparent"!==a?a:"_default")}i=i.toRgbaString()}try{t.style[n]=i}catch(e){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=c(t.elem,n),t.end=c(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},c.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return p(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},s=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(e,t){function n(e,t,n){var r=h[t.type]||{};return null==e?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function r(t){var n=c(),r=n._rgba=[];return t=t.toLowerCase(),p(l,function(e,i){var s,o=i.re.exec(t),a=o&&i.parse(o),l=i.space||"rgba";if(a)return s=n[l](a),n[d[l].cache]=s[d[l].cache],r=n._rgba=s._rgba,!1}),r.length?("0,0,0,0"===r.join()&&e.extend(r,s.transparent),n):s[t]}function i(e,t,n){return n=(n+1)%1,6*n<1?e+(t-e)*n*6:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}var s,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],c=e.Color=function(t,n,r,i){return new e.Color.fn.parse(t,n,r,i)},d={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},u=c.support={},f=e("<p>")[0],p=e.each;f.style.cssText="background-color:rgba(1,1,1,.5)",u.rgba=f.style.backgroundColor.indexOf("rgba")>-1,p(d,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),c.fn=e.extend(c.prototype,{parse:function(i,o,a,l){if(i===t)return this._rgba=[null,null,null,null],this;(i.jquery||i.nodeType)&&(i=e(i).css(o),o=t);var h=this,u=e.type(i),f=this._rgba=[];return o!==t&&(i=[i,o,a,l],u="array"),"string"===u?this.parse(r(i)||s._default):"array"===u?(p(d.rgba.props,function(e,t){f[t.idx]=n(i[t.idx],t)}),this):"object"===u?(i instanceof c?p(d,function(e,t){i[t.cache]&&(h[t.cache]=i[t.cache].slice())}):p(d,function(t,r){var s=r.cache;p(r.props,function(e,t){if(!h[s]&&r.to){if("alpha"===e||null==i[e])return;h[s]=r.to(h._rgba)}h[s][t.idx]=n(i[e],t,!0)}),h[s]&&e.inArray(null,h[s].slice(0,3))<0&&(h[s][3]=1,r.from&&(h._rgba=r.from(h[s])))}),this):void 0},is:function(e){var t=c(e),n=!0,r=this;return p(d,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],p(i.props,function(e,t){if(null!=o[t.idx])return n=o[t.idx]===s[t.idx]})),n}),n},_space:function(){var e=[],t=this;return p(d,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var r=c(e),i=r._space(),s=d[i],o=0===this.alpha()?c("transparent"):this,a=o[s.cache]||s.to(o._rgba),l=a.slice();return r=r[s.cache],p(s.props,function(e,i){var s=i.idx,o=a[s],c=r[s],d=h[i.type]||{};null!==c&&(null===o?l[s]=c:(d.mod&&(c-o>d.mod/2?o+=d.mod:o-c>d.mod/2&&(o-=d.mod)),l[s]=n((c-o)*t+o,i)))}),this[i](l)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),r=n.pop(),i=c(t)._rgba;return c(e.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),r=n.pop();return t&&n.push(~~(255*r)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),c.fn.parse.prototype=c.fn,d.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,r=e[0]/255,i=e[1]/255,s=e[2]/255,o=e[3],a=Math.max(r,i,s),l=Math.min(r,i,s),c=a-l,d=a+l,h=.5*d;return t=l===a?0:r===a?60*(i-s)/c+360:i===a?60*(s-r)/c+120:60*(r-i)/c+240,n=0===h||1===h?h:h<=.5?c/d:c/(2-d),[Math.round(t)%360,n,h,null==o?1:o]},d.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],s=e[3],o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;return[Math.round(255*i(a,o,t+1/3)),Math.round(255*i(a,o,t)),Math.round(255*i(a,o,t-1/3)),s]},p(d,function(r,i){var s=i.props,o=i.cache,l=i.to,d=i.from;c.fn[r]=function(r){if(l&&!this[o]&&(this[o]=l(this._rgba)),r===t)return this[o].slice();var i,a=e.type(r),h="array"===a||"object"===a?r:arguments,u=this[o].slice();return p(s,function(e,t){var r=h["object"===a?e:t.idx];null==r&&(r=u[t.idx]),u[t.idx]=n(r,t)}),d?(i=c(d(u)),i[o]=u,i):c(u)},p(s,function(t,n){c.fn[t]||(c.fn[t]=function(i){var s,o=e.type(i),l="alpha"===t?this._hsla?"hsla":"rgba":r,c=this[l](),d=c[n.idx];return"undefined"===o?d:("function"===o&&(i=i.call(this,d),o=e.type(i)),null==i&&n.empty?this:("string"===o&&(s=a.exec(i),s&&(i=d+parseFloat(s[2])*("+"===s[1]?1:-1))),c[n.idx]=i,this[l](c)))})})}),c.hook=function(t){var n=t.split(" ");p(n,function(t,n){e.cssHooks[n]={set:function(t,i){var s,o,a="";if("string"!==e.type(i)||(s=r(i))){if(i=c(s||i),!u.rgba&&1!==i._rgba[3]){for(o="backgroundColor"===n?t.parentNode:t;(""===a||"transparent"===a)&&o&&o.style;)try{a=e.css(o,"backgroundColor"),o=o.parentNode}catch(e){}i=i.blend(a&&"transparent"!==a?a:"_default")}i=i.toRgbaString()}try{t.style[n]=i}catch(e){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=c(t.elem,n),t.end=c(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},c.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return p(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},s=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),!function(e){"function"==typeof define&&define.amd?define("jquery-typeahead",["jquery"],function(t){return e(t)}):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(n)),e(t)}:e(jQuery)}(function(e){"use strict";window.Typeahead={version:"2.6.1"};var t={input:null,minLength:2,maxItem:8,dynamic:!1,delay:300,order:null,offset:!1,hint:!1,accent:!1,highlight:!0,group:!1,groupOrder:null,maxItemPerGroup:null,dropdownFilter:!1,dynamicFilter:null,backdrop:!1,backdropOnFocus:!1,cache:!1,ttl:36e5,compression:!1,suggestion:!1,searchOnFocus:!1,resultContainer:null,generateOnLoad:null,mustSelectItem:!1,href:null,display:["display"],template:null,groupTemplate:null,correlativeTemplate:!1,emptyTemplate:!1,cancelButton:!0,loadingAnimation:!0,filter:!0,matcher:null,source:null,callback:{onInit:null,onReady:null,onShowLayout:null,onHideLayout:null,onSearch:null,onResult:null,onLayoutBuiltBefore:null,onLayoutBuiltAfter:null,onNavigateBefore:null,onNavigateAfter:null,onMouseEnter:null,onMouseLeave:null,onClickBefore:null,onClickAfter:null,onSendRequest:null,onReceiveRequest:null,onPopulateSource:null,onCacheSave:null,onSubmit:null},selector:{container:"typeahead__container",result:"typeahead__result",list:"typeahead__list",group:"typeahead__group",item:"typeahead__item",empty:"typeahead__empty",display:"typeahead__display",query:"typeahead__query",filter:"typeahead__filter",filterButton:"typeahead__filter-button",dropdown:"typeahead__dropdown",dropdownItem:"typeahead__dropdown-item",button:"typeahead__button",backdrop:"typeahead__backdrop",hint:"typeahead__hint",cancelButton:"typeahead__cancel-button"},debug:!1},n=".typeahead",r={from:"\xe3\xe0\xe1\xe4\xe2\u1ebd\xe8\xe9\xeb\xea\xec\xed\xef\xee\xf5\xf2\xf3\xf6\xf4\xf9\xfa\xfc\xfb\xf1\xe7",to:"aaaaaeeeeeiiiiooooouuuunc"},i=~window.navigator.appVersion.indexOf("MSIE 9."),s=function(e,t){this.rawQuery=e.val()||"",this.query=e.val()||"",this.namespace="."+e.selector+n,this.tmpSource={},this.source={},this.isGenerated=null,this.generatedGroupCount=0,this.groupCount=0,this.groupBy="group",this.groups=[],this.result={},this.groupTemplate="",this.resultHtml=null,this.resultCount=0,this.resultCountPerGroup={},this.options=t,this.node=e,this.container=null,this.resultContainer=null,this.item=null,this.xhr={},this.hintIndex=null,this.filters={dropdown:{},dynamic:{}},this.dropdownFilter={"static":[],dynamic:[]},this.dropdownFilterAll=null,this.requests={},this.backdrop={},this.hint={},this.hasDragged=!1,this.focusOnly=!1,this.__construct()};s.prototype={extendOptions:function(){if(this.options.dynamic&&(this.options.cache=!1,this.options.compression=!1),this.options.cache&&(this.options.cache=function(e){var t,n=["localStorage","sessionStorage"];if(e===!0)e="localStorage";else if("string"==typeof e&&!~n.indexOf(e))return!1;t="undefined"!=typeof window[e];try{window[e].setItem("typeahead","typeahead"),window[e].removeItem("typeahead")}catch(e){t=!1}return t&&e||!1}.call(this,this.options.cache)),this.options.compression&&("object"==typeof LZString&&this.options.cache||(this.options.compression=!1)),"undefined"==typeof this.options.maxItem||/^\d+$/.test(this.options.maxItem)&&0!==this.options.maxItem||(this.options.maxItem=1/0),this.options.maxItemPerGroup&&!/^\d+$/.test(this.options.maxItemPerGroup)&&(this.options.maxItemPerGroup=null),this.options.display&&!Array.isArray(this.options.display)&&(this.options.display=[this.options.display]),this.options.group&&(Array.isArray(this.options.group)||("string"==typeof this.options.group?this.options.group={key:this.options.group}:"boolean"==typeof this.options.group&&(this.options.group={key:"group"}),this.options.group.key=this.options.group.key||"group")),this.options.highlight&&!~["any",!0].indexOf(this.options.highlight)&&(this.options.highlight=!1),this.options.dropdownFilter&&this.options.dropdownFilter instanceof Object){Array.isArray(this.options.dropdownFilter)||(this.options.dropdownFilter=[this.options.dropdownFilter]);for(var n=0,i=this.options.dropdownFilter.length;i>n;++n)this.dropdownFilter[this.options.dropdownFilter[n].value?"static":"dynamic"].push(this.options.dropdownFilter[n])}this.options.dynamicFilter&&!Array.isArray(this.options.dynamicFilter)&&(this.options.dynamicFilter=[this.options.dynamicFilter]),this.options.accent&&("object"==typeof this.options.accent?this.options.accent.from&&this.options.accent.to&&this.options.accent.from.length===this.options.accent.to.length:this.options.accent=r),this.options.groupTemplate&&(this.groupTemplate=this.options.groupTemplate),this.options.resultContainer&&("string"==typeof this.options.resultContainer&&(this.options.resultContainer=e(this.options.resultContainer)),this.options.resultContainer instanceof e&&this.options.resultContainer[0]&&(this.resultContainer=this.options.resultContainer)),this.options.maxItemPerGroup&&this.options.group&&this.options.group.key&&(this.groupBy=this.options.group.key),this.options.callback&&this.options.callback.onClick&&(this.options.callback.onClickBefore=this.options.callback.onClick,delete this.options.callback.onClick),this.options.callback&&this.options.callback.onNavigate&&(this.options.callback.onNavigateBefore=this.options.callback.onNavigate,delete this.options.callback.onNavigate),this.options=e.extend(!0,{},t,this.options)},unifySourceFormat:function(){if(this.groupCount=0,Array.isArray(this.options.source))return this.options.source={group:{data:this.options.source}},this.groupCount=1,!0;"string"==typeof this.options.source&&(this.options.source={group:{ajax:{url:this.options.source}}}),this.options.source.ajax&&(this.options.source={group:{ajax:this.options.source.ajax}}),(this.options.source.url||this.options.source.data)&&(this.options.source={group:this.options.source});var e,t,n;for(e in this.options.source)if(this.options.source.hasOwnProperty(e)){if(t=this.options.source[e],"string"==typeof t&&(t={ajax:{url:t}}),n=t.url||t.ajax,Array.isArray(n)?(t.ajax="string"==typeof n[0]?{url:n[0]}:n[0],t.ajax.path=t.ajax.path||n[1]||null,delete t.url):("object"==typeof t.url?t.ajax=t.url:"string"==typeof t.url&&(t.ajax={url:t.url}),delete t.url),!t.data&&!t.ajax)return!1;t.display&&!Array.isArray(t.display)&&(t.display=[t.display]),this.options.source[e]=t,this.groupCount++}return!0},init:function(){this.helper.executeCallback.call(this,this.options.callback.onInit,[this.node]),this.container=this.node.closest("."+this.options.selector.container)},delegateEvents:function(){var t=this,n=["focus"+this.namespace,"input"+this.namespace,"propertychange"+this.namespace,"keydown"+this.namespace,"keyup"+this.namespace,"dynamic"+this.namespace,"generate"+this.namespace];e("html").on("touchmove",function(){t.hasDragged=!0}).on("touchstart",function(){t.hasDragged=!1}),this.node.closest("form").on("submit",function(e){return t.options.mustSelectItem&&t.helper.isEmpty(t.item)?void e.preventDefault():(t.options.backdropOnFocus||t.hideLayout(),t.options.callback.onSubmit?t.helper.executeCallback.call(t,t.options.callback.onSubmit,[t.node,this,t.item,e]):void 0)});var r=!1;this.node.off(this.namespace).on(n.join(" "),function(e){switch(e.type){case"generate":t.isGenerated=null,t.generateSource();break;case"focus":if(t.focusOnly){t.focusOnly=!1;break}t.options.backdropOnFocus&&(t.buildBackdropLayout(),t.showLayout()),t.options.searchOnFocus&&t.query.length>=t.options.minLength&&(t.isGenerated?t.showLayout():null===t.isGenerated&&t.generateSource());case"keydown":e.keyCode&&~[9,13,27,38,39,40].indexOf(e.keyCode)&&(r=!0,t.navigate(e));break;case"keyup":
null!==t.isGenerated||t.options.dynamic||t.generateSource(),i&&t.node[0].value.replace(/^\s+/,"").toString().length<t.query.length&&t.node.trigger("input"+t.namespace);break;case"propertychange":if(r){r=!1;break}case"input":if(t.rawQuery=t.node[0].value.toString(),t.query=t.rawQuery.replace(/^\s+/,""),t.options.cancelButton&&t.toggleCancelButton(),t.options.hint&&t.hint.container&&""!==t.hint.container.val()&&0!==t.hint.container.val().indexOf(t.rawQuery)&&t.hint.container.val(""),t.options.dynamic)return t.isGenerated=null,void t.helper.typeWatch(function(){t.query.length>=t.options.minLength?t.generateSource():t.hideLayout()},t.options.delay);case"dynamic":if(!t.isGenerated)break;t.searchResult(),t.buildLayout(),(t.result.length>0||t.options.emptyTemplate)&&t.query.length>=t.options.minLength?t.showLayout():t.hideLayout()}}),this.options.generateOnLoad&&this.node.trigger("generate"+this.namespace)},generateSource:function(){if(!this.isGenerated||this.options.dynamic){if(this.generatedGroupCount=0,this.isGenerated=!1,this.options.loadingAnimation&&this.container.addClass("loading"),!this.helper.isEmpty(this.xhr)){for(var t in this.xhr)this.xhr.hasOwnProperty(t)&&this.xhr[t].abort();this.xhr={}}var n,r,i,s;for(n in this.options.source)if(this.options.source.hasOwnProperty(n)){if(r=this.options.source[n],this.options.cache&&(i=window[this.options.cache].getItem("TYPEAHEAD_"+this.node.selector+":"+n))){this.options.compression&&(i=LZString.decompressFromUTF16(i)),s=!1;try{i=JSON.parse(i+""),i.data&&i.ttl>(new Date).getTime()?(this.populateSource(i.data,n),s=!0):window[this.options.cache].removeItem("TYPEAHEAD_"+this.node.selector+":"+n)}catch(e){}if(s)continue}!r.data||r.ajax?r.ajax&&(this.requests[n]||(this.requests[n]=this.generateRequestObject(n))):this.populateSource(e.extend(!0,[],r.data),n)}this.handleRequests()}},generateRequestObject:function(e){var t=this,n=this.options.source[e],r={request:{url:n.ajax.url||null,dataType:"json",beforeSend:function(r){t.xhr[e]=r;var i=t.requests[e].callback.beforeSend||n.ajax.beforeSend;"function"==typeof i&&i.apply(null,arguments)}},callback:{beforeSend:null,done:null,fail:null,then:null,always:null},extra:{path:n.ajax.path||null,group:e},validForGroup:[e]};if("function"!=typeof n.ajax&&(n.ajax instanceof Object&&(r=this.extendXhrObject(r,n.ajax)),Object.keys(this.options.source).length>1))for(var i in this.requests)this.requests.hasOwnProperty(i)&&(this.requests[i].isDuplicated||r.request.url&&r.request.url===this.requests[i].request.url&&(this.requests[i].validForGroup.push(e),r.isDuplicated=!0,delete r.validForGroup));return r},extendXhrObject:function(t,n){return"object"==typeof n.callback&&(t.callback=n.callback,delete n.callback),"function"==typeof n.beforeSend&&(t.callback.beforeSend=n.beforeSend,delete n.beforeSend),t.request=e.extend(!0,t.request,n),"jsonp"!==t.request.dataType.toLowerCase()||t.request.jsonpCallback||(t.request.jsonpCallback="callback_"+t.extra.group),t},handleRequests:function(){var t=this,n=Object.keys(this.requests).length;if(this.helper.executeCallback.call(this,this.options.callback.onSendRequest,[this.node,this.query])===!1)return void(this.isGenerated=null);for(var r in this.requests)this.requests.hasOwnProperty(r)&&(this.requests[r].isDuplicated||!function(r,i){if("function"==typeof t.options.source[r].ajax){var s=t.options.source[r].ajax.call(t,t.query);if(i=t.extendXhrObject(i,s),"object"!=typeof i.request||!i.request.url)return}var o,a=!1;if(~i.request.url.indexOf("{{query}}")&&(a||(i=e.extend(!0,{},i),a=!0),i.request.url=i.request.url.replace("{{query}}",t.query)),i.request.data)for(var l in i.request.data)if(i.request.data.hasOwnProperty(l)&&~String(i.request.data[l]).indexOf("{{query}}")){a||(i=e.extend(!0,{},i),a=!0),i.request.data[l]=i.request.data[l].replace("{{query}}",t.query);break}e.ajax(i.request).done(function(e,r,s){for(var a,l=0,c=i.validForGroup.length;c>l;l++)o=t.requests[i.validForGroup[l]],o.callback.done instanceof Function&&(a=o.callback.done(e,r,s),e=Array.isArray(a)&&a||e),t.populateSource(e,o.extra.group,o.extra.path||o.request.path),n-=1,0===n&&t.helper.executeCallback.call(t,t.options.callback.onReceiveRequest,[t.node,t.query])}).fail(function(e,n,r){for(var s=0,a=i.validForGroup.length;a>s;s++)o=t.requests[i.validForGroup[s]],o.callback.fail instanceof Function&&o.callback.fail(e,n,r)}).always(function(e,n,r){for(var s=0,a=i.validForGroup.length;a>s;s++)o=t.requests[i.validForGroup[s]],o.callback.always instanceof Function&&o.callback.always(e,n,r)}).then(function(e,n){for(var r=0,s=i.validForGroup.length;s>r;r++)o=t.requests[i.validForGroup[r]],o.callback.then instanceof Function&&o.callback.then(e,n)})}(r,this.requests[r]))},populateSource:function(e,t,n){var r=this,i=this.options.source[t],s=i.ajax&&i.data;e="string"==typeof n?this.helper.namespace(n,e):e,Array.isArray(e)||(e=[]),s&&("function"==typeof s&&(s=s()),Array.isArray(s)&&(e=e.concat(s)));for(var o,a=i.display?"compiled"===i.display[0]?i.display[1]:i.display[0]:"compiled"===this.options.display[0]?this.options.display[1]:this.options.display[0],l=0,c=e.length;c>l;l++)"string"==typeof e[l]&&(o={},o[a]=e[l],e[l]=o),e[l].group=t;if(!this.options.dynamic&&this.dropdownFilter.dynamic.length)for(var d,h,u={},l=0,c=e.length;c>l;l++)for(var f=0,p=this.dropdownFilter.dynamic.length;p>f;f++)d=this.dropdownFilter.dynamic[f].key,h=e[l][d],h&&(this.dropdownFilter.dynamic[f].value||(this.dropdownFilter.dynamic[f].value=[]),u[d]||(u[d]=[]),~u[d].indexOf(h.toLowerCase())||(u[d].push(h.toLowerCase()),this.dropdownFilter.dynamic[f].value.push(h)));if(this.options.correlativeTemplate){var g=i.template||this.options.template,_="";if("function"==typeof g&&(g=g()),g){if(Array.isArray(this.options.correlativeTemplate))for(var l=0,c=this.options.correlativeTemplate.length;c>l;l++)_+="{{"+this.options.correlativeTemplate[l]+"}} ";else _=g.replace(/<.+?>/g,"");for(var l=0,c=e.length;c>l;l++)e[l].compiled=_.replace(/\{\{([\w\-\.]+)(?:\|(\w+))?}}/g,function(t,n){return r.helper.namespace(n,e[l],"get","")}).trim();i.display?~i.display.indexOf("compiled")||i.display.unshift("compiled"):~this.options.display.indexOf("compiled")||this.options.display.unshift("compiled")}}if(this.options.callback.onPopulateSource&&(e=this.helper.executeCallback.call(this,this.options.callback.onPopulateSource,[this.node,e,t,n])),this.tmpSource[t]=e,this.options.cache&&!window[this.options.cache].getItem("TYPEAHEAD_"+this.node.selector+":"+t)){this.options.callback.onCacheSave&&(e=this.helper.executeCallback.call(this,this.options.callback.onCacheSave,[this.node,e,t,n]));var m=JSON.stringify({data:e,ttl:(new Date).getTime()+this.options.ttl});this.options.compression&&(m=LZString.compressToUTF16(m)),window[this.options.cache].setItem("TYPEAHEAD_"+this.node.selector+":"+t,m)}this.incrementGeneratedGroup()},incrementGeneratedGroup:function(){if(this.generatedGroupCount++,this.groupCount===this.generatedGroupCount){this.isGenerated=!0,this.xhr={};for(var e=Object.keys(this.options.source),t=0,n=e.length;n>t;t++)this.source[e[t]]=this.tmpSource[e[t]];this.tmpSource={},this.options.dynamic||this.buildDropdownItemLayout("dynamic"),this.options.loadingAnimation&&this.container.removeClass("loading"),this.node.trigger("dynamic"+this.namespace)}},navigate:function(e){if(this.helper.executeCallback.call(this,this.options.callback.onNavigateBefore,[this.node,this.query,e]),27===e.keyCode)return e.preventDefault(),void(this.query.length?(this.node.val(""),this.node.trigger("input"+this.namespace)):(this.node.blur(),this.hideLayout()));if(this.isGenerated&&this.result.length){var t=this.resultContainer.find("."+this.options.selector.item),n=t.filter(".active"),r=n[0]&&t.index(n)||null,i=null;if(13===e.keyCode)return void(n.length>0&&(e.preventDefault(),n.find("a:first")[0].click()));if(39===e.keyCode)return void(r?t.eq(r).find("a:first")[0].click():this.options.hint&&""!==this.hint.container.val()&&this.helper.getCaret(this.node[0])>=this.query.length&&t.find('a[data-index="'+this.hintIndex+'"]')[0].click());t.length>0&&n.removeClass("active"),38===e.keyCode?(e.preventDefault(),n.length>0?r-1>=0&&(i=r-1,t.eq(i).addClass("active")):(i=t.length-1,t.last().addClass("active"))):40===e.keyCode&&(e.preventDefault(),n.length>0?r+1<t.length&&(i=r+1,t.eq(i).addClass("active")):(i=0,t.first().addClass("active"))),e.preventInputChange&&~[38,40].indexOf(e.keyCode)&&this.buildHintLayout(null!==i&&i<this.result.length?[this.result[i]]:null),this.options.hint&&this.hint.container&&this.hint.container.css("color",e.preventInputChange?this.hint.css.color:null===i&&this.hint.css.color||this.hint.container.css("background-color")||"fff"),this.node.val(null===i||e.preventInputChange?this.rawQuery:this.result[i][this.result[i].matchedKey]),this.helper.executeCallback.call(this,this.options.callback.onNavigateAfter,[this.node,t,null!==i&&t.eq(i).find("a:first")||void 0,null!==i&&this.result[i]||void 0,this.query,e])}},searchResult:function(e){e||(this.item={}),this.resetLayout(),this.helper.executeCallback.call(this,this.options.callback.onSearch,[this.node,this.query])!==!1&&(this.query.length>=this.options.minLength&&this.searchResultData(),this.helper.executeCallback.call(this,this.options.callback.onResult,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]))},searchResultData:function(){var e,t,n,r,i,s,o,a,l,c,d,h,u,f=this,p=this.groupBy,g=null,_=this.query.toLowerCase(),m=this.options.maxItemPerGroup,y=this.filters.dynamic&&!this.helper.isEmpty(this.filters.dynamic),v="function"==typeof this.options.matcher&&this.options.matcher;this.options.accent&&(_=this.helper.removeAccent.call(this,_));for(e in this.source)if(this.source.hasOwnProperty(e)&&(!this.filters.dropdown||"group"!==this.filters.dropdown.key||this.filters.dropdown.value===e)){o="undefined"!=typeof this.options.source[e].filter?this.options.source[e].filter:this.options.filter,l="function"==typeof this.options.source[e].matcher&&this.options.source[e].matcher||v;for(var b=0,x=this.source[e].length;x>b&&(!(this.result.length>=this.options.maxItem)||this.options.callback.onResult);b++)if((!y||this.dynamicFilter.validate.apply(this,[this.source[e][b]]))&&(t=this.source[e][b],!this.filters.dropdown||(t[this.filters.dropdown.key]||"").toLowerCase()===(this.filters.dropdown.value||"").toLowerCase())){if(g="group"===p?e:t[p],g&&!this.result[g]&&(this.result[g]=[],this.resultCountPerGroup[g]=0),m&&"group"===p&&this.result[g].length>=m&&!this.options.callback.onResult)break;i=this.options.source[e].display||this.options.display;for(var k=0,j=i.length;j>k;k++)if(s=/\./.test(i[k])?this.helper.namespace(i[k],t):t[i[k]],"undefined"!=typeof s&&""!==s){if(s=this.helper.cleanStringFromScript(s),"function"==typeof o){if(a=o.call(this,t,s),void 0===a)break;if(!a)continue;"object"==typeof a&&(t=a)}if(~[void 0,!0].indexOf(o)){if(r=s,r=r.toString().toLowerCase(),this.options.accent&&(r=this.helper.removeAccent.call(this,r)),n=r.indexOf(_),this.options.correlativeTemplate&&"compiled"===i[k]&&0>n&&/\s/.test(_)){d=!0,h=_.split(" "),u=r;for(var w=0,C=h.length;C>w;w++)if(""!==h[w]){if(!~u.indexOf(h[w])){d=!1;break}u=u.replace(h[w],"")}}if(0>n&&!d)continue;if(this.options.offset&&0!==n)continue;if(l){if(c=l.call(this,t,s),void 0===c)break;if(!c)continue;"object"==typeof c&&(t=c)}}if(this.resultCount++,this.resultCountPerGroup[g]++,this.resultItemCount<this.options.maxItem){if(m&&this.result[g].length>=m)break;t.matchedKey=i[k],this.result[g].push(t),this.resultItemCount++}break}if(!this.options.callback.onResult){if(this.resultItemCount>=this.options.maxItem)break;if(m&&this.result[g].length>=m&&"group"===p)break}}}if(this.options.order){var S,i=[];for(var e in this.result)if(this.result.hasOwnProperty(e)){for(var k=0,j=this.result[e].length;j>k;k++)S=this.options.source[this.result[e][k].group].display||this.options.display,~i.indexOf(S[0])||i.push(S[0]);this.result[e].sort(f.helper.sort(i,"asc"===f.options.order,function(e){return e.toString().toUpperCase()}))}}var A,T=[];A="function"==typeof this.options.groupOrder?this.options.groupOrder.apply(this,[this.node,this.query,this.result,this.resultCount,this.resultCountPerGroup]):Array.isArray(this.options.groupOrder)?this.options.groupOrder:"string"==typeof this.options.groupOrder&&~["asc","desc"].indexOf(this.options.groupOrder)?Object.keys(this.result).sort(f.helper.sort([],"asc"===f.options.groupOrder,function(e){return e.toString().toUpperCase()})):Object.keys(this.result),this.groups=A;for(var k=0,j=A.length;j>k;k++)T=T.concat(this.result[A[k]]||[]);this.result=T},buildLayout:function(){if(this.buildHtmlLayout(),this.buildBackdropLayout(),this.buildHintLayout(),this.options.callback.onLayoutBuiltBefore){var t=this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltBefore,[this.node,this.query,this.result,this.resultHtml]);t instanceof e&&(this.resultHtml=t)}this.resultHtml&&this.resultContainer.html(this.resultHtml),this.options.callback.onLayoutBuiltAfter&&this.helper.executeCallback.call(this,this.options.callback.onLayoutBuiltAfter,[this.node,this.query,this.result])},buildHtmlLayout:function(){if(this.options.resultContainer!==!1){this.resultContainer||(this.resultContainer=e("<div/>",{"class":this.options.selector.result}),this.container.append(this.resultContainer));var t;if(!this.result.length){if(!this.options.emptyTemplate)return;t="function"==typeof this.options.emptyTemplate?this.options.emptyTemplate.call(this,this.query):this.options.emptyTemplate.replace(/\{\{query}}/gi,this.helper.cleanStringFromScript(this.query))}var n=this.query.toLowerCase();this.options.accent&&(n=this.helper.removeAccent.call(this,n));var r=this,i=this.groupTemplate||"<ul></ul>",s=!1;this.groupTemplate?i=e(i.replace(/<([^>]+)>\{\{(.+?)}}<\/[^>]+>/g,function(e,n,i){var o="",a="group"===i?r.groups:[i];if(!r.result.length)return s===!0?"":(s=!0,"<"+n+' class="'+r.options.selector.empty+'"><a href="javascript:;">'+t+"</a></"+n+">");for(var l=0,c=a.length;c>l;++l)o+="<"+n+' data-group-template="'+a[l]+'"><ul></ul></'+n+">";return o})):(i=e(i),this.result.length||i.append(t instanceof e?t:'<li class="'+r.options.selector.empty+'"><a href="javascript:;">'+t+"</a></li>")),i.addClass(this.options.selector.list+(this.helper.isEmpty(this.result)?" empty":""));for(var o,a,l,c,d,h,u,f,p,g,_,m=this.groupTemplate&&this.result.length&&r.groups||[],y=0,v=this.result.length;v>y;++y)l=this.result[y],o=l.group,c=this.options.source[l.group].href||this.options.href,f=[],p=this.options.source[l.group].display||this.options.display,this.options.group&&(o=l[this.options.group.key],this.options.group.template&&("function"==typeof this.options.group.template?a=this.options.group.template(l):"string"==typeof this.options.template&&(a=this.options.group.template.replace(/\{\{([\w\-\.]+)}}/gi,function(e,t){return r.helper.namespace(t,l,"get","")}))),i.find('[data-search-group="'+o+'"]')[0]||(this.groupTemplate?i.find('[data-group-template="'+o+'"] ul'):i).append(e("<li/>",{"class":r.options.selector.group,html:e("<a/>",{href:"javascript:;",html:a||o,tabindex:-1}),"data-search-group":o}))),this.groupTemplate&&m.length&&(_=m.indexOf(o||l.group),~_&&m.splice(_,1)),d=e("<li/>",{"class":r.options.selector.item,html:e("<a/>",{href:function(){return c&&("string"==typeof c?c=c.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(e,t,n){var i=r.helper.namespace(t,l,"get","");return n=n&&n.split("|")||[],~n.indexOf("slugify")&&(i=r.helper.slugify.call(r,i)),i}):"function"==typeof c&&(c=c(l)),l.href=c),c||"javascript:;"}(),"data-group":o,"data-index":y,html:function(){if(h=l.group&&r.options.source[l.group].template||r.options.template)"function"==typeof h&&(h=h.call(r,r.query,l)),u=h.replace(/\{\{([^\|}]+)(?:\|([^}]+))*}}/gi,function(e,t,i){var s=r.helper.cleanStringFromScript(String(r.helper.namespace(t,l,"get","")));return i=i&&i.split("|")||[],~i.indexOf("slugify")&&(s=r.helper.slugify.call(r,s)),~i.indexOf("raw")||r.options.highlight===!0&&n&&~p.indexOf(t)&&(s=r.helper.highlight.call(r,s,n.split(" "),r.options.accent)),s});else{for(var t=0,i=p.length;i>t;t++)g=/\./.test(p[t])?r.helper.namespace(p[t],l):l[p[t]],"undefined"!=typeof g&&""!==g&&f.push(g);u='<span class="'+r.options.selector.display+'">'+r.helper.cleanStringFromScript(String(f.join(" ")))+"</span>"}(r.options.highlight===!0&&n&&!h||"any"===r.options.highlight)&&(u=r.helper.highlight.call(r,u,n.split(" "),r.options.accent)),e(this).append(u)}})}),function(t,n,i){i.on("click",function(t){return r.options.mustSelectItem&&r.helper.isEmpty(n)?void t.preventDefault():(r.item=n,void(r.helper.executeCallback.call(r,r.options.callback.onClickBefore,[r.node,e(this),n,t])!==!1&&(t.originalEvent&&t.originalEvent.defaultPrevented||t.isDefaultPrevented()||(r.query=r.rawQuery=n[n.matchedKey].toString(),r.focusOnly=!0,r.node.val(r.query).focus(),r.searchResult(!0),r.buildLayout(),r.hideLayout(),r.helper.executeCallback.call(r,r.options.callback.onClickAfter,[r.node,e(this),n,t])))))}),i.on("mouseenter",function(t){r.helper.executeCallback.call(r,r.options.callback.onMouseEnter,[r.node,e(this),n,t])}),i.on("mouseleave",function(t){r.helper.executeCallback.call(r,r.options.callback.onMouseLeave,[r.node,e(this),n,t])})}(y,l,d),(this.groupTemplate?i.find('[data-group-template="'+o+'"] ul'):i).append(d);if(this.result.length&&m.length)for(var y=0,v=m.length;v>y;++y)i.find('[data-group-template="'+m[y]+'"]').remove();this.resultHtml=i}},buildBackdropLayout:function(){this.options.backdrop&&(this.backdrop.container||(this.backdrop.css=e.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},this.options.backdrop),this.backdrop.container=e("<div/>",{"class":this.options.selector.backdrop,css:this.backdrop.css}).insertAfter(this.container)),this.container.addClass("backdrop").css({"z-index":this.backdrop.css["z-index"]+1,position:"relative"}))},buildHintLayout:function(t){if(this.options.hint){if(this.node[0].scrollWidth>Math.ceil(this.node.innerWidth()))return void(this.hint.container&&this.hint.container.val(""));var n=this,r="",t=t||this.result,i=this.query.toLowerCase();if(this.options.accent&&(i=this.helper.removeAccent.call(this,i)),this.hintIndex=null,this.query.length>=this.options.minLength){if(this.hint.container||(this.hint.css=e.extend({"border-color":"transparent",position:"absolute",top:0,display:"inline","z-index":-1,"float":"none",color:"silver","box-shadow":"none",cursor:"default","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"},this.options.hint),this.hint.container=e("<input/>",{type:this.node.attr("type"),"class":this.node.attr("class"),readonly:!0,unselectable:"on","aria-hidden":"true",tabindex:-1,click:function(){n.node.focus()}}).addClass(this.options.selector.hint).css(this.hint.css).insertAfter(this.node),this.node.parent().css({position:"relative"})),this.hint.container.css("color",this.hint.css.color),i)for(var s,o,a,l=0,c=t.length;c>l;l++){o=t[l].group,s=this.options.source[o].display||this.options.display;for(var d=0,h=s.length;h>d;d++)if(a=String(t[l][s[d]]).toLowerCase(),this.options.accent&&(a=this.helper.removeAccent.call(this,a)),0===a.indexOf(i)){r=String(t[l][s[d]]),this.hintIndex=l;break}if(null!==this.hintIndex)break}this.hint.container.val(r.length>0&&this.rawQuery+r.substring(this.query.length)||"")}}},buildDropdownLayout:function(){if(this.options.dropdownFilter){var t=this;e("<span/>",{"class":this.options.selector.filter,html:function(){e(this).append(e("<button/>",{type:"button","class":t.options.selector.filterButton,style:"display: none;",click:function(n){n.stopPropagation(),t.container.toggleClass("filter");var r=t.namespace+"-dropdown-filter";e("html").off(r),t.container.hasClass("filter")&&e("html").on("click"+r+" touchend"+r,function(n){e(n.target).closest("."+t.options.selector.filter)[0]||t.hasDragged||t.container.removeClass("filter")})}})),e(this).append(e("<ul/>",{"class":t.options.selector.dropdown}))}}).insertAfter(t.container.find("."+t.options.selector.query))}},buildDropdownItemLayout:function(t){function n(e){"*"===e.value?delete this.filters.dropdown:this.filters.dropdown=e,this.container.removeClass("filter").find("."+this.options.selector.filterButton).html(e.template),this.node.trigger("dynamic"+this.namespace),this.node.focus()}var r,i,s=this,o="string"==typeof this.options.dropdownFilter&&this.options.dropdownFilter||"All",a=this.container.find("."+this.options.selector.dropdown);("static"===t&&this.options.dropdownFilter===!0||"string"==typeof this.options.dropdownFilter)&&this.dropdownFilter["static"].push({key:"group",template:"{{group}}",all:o,value:Object.keys(this.options.source)});for(var l=0,c=this.dropdownFilter[t].length;c>l;l++){i=this.dropdownFilter[t][l],Array.isArray(i.value)||(i.value=[i.value]),i.all&&(this.dropdownFilterAll=i.all);for(var d=0,h=i.value.length;h>=d;d++)(d!==h||l===c-1)&&(d===h&&l===c-1&&"static"===t&&this.dropdownFilter.dynamic.length||(r=this.dropdownFilterAll||o,i.value[d]?r=i.template?i.template.replace(new RegExp("{{"+i.key+"}}","gi"),i.value[d]):i.value[d]:this.container.find("."+s.options.selector.filterButton).html(r),function(t,r,i){a.append(e("<li/>",{"class":s.options.selector.dropdownItem+" "+s.helper.slugify.call(s,r.key+"-"+(r.value[t]||o)),html:e("<a/>",{href:"javascript:;",html:i,click:function(e){e.preventDefault(),n.call(s,{key:r.key,value:r.value[t]||"*",template:i})}})}))}(d,i,r)))}this.dropdownFilter[t].length&&this.container.find("."+s.options.selector.filterButton).removeAttr("style")},dynamicFilter:{isEnabled:!1,init:function(){this.options.dynamicFilter&&(this.dynamicFilter.bind.call(this),this.dynamicFilter.isEnabled=!0)},validate:function(e){var t,n,r=null,i=null;for(var s in this.filters.dynamic)if(this.filters.dynamic.hasOwnProperty(s)&&(n=~s.indexOf(".")?this.helper.namespace(s,e,"get"):e[s],"|"!==this.filters.dynamic[s].modifier||r||(r=n==this.filters.dynamic[s].value||!1),"&"===this.filters.dynamic[s].modifier)){if(n!=this.filters.dynamic[s].value){i=!1;break}i=!0}return t=r,null!==i&&(t=i,i===!0&&null!==r&&(t=r)),!!t},set:function(e,t){var n=e.match(/^([|&])?(.+)/);t?this.filters.dynamic[n[2]]={modifier:n[1]||"|",value:t}:delete this.filters.dynamic[n[2]],this.dynamicFilter.isEnabled&&(this.searchResult(),this.buildLayout())},bind:function(){for(var t,n=this,r=0,i=this.options.dynamicFilter.length;i>r;r++)t=this.options.dynamicFilter[r],"string"==typeof t.selector&&(t.selector=e(t.selector)),t.selector instanceof e&&t.selector[0]&&t.key&&!function(e){e.selector.off(n.namespace).on("change"+n.namespace,function(){n.dynamicFilter.set.apply(n,[e.key,n.dynamicFilter.getValue(this)])}).trigger("change"+n.namespace)}(t)},getValue:function(e){var t;return"SELECT"===e.tagName?t=e.value:"INPUT"===e.tagName&&("checkbox"===e.type?t=e.checked&&e.getAttribute("value")||e.checked||null:"radio"===e.type&&e.checked&&(t=e.value)),t}},showLayout:function(){if(!this.container.hasClass("result")&&(this.result.length||this.options.emptyTemplate||this.options.backdropOnFocus)){var t=this;e("html").off(this.namespace).on("click"+this.namespace+" touchend"+this.namespace,function(n){e(n.target).closest(t.container)[0]||t.hasDragged||t.hideLayout()}),this.container.addClass([this.result.length||this.options.emptyTemplate&&this.query.length>=this.options.minLength?"result ":"",this.options.hint&&this.query.length>=this.options.minLength?"hint":"",this.options.backdrop||this.options.backdropOnFocus?"backdrop":""].join(" ")),this.helper.executeCallback.call(this,this.options.callback.onShowLayout,[this.node,this.query])}},hideLayout:function(){(this.container.hasClass("result")||this.container.hasClass("backdrop"))&&(this.container.removeClass("result hint filter"+(this.options.backdropOnFocus&&e(this.node).is(":focus")?"":" backdrop")),this.options.backdropOnFocus&&this.container.hasClass("backdrop")||(e("html").off(this.namespace),this.helper.executeCallback.call(this,this.options.callback.onHideLayout,[this.node,this.query])))},resetLayout:function(){this.result={},this.resultCount=0,this.resultCountPerGroup={},this.resultItemCount=0,this.resultHtml=null,this.options.hint&&this.hint.container&&this.hint.container.val("")},buildCancelButtonLayout:function(){if(this.options.cancelButton){var t=this;e("<span/>",{"class":this.options.selector.cancelButton,mousedown:function(e){e.stopImmediatePropagation(),e.preventDefault(),t.node.val(""),t.node.trigger("input"+t.namespace)}}).insertBefore(this.node)}},toggleCancelButton:function(){this.container.toggleClass("cancel",!!this.query.length)},__construct:function(){this.extendOptions(),this.unifySourceFormat()&&(this.dynamicFilter.init.apply(this),this.init(),this.delegateEvents(),this.buildCancelButtonLayout(),this.buildDropdownLayout(),this.buildDropdownItemLayout("static"),this.helper.executeCallback.call(this,this.options.callback.onReady,[this.node]))},helper:{isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},removeAccent:function(e){if("string"==typeof e){var t=this.options.accent||r;return e=e.toLowerCase().replace(new RegExp("["+t.from+"]","g"),function(e){return t.to[t.from.indexOf(e)]})}},slugify:function(e){return e=String(e),""!==e&&(e=this.helper.removeAccent.call(this,e),e=e.replace(/[^-a-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")),e},sort:function(e,t,n){var r=function(t){for(var r=0,i=e.length;i>r;r++)if("undefined"!=typeof t[e[r]])return n(t[e[r]]);return t};return t=[-1,1][+!!t],function(e,n){return e=r(e),n=r(n),t*((e>n)-(n>e))}},replaceAt:function(e,t,n,r){return e.substring(0,t)+r+e.substring(t+n)},highlight:function(e,t,n){e=String(e);var r=n&&this.helper.removeAccent.call(this,e)||e,i=[];Array.isArray(t)||(t=[t]),t.sort(function(e,t){return t.length-e.length});for(var s=t.length-1;s>=0;s--)""!==t[s].trim()?t[s]=t[s].replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):t.splice(s,1);r.replace(new RegExp("(?:"+t.join("|")+")(?!([^<]+)?>)","gi"),function(e,t,n){i.push({offset:n,length:e.length})});for(var s=i.length-1;s>=0;s--)e=this.helper.replaceAt(e,i[s].offset,i[s].length,"<strong>"+e.substr(i[s].offset,i[s].length)+"</strong>");return e},getCaret:function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),r=n.duplicate();return n.moveToBookmark(t.getBookmark()),r.setEndPoint("EndToStart",n),r.text.length}return 0},cleanStringFromScript:function(e){return"string"==typeof e&&e.replace(/<\/?(?:script|iframe)\b[^>]*>/gm,"")||e},executeCallback:function(e,t){if(e){var n;if("function"==typeof e)n=e;else if(("string"==typeof e||Array.isArray(e))&&("string"==typeof e&&(e=[e,[]]),n=this.helper.namespace(e[0],window),"function"!=typeof n))return;return n.apply(this,(e[1]||[]).concat(t?t:[]))}},namespace:function(e,t,n,r){if("string"!=typeof e||""===e)return!1;for(var i=e.split("."),s=t||window,n=n||"get",o=r||{},a="",l=0,c=i.length;c>l;l++){if(a=i[l],"undefined"==typeof s[a]){if(~["get","delete"].indexOf(n))return"undefined"!=typeof r?r:void 0;s[a]={}}if(~["set","create","delete"].indexOf(n)&&l===c-1){if("set"!==n&&"create"!==n)return delete s[a],!0;s[a]=o}s=s[a]}return s},typeWatch:function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}()}},e.fn.typeahead=e.typeahead=function(e){return o.typeahead(this,e)};var o={typeahead:function(t,n){if(n&&n.source&&"object"==typeof n.source){if("function"==typeof t){if(!n.input)return;t=e(n.input)}if(t.length&&"INPUT"===t[0].nodeName)return window.Typeahead[n.input||t.selector]=new s(t,n)}}};return window.console=window.console||{log:function(){}},Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){void 0===t&&(t=0),0>t&&(t+=this.length),0>t&&(t=0);for(var n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1}),Object.keys||(Object.keys=function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}),s});var Sylvester={version:"0.1.3",precision:1e-6};Matrix.prototype={dup:function(){return Matrix.create(this.elements)},canMultiplyFromLeft:function(e){var t=e.elements||e;return void 0===t[0][0]&&(t=Matrix.create(t).elements),this.elements[0].length==t.length},multiply:function(e){var t=!!e.modulus,n=e.elements||e;if(void 0===n[0][0]&&(n=Matrix.create(n).elements),!this.canMultiplyFromLeft(n))return null;var r,i,s,o,a,l,c=this.elements.length,d=c,h=n[0].length,u=this.elements[0].length,f=[];do{r=d-c,f[r]=[],i=h;do{s=h-i,o=0,a=u;do l=u-a,o+=this.elements[r][l]*n[l][s];while(--a);f[r][s]=o}while(--i)}while(--c);return n=Matrix.create(f),t?n.col(1):n},isSquare:function(){return this.elements.length==this.elements[0].length},toRightTriangular:function(){var e,t,n,r,i=this.dup(),s=this.elements.length,o=s,a=this.elements[0].length;do{if(t=o-s,0===i.elements[t][t])for(j=t+1;o>j;j++)if(0!==i.elements[j][t]){e=[],n=a;do r=a-n,e.push(i.elements[t][r]+i.elements[j][r]);while(--n);i.elements[t]=e;break}if(0!==i.elements[t][t])for(j=t+1;o>j;j++){var l=i.elements[j][t]/i.elements[t][t];e=[],n=a;do r=a-n,e.push(t>=r?0:i.elements[j][r]-i.elements[t][r]*l);while(--n);i.elements[j]=e}}while(--s);return i},determinant:function(){if(!this.isSquare())return null;var e,t=this.toRightTriangular(),n=t.elements[0][0],r=t.elements.length-1,i=r;do e=i-r+1,n*=t.elements[e][e];while(--r);return n},isSingular:function(){return this.isSquare()&&0===this.determinant()},augment:function(e){var t=e.elements||e;void 0===t[0][0]&&(t=Matrix.create(t).elements);var n,r,i,s=this.dup(),o=s.elements[0].length,a=s.elements.length,l=a,c=t[0].length;if(a!=t.length)return null;do{n=l-a,r=c;do i=c-r,s.elements[n][o+i]=t[n][i];while(--r)}while(--a);return s},inverse:function(){if(!this.isSquare()||this.isSingular())return null;var e,t,n,r,i,s,o,a=this.elements.length,l=a,c=this.augment(Matrix.I(a)).toRightTriangular(),d=c.elements[0].length,h=[];do{e=a-1,i=[],n=d,h[e]=[],s=c.elements[e][e];do r=d-n,o=c.elements[e][r]/s,i.push(o),r>=l&&h[e].push(o);while(--n);for(c.elements[e]=i,t=0;e>t;t++){i=[],n=d;do r=d-n,i.push(c.elements[t][r]-c.elements[e][r]*c.elements[t][e]);while(--n);c.elements[t]=i}}while(--a);return Matrix.create(h)},setElements:function(e){var t,n=e.elements||e;if(void 0!==n[0][0]){var r,i,s,o=n.length,a=o;this.elements=[];do{t=a-o,r=n[t].length,i=r,this.elements[t]=[];do s=i-r,this.elements[t][s]=n[t][s];while(--r)}while(--o);return this}var l=n.length,c=l;this.elements=[];do t=c-l,this.elements.push([n[t]]);while(--l);return this}},Matrix.create=function(e){var t=new Matrix;return t.setElements(e)},Matrix.I=function(e){var t,n,r,i=[],s=e;do{t=s-e,i[t]=[],n=s;do r=s-n,i[t][r]=t==r?1:0;while(--n)}while(--e);return Matrix.create(i)},PureCSSMatrix=function(){"use strict";function e(e){e&&null!==e&&"none"!=e?e instanceof Matrix?this.setMatrix(e):this.setMatrixValue(e):this.m=Matrix.I(3)}function t(e){var t=parseFloat(n(e));return e.match(i)&&(t=2*Math.PI*t/360),t}function n(e){return e.match(s)}function r(e){return Number(e).toFixed(6)}var i=/deg$/,s=/([0-9.\-e]+)/g,o=/([a-zA-Z]+)\(([^\)]+)\)/g;return e.prototype.setMatrix=function(e){this.m=e},e.prototype.setMatrixValue=function(e){for(var r,i=Matrix.I(3);null!==(r=o.exec(e));){var s,a=r[1].toLowerCase(),l=r[2].split(",");if("matrix"==a)s=Matrix.create([[parseFloat(l[0]),parseFloat(l[2]),parseFloat(n(l[4]))],[parseFloat(l[1]),parseFloat(l[3]),parseFloat(n(l[5]))],[0,0,1]]);else if("translate"==a)s=Matrix.I(3),s.elements[0][2]=parseFloat(n(l[0])),s.elements[1][2]=parseFloat(n(l[1]));else if("scale"==a){var c,d=parseFloat(l[0]);c=l.length>1?parseFloat(l[1]):d,s=Matrix.create([[d,0,0],[0,c,0],[0,0,1]])}else"rotate"==a?s=Matrix.RotationZ(t(l[0])):"skew"==a||"skewx"==a?(s=Matrix.I(3),s.elements[0][1]=Math.tan(t(l[0]))):"skewy"==a?(s=Matrix.I(3),s.elements[1][0]=Math.tan(t(l[0]))):console.log("Problem with setMatrixValue",a,l);i=i.multiply(s)}this.m=i},e.prototype.multiply=function(t){return new e(this.m.multiply(t.m))},e.prototype.inverse=function(){return 1e-6>Math.abs(this.m.elements[0][0])&&(this.m.elements[0][0]=0),new e(this.m.inverse())},e.prototype.translate=function(t,n){var r=Matrix.I(3);return r.elements[0][2]=t,r.elements[1][2]=n,new e(this.m.multiply(r))},e.prototype.scale=function(t,n){var r=Matrix.create([[t,0,0],[0,n,0],[0,0,1]]);return new e(this.m.multiply(r))},e.prototype.rotate=function(t){var n=Matrix.RotationZ(t);return new e(this.m.multiply(n));
},e.prototype.toString=function(){var e=this.m.elements,t="";return($.browser.mozilla||$.browser.opera)&&(t="px"),"matrix("+r(e[0][0])+", "+r(e[1][0])+", "+r(e[0][1])+", "+r(e[1][1])+", "+r(e[0][2])+t+", "+r(e[1][2])+t+")"},e.prototype.elements=function(){var e=this.m.elements;return{a:e[0][0],b:e[1][0],c:e[0][1],d:e[1][1],e:e[0][2],f:e[1][2]}},e}(),$.zoomooz||($.zoomooz={}),$.zoomooz.helpers=function(e,t){"use strict";var n=["-moz-","-webkit-","-o-","-ms-"];return t.forEachPrefix=function(e,t){for(var r=0;n.length>r;r++)e(n[r]);t&&e("")},t.getElementTransform=function(n){var r;return t.forEachPrefix(function(t){r=r||e(n).css(t+"transform")},!0),r},t}(jQuery,{}),function(e){"use strict";function t(e,t,n){var r={};if(x.forEachPrefix(function(t){r[t+"transform"]=e},!0),t){var i=f(t/1e3,6)+"s";r["-webkit-transition-duration"]=i,r["-o-transition-duration"]=i,r["-moz-transition-duration"]=i}if(n){var s=o(n);r["-webkit-transition-timing-function"]=s,r["-o-transition-timing-function"]=s,r["-moz-transition-timing-function"]=s}return r}function n(e,t,n,s,o,l){t||(t=i(new PureCSSMatrix)),g=(new Date).getTime(),_&&(clearInterval(_),_=null),s.easing&&(s.easingfunction=a(s.easing,s.duration)),r(e,t,n,s,o),l&&l(),_=setInterval(function(){r(e,t,n,s,o)},1)}function r(e,n,r,i,o){var a,l=(new Date).getTime()-g;a=i.easingfunction?i.easingfunction(l/i.duration):l/i.duration,e.css(t(s(u(n,r,a)))),l>i.duration&&(clearInterval(_),_=null,a=1,o&&o())}function i(e){var t=e.elements(),n=t.a,r=t.b,i=t.c,s=t.d,o=t.e,a=t.f;if(.01>Math.abs(n*s-r*i))return void console.log("fail!");var l=o,c=a,d=Math.sqrt(n*n+r*r);n/=d,r/=d;var h=n*i+r*s;i-=n*h,s-=r*h;var u=Math.sqrt(i*i+s*s);i/=u,s/=u,h/=u,0>n*s-r*i&&(n=-n,r=-r,i=-i,s=-s,d=-d,u=-u);var f=Math.atan2(r,n);return{tx:l,ty:c,r:f,k:Math.atan(h),sx:d,sy:u}}function s(e){var t="";return t+="translate("+f(e.tx,6)+"px,"+f(e.ty,6)+"px) ",t+="rotate("+f(e.r,6)+"rad) skewX("+f(e.k,6)+"rad) ",t+="scale("+f(e.sx,6)+","+f(e.sy,6)+")"}function o(e){return e instanceof Array?"cubic-bezier("+f(e[0],6)+","+f(e[1],6)+","+f(e[2],6)+","+f(e[3],6)+")":e}function a(e,t){var n=[];if(e instanceof Array)n=e;else switch(e){case"linear":n=[0,0,1,1];break;case"ease":n=[.25,.1,.25,1];break;case"ease-in":n=[.42,0,1,1];break;case"ease-out":n=[0,0,.58,1];break;case"ease-in-out":n=[.42,0,.58,1]}var r=function(e){return l(e,n[0],n[1],n[2],n[3],t)};return r}function l(e,t,n,r,i,s){function o(e){return((u*e+f)*e+p)*e}function a(e){return((g*e+_)*e+m)*e}function l(e){return(3*u*e+2*f)*e+p}function c(e){return 1/(200*e)}function d(e,t){return a(h(e,t))}function h(e,t){function n(e){return e>=0?e:0-e}var r,i,s,a,c,d;for(s=e,d=0;8>d;d++){if(a=o(s)-e,t>n(a))return s;if(c=l(s),1e-6>n(c))break;s-=a/c}if(r=0,i=1,s=e,r>s)return r;if(s>i)return i;for(;i>r;){if(a=o(s),t>n(a-e))return s;e>a?r=s:i=s,s=.5*(i-r)+r}return s}var u=0,f=0,p=0,g=0,_=0,m=0;return p=3*t,f=3*(r-t)-p,u=1-p-f,m=3*n,_=3*(i-n)-m,g=1-m-_,d(e,c(s))}function c(e,t){var n,r=x.getElementTransform(e);n=r?new PureCSSMatrix(r):new PureCSSMatrix,t&&(n=n.translate(t.x,t.y));var s=i(n);return s.r=d(r),s}function d(e){for(var t,n=0;null!==(t=v.exec(e));){var r=t[1].toLowerCase(),s=t[2].split(",");if("matrix"==r){var o=r+"("+t[2]+")";n+=i(new PureCSSMatrix(o)).r}else if("rotate"==r){var a=s[0],l=parseFloat(p(a));a.match(b)&&(l=2*Math.PI*l/360),n+=l}}return n}function h(e,t){if(Math.abs(e.r-t.r)>Math.PI)if(t.r<e.r)for(;Math.abs(e.r-t.r)>Math.PI;)t.r+=2*Math.PI;else for(;Math.abs(e.r-t.r)>Math.PI;)t.r-=2*Math.PI;return t}function u(e,t,n){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]+(t[i]-e[i])*n);return r}function f(e,t){t=Math.abs(parseInt(t,10))||0;var n=Math.pow(10,t);return Math.round(e*n)/n}function p(e){return e.match(y)}var g,_,m,y=/([0-9.\-e]+)/g,v=/([a-z]+)\(([^\)]+)\)/g,b=/deg$/,x=e.zoomooz.helpers,k={duration:450,easing:"ease",nativeanimation:!1};jQuery.cssHooks.MsTransform={set:function(e,t){e.style.msTransform=t}},jQuery.cssHooks.MsTransformOrigin={set:function(e,t){e.style.msTransformOrigin=t}},e.fn.animateTransformation=function(r,o,a,l,d){o=jQuery.extend({},k,o),m&&(clearTimeout(m),m=null),o.nativeanimation&&l&&(m=setTimeout(l,o.duration)),this.each(function(){var u=e(this);r||(r=new PureCSSMatrix);var f=c(u,a),p=h(f,i(r));o.nativeanimation?(u.css(t(s(p),o.duration,o.easing)),d&&d()):n(u,f,p,o,l,d)})},e.fn.setTransformation=function(n){this.each(function(){var r=e(this),o=c(r),a=h(o,i(n));r.css(t(s(a)))})}}(jQuery),function(e){"use strict";function t(t,n){var r=jQuery.extend({},n);e.zoomooz.defaultSettings||e.zoomooz.setup();var i,s=e.zoomooz.defaultSettings,o=jQuery.extend({},r);for(i in s)s.hasOwnProperty(i)&&!o[i]&&(o[i]=t.data(i));for(var a=0;_.length>a;a++)i=_[a],o[i]||(o[i]=t.data(i));return jQuery.extend({},s,o)}function n(){var t=document.createElement("style");t.type="text/css";var n="";g.forEachPrefix(function(e){n+=e+"transform-origin: 0 0;"},!0),t.innerHTML="html {height:100%;}.noScroll{overflow:hidden !important;}* {"+n+"}",document.getElementsByTagName("head")[0].appendChild(t),e(document).ready(function(){var n=window.innerWidth-e("body").width();t.innerHTML+="body.noScroll,html.noScroll body{margin-right:"+n+"px;}"})}function r(){var t={targetsize:.9,scalemode:"both",root:e(document.body),debug:!1,animationendcallback:null,closeclick:!1},n=void 0!==window.mozInnerScreenX;return t.scrollresetbeforezoom=n,t}function i(t,n){var r,i=n.scrollresetbeforezoom,c=null;!function(){var e=n.root,a=e.parent();t[0]===e[0]?c=s(e,a):e.data("original-scroll")?i||(c=s(e,a)):(r=!0,c=o(e,a,i))}();var d,h=null;a(n.root);var f=null;if(t[0]!==n.root[0]){var p=u(t,n.root).inverse();i||(f=c),d=l(t,p,f,n),n.animationendcallback&&(h=function(){n.animationendcallback.call(t[0])})}else i&&(d=(new PureCSSMatrix).translate(-c.x,-c.y)),h=function(){var r=e(n.root),s=c.elem;s.removeClass("noScroll"),r.setTransformation(new PureCSSMatrix),r.data("original-scroll",null),e(document).off("touchmove"),i&&(s[0]==document.body||s[0]==window?window.scrollTo(c.x,c.y):(s.scrollLeft(c.x),s.scrollTop(c.y))),n.animationendcallback&&n.animationendcallback.call(t[0])};var g=null;i&&c&&c.animationstartedcallback&&(g=c.animationstartedcallback),r||(f=!1),e(n.root).animateTransformation(d,n,f,h,g)}function s(e,t){var n=e.data("original-scroll");return n||(n={elem:t,x:0,"y:":0}),n}function o(t,n,r){var i=t.scrollTop(),s=t.scrollLeft(),o=t;i||(i=n.scrollTop(),s=n.scrollLeft(),o=n);var a={elem:o,x:s,y:i};t.data("original-scroll",a),e(document).on("touchmove",function(e){e.preventDefault()});var l="translate(-"+s+"px,-"+i+"px)";return g.forEachPrefix(function(e){t.css(e+"transform",l)}),o.addClass("noScroll"),r&&(a.animationstartedcallback=function(){o[0]==document.body||o[0]==document?window.scrollTo(0,0):(o.scrollLeft(0),o.scrollTop(0))}),a}function a(t){var n=e(t).parent(),r=n.width(),i=n.height(),s=r/2,o=i/2,a=f(s)+"px "+f(o)+"px";g.forEachPrefix(function(e){t.css(e+"transform-origin",a)})}function l(t,n,r,i){var s,o=i.targetsize,a=i.scalemode,l=i.root,c=e(l).parent(),d=c.width(),h=c.height(),u=d/t.outerWidth(),f=h/t.outerHeight();if("width"==a)s=o*u;else if("height"==a)s=o*f;else if("both"==a)s=o*Math.min(u,f);else{if("scale"!=a)return void console.log("wrong zoommode");s=o}var p=(d-t.outerWidth()*s)/2,g=(h-t.outerHeight()*s)/2,_=d/2,m=h/2,y=-parseFloat(l.css("margin-left"))||0,v=-parseFloat(l.css("margin-top"))||0,b=new PureCSSMatrix;r&&(b=b.translate(r.x,r.y));var x=b.translate(y,v).translate(-_,-m).translate(p,g).scale(s,s).multiply(n).translate(_,m);return x}function c(e,t,n){return[e.a*t+e.c*n+e.e,e.b*t+e.d*n+e.f]}function d(e,t){var n=u(e,t.root).elements();h(c(n,0,0)),h(c(n,0,e.outerHeight())),h(c(n,e.outerWidth(),e.outerHeight())),h(c(n,e.outerWidth(),0))}function h(t){var n="width:4px;height:4px;background-color:red;position:absolute;margin-left:-2px;margin-top:-2px;";n+="left:"+t[0]+"px;top:"+t[1]+"px;";var r='<div class="debuglabel" style="'+n+'"></div>';e("#debug").append(r)}function u(t,n){var r=t[0];if(!r||!r.ownerDocument)return null;var i,s=new PureCSSMatrix;if(r===r.ownerDocument.body){var o=jQuery.offset.bodyOffset(r);return i=new PureCSSMatrix,i=i.translate(o.left,o.top),s=s.multiply(i)}var a;jQuery.offset.initialize?(jQuery.offset.initialize(),a={fixedPosition:jQuery.offset.supportsFixedPosition,doesNotAddBorder:jQuery.offset.doesNotAddBorder,doesAddBorderForTableAndCells:jQuery.support.doesAddBorderForTableAndCells,subtractsBorderForOverflowNotVisible:jQuery.offset.subtractsBorderForOverflowNotVisible}):a=jQuery.support;var l,c,d=r.offsetParent,h=r.ownerDocument,u=h.documentElement,f=h.body,g=n[0],_=h.defaultView;c=_?_.getComputedStyle(r,null):r.currentStyle;var m=r.offsetTop,y=r.offsetLeft,v=p().translate(y,m);for(v=v.multiply(p(r)),s=v.multiply(s);(r=r.parentNode)&&r!==g&&(m=0,y=0,!a.fixedPosition||"fixed"!==c.position);)l=_?_.getComputedStyle(r,null):r.currentStyle,m-=r.scrollTop,y-=r.scrollLeft,r===d&&(m+=r.offsetTop,y+=r.offsetLeft,!a.doesNotAddBorder||a.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(r.nodeName)||(m+=parseFloat(l.borderTopWidth)||0,y+=parseFloat(l.borderLeftWidth)||0),d=r.offsetParent),a.subtractsBorderForOverflowNotVisible&&"visible"!==l.overflow&&(m+=parseFloat(l.borderTopWidth)||0,y+=parseFloat(l.borderLeftWidth)||0),c=l,r.offsetParent==g&&(m-=parseFloat(e(r.offsetParent).css("margin-top"))||0,y-=parseFloat(e(r.offsetParent).css("margin-left"))||0),v=p().translate(y,m),v=v.multiply(p(r)),s=v.multiply(s);m=0,y=0,("relative"===c.position||"static"===c.position)&&(m+=f.offsetTop,y+=f.offsetLeft),a.fixedPosition&&"fixed"===c.position&&(m+=Math.max(u.scrollTop,f.scrollTop),y+=Math.max(u.scrollLeft,f.scrollLeft));var b=(new PureCSSMatrix).translate(y,m);return s=s.multiply(b)}function f(e){return Number(e).toFixed(6)}function p(e){var t=g.getElementTransform(e);return t?new PureCSSMatrix(t):new PureCSSMatrix}var g=e.zoomooz.helpers,_=["duration","easing","nativeanimation"];n(),e.zoomooz||(e.zoomooz={}),e.zoomooz.setup=function(t){e.zoomooz.defaultSettings=jQuery.extend(r(),t)},e.fn.zoomSettings=function(n){var r;return this.each(function(){var i=e(this);r=t(i,n)}),r},e.fn.zoomTo=function(t,n){return this.each(function(){var r=e(this);n||(t=r.zoomSettings(t)),i(r,t),t.debug?(0===e("#debug").length?e(t.root).append('<div id="debug"><div>'):e("#debug").html(""),d(r,t)):0!==e("#debug").length&&e("#debug").html("")}),this}}(jQuery),function(e){"use strict";function t(n,r,i){n.addClass("zoomTarget"),i.animationendcallback||(i.animationendcallback=i.closeclick?function(){e(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable"),n.addClass("selectedZoomTarget")}:function(){e(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable"),n.addClass("selectedZoomTarget zoomNotClickable")});var s=r.closest(".zoomContainer");0!==s.length&&(i.root=s);var o=i.root;if(!o.hasClass("zoomTarget")){var a=o.zoomSettings({});a.animationendcallback=function(){var t=e(this);e(".selectedZoomTarget").removeClass("selectedZoomTarget zoomNotClickable"),t.addClass("selectedZoomTarget zoomNotClickable"),t.parent().addClass("selectedZoomTarget zoomNotClickable")},t(o,o,a),t(o.parent(),o,a),o.click()}n.on("click",function(e){i.closeclick&&r.hasClass("selectedZoomTarget")?i.root.click():r.zoomTo(i),e.stopPropagation()})}function n(){function e(e){var t="-webkit-touch-callout: "+(e?"default":"none")+";";return r.forEachPrefix(function(n){t+=n+"user-select:"+(e?"text":"none")+";"},!0),t}var t=document.createElement("style");t.type="text/css",t.innerHTML=".zoomTarget{"+e(!1)+"}.zoomTarget:hover{cursor:pointer!important;}.zoomNotClickable{"+e(!0)+"}.zoomNotClickable:hover{cursor:auto!important;}.zoomContainer{position:relative;padding:1px;margin:-1px;}",document.getElementsByTagName("head")[0].appendChild(t)}e.zoomooz||(e.zoomooz={});var r=e.zoomooz.helpers;e.fn.zoomTarget=function(n){this.each(function(){var r=e(this).zoomSettings(n);t(e(this),e(this),r)})},n(),e(document).ready(function(){e(".zoomTarget").zoomTarget()})}(jQuery),function(e){"use strict";e.zoomooz||(e.zoomooz={}),e.fn.zoomContainer=function(){},e(document).ready(function(){e(".zoomContainer").zoomContainer()})}(jQuery),function(e){function t(t,r){var i=n(),s=jQuery.extend({},r);for(var o in i)i.hasOwnProperty(o)&&!s[o]&&(s[o]=i[o]instanceof jQuery?e(t.data(o)):t.data(o));return jQuery.extend({},i,s)}function n(){return{type:"next",root:e(document.body),wrap:"true"}}function r(e,t){e.addClass("zoomButton");var n;n=t.root.hasClass("zoomContainer")?t.root:t.root.find(".zoomContainer");var r=function(){function e(e){return o.indexOf(e)}function t(t){var n=e(t)+1;return o.length>n&&0!==n?o[n]:null}function r(t){var n=e(t)-1;return 0>n?null:o[n]}function i(){return o[0]}function s(){return o[o.length-1]}var o=jQuery.makeArray(n.find(".zoomTarget"));return{next:t,prev:r,last:s,first:i}}();e.on("click",function(e){var i,s=!0,o=n.find(".selectedZoomTarget");0===o.length&&(o=r.first()),0===t.type.indexOf("prev")?(i=r.prev(o[0]),null===i&&(t.wrap?i=r.last():s=!1)):(i=r.next(o[0]),null===i&&(t.wrap?i=r.first():s=!1)),s&&i.click(),e.stopPropagation()})}e.zoomooz||(e.zoomooz={}),e.zoomooz.helpers,e.fn.zoomButton=function(n){this.each(function(){var i=t(e(this),n);r(e(this),i)})},e(document).ready(function(){e(".zoomButton").zoomButton()})}(jQuery),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){"use strict";if(!e.jstree){var n,r,i=0,s=!1,o=!1,a=!1,l=[],c=e("script:last").attr("src"),d=window.document,h=d.createElement("LI");h.setAttribute("role","treeitem"),n=d.createElement("I"),n.className="jstree-icon jstree-ocl",n.setAttribute("role","presentation"),h.appendChild(n),n=d.createElement("A"),n.className="jstree-anchor",n.setAttribute("href","#"),n.setAttribute("tabindex","-1"),r=d.createElement("I"),r.className="jstree-icon jstree-themeicon",r.setAttribute("role","presentation"),n.appendChild(r),h.appendChild(n),n=r=null,e.jstree={version:"3.3.2",defaults:{plugins:[]},plugins:{},path:c&&c.indexOf("/")!==-1?c.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,n){var r=new e.jstree.core(++i),s=n;return n=e.extend(!0,{},e.jstree.defaults,n),s&&s.plugins&&(n.plugins=s.plugins),e.each(n.plugins,function(e,t){"core"!==e&&(r=r.plugin(t,n[t]))}),e(t).data("jstree",r),r.init(t,n),r},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(d).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var n=null,r=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!r||!r.length)try{r=e(t)}catch(e){}if(!r||!r.length)try{r=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(e){}return r&&r.length&&(r=r.closest(".jstree")).length&&(r=r.data("jstree"))?n=r:e(".jstree").each(function(){var r=e(this).data("jstree");if(r&&r._model.data[t])return n=r,!1}),n},e.fn.jstree=function(n){var r="string"==typeof n,i=Array.prototype.slice.call(arguments,1),s=null;return!(n===!0&&!this.length)&&(this.each(function(){var o=e.jstree.reference(this),a=r&&o?o[n]:null;if(s=r&&a?a.apply(o,i):null,o||r||n!==t&&!e.isPlainObject(n)||e.jstree.create(this,n),(o&&!r||n===!0)&&(s=o||!1),null!==s&&s!==t)return!1}),null!==s&&s!==t?s:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(){return function(n){return e(n).hasClass("jstree")&&e(n).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},e.jstree.core.prototype={plugin:function(t,n){var r=e.jstree.plugins[t];return r?(this._data[t]={},r.prototype=this,new r(n,this)):this},init:function(t,n){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=n,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().height()||24,this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",n=null,r=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(d.selection&&d.selection.empty)d.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",e.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),r=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",e.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),t.currentTarget!==d.activeElement&&e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(32!==t.which&&13!==t.which&&(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey))return!0;var n=null;switch(this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37)),t.which){case 32:t.ctrlKey&&(t.type="click",e(t.currentTarget).trigger(t));break;case 13:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(n=this.get_parent(t.currentTarget),n&&n.id!==e.jstree.root&&this.get_node(n,!0).children(".jstree-anchor").focus());break;case 38:t.preventDefault(),n=this.get_prev_dom(t.currentTarget),n&&n.length&&n.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):this.is_open(t.currentTarget)&&(n=this.get_node(t.currentTarget,!0).children(".jstree-children")[0],n&&e(this._firstChild(n)).children(".jstree-anchor").focus());break;case 40:t.preventDefault(),n=this.get_next_dom(t.currentTarget),n&&n.length&&n.children(".jstree-anchor").focus();break;case 106:this.open_all();break;case 36:t.preventDefault(),n=this._firstChild(this.get_container_ul()[0]),n&&e(n).children(".jstree-anchor").filter(":visible").focus();break;case 35:t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus();break;case 113:t.preventDefault(),this.edit(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,n){n.status&&(n.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(e.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var t,n,r=[];for(t=0,n=this._data.core.selected.length;t<n;t++)r=r.concat(this._model.data[this._data.core.selected[t]].parents);for(r=e.vakata.array_unique(r),t=0,n=r.length;t<n;t++)this.open_node(r[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",e.proxy(function(r){if(r.target.tagName&&"input"===r.target.tagName.toLowerCase())return!0;n&&clearTimeout(n),n=setTimeout(function(){t=""},500);var i=String.fromCharCode(r.which).toLowerCase(),s=this.element.find(".jstree-anchor").filter(":visible"),o=s.index(d.activeElement)||0,a=!1;if(t+=i,t.length>1){if(s.slice(o).each(e.proxy(function(n,r){if(0===e(r).name().toLowerCase().indexOf(t))return e(r).focus(),a=!0,!1},this)),a)return;if(s.slice(0,o).each(e.proxy(function(n,r){if(0===e(r).name().toLowerCase().indexOf(t))return e(r).focus(),a=!0,!1},this)),a)return}if(new RegExp("^"+i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(s.slice(o+1).each(e.proxy(function(t,n){if(e(n).name().toLowerCase().charAt(0)===i)return e(n).focus(),a=!0,!1},this)),a)return;if(s.slice(0,o+1).each(e.proxy(function(t,n){if(e(n).name().toLowerCase().charAt(0)===i)return e(n).focus(),a=!0,!1},this)),a)return}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){var n=this.get_node(t.currentTarget);n&&n.id&&(this._data.core.focused=n.id),this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",e.proxy(function(){if(+new Date-r>500&&!this._data.core.focused){r=0;var e=this.get_node(this.element.attr("aria-activedescendant"),!0);e&&e.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(d).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var n=this.settings.core.strings;return e.isFunction(n)?n.call(this,t):n&&n[t]?n[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,n){t&&t.id&&(t=t.id);var r;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(r=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=e(t,this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else{if(!(r=e(t,this.element)).length||!r.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return n&&(t=t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(e){return!1}},get_path:function(t,n,r){if(t=t.parents?t:this.get_node(t),!t||t.id===e.jstree.root||!t.parents)return!1;var i,s,o=[];for(o.push(r?t.id:t.name),i=0,s=t.parents.length;i<s;i++)o.push(r?t.parents[i]:this.get_text(t.parents[i]));return o=o.reverse().slice(1),n?o.join(n):o},get_next_dom:function(t,n){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this._firstChild(this.get_container_ul()[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);return!!r&&e(r)}if(!t||!t.length)return!1;if(n){r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return!!r&&e(r)}if(t.hasClass("jstree-open")){for(r=this._firstChild(t.children(".jstree-children")[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);if(null!==r)return e(r)}r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return null!==r?e(r):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,n){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this.get_container_ul()[0].lastChild;r&&0===r.offsetHeight;)r=this._previousSibling(r);return!!r&&e(r)}if(!t||!t.length)return!1;if(n){r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);return!!r&&e(r)}r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);if(null!==r){for(t=e(r);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return r=t[0].parentNode.parentNode,!(!r||!r.className||r.className.indexOf("jstree-node")===-1)&&e(r)},get_parent:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,n){var r,i,s,o,a;if(e.isArray(t))return this._load_nodes(t.slice(),n),!0;if(t=this.get_node(t),!t)return n&&n.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,s=0,o=t.parents.length;s<o;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_filter(this._model.data[t.parents[s]].children_d,function(n){return e.inArray(n,t.children_d)===-1});for(r=0,i=t.children_d.length;r<i;r++)this._model.data[t.children_d[r]].state.selected&&(a=!0),delete this._model.data[t.children_d[r]];a&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(n){return e.inArray(n,t.children_d)===-1})),t.children=[],t.children_d=[],a&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e,t.state.failed=!t.state.loaded;var r=this.get_node(t,!0),i=0,s=0,o=this._model.data,a=!1;for(i=0,s=t.children.length;i<s;i++)if(o[t.children[i]]&&!o[t.children[i]].state.hidden){a=!0;break}t.state.loaded&&r&&r.length&&(r.removeClass("jstree-closed jstree-open jstree-leaf"),a?"#"!==t.id&&r.addClass(t.state.opened?"jstree-open":"jstree-closed"):r.addClass("jstree-leaf")),r.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:t,status:e}),n&&n.call(this,t,e)},this)),!0},_load_nodes:function(e,t,n,r){var i,s,o=!0,a=function(){this._load_nodes(e,t,!0)},l=this._model.data,c=[];for(i=0,s=e.length;i<s;i++)l[e[i]]&&(!l[e[i]].state.loaded&&!l[e[i]].state.failed||!n&&r)&&(this.is_loading(e[i])||this.load_node(e[i],a),o=!1);if(o){for(i=0,s=e.length;i<s;i++)l[e[i]]&&l[e[i]].state.loaded&&c.push(e[i]);t&&!t.done&&(t.call(this,c),t.done=!0)}},load_all:function(t,n){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,i,s=[],o=this._model.data,a=o[t.id].children_d;for(t.state&&!t.state.loaded&&s.push(t.id),r=0,i=a.length;r<i;r++)o[a[r]]&&o[a[r]].state&&!o[a[r]].state.loaded&&s.push(a[r]);s.length?this._load_nodes(s,function(){this.load_all(t,n)}):(n&&n.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,n){var r,i=this.settings.core.data,s=function(){return 3!==this.nodeType&&8!==this.nodeType};return i?e.isFunction(i)?i.call(this,t,e.proxy(function(r){r===!1?n.call(this,!1):this["string"==typeof r?"_append_html_data":"_append_json_data"](t,"string"==typeof r?e(e.parseHTML(r)).filter(s):r,function(e){n.call(this,e)})},this)):"object"==typeof i?i.url?(i=e.extend(!0,{},i),e.isFunction(i.url)&&(i.url=i.url.call(this,t)),e.isFunction(i.data)&&(i.data=i.data.call(this,t)),e.ajax(i).done(e.proxy(function(r,i,o){var a=o.getResponseHeader("Content-Type");return a&&a.indexOf("json")!==-1||"object"==typeof r?this._append_json_data(t,r,function(e){n.call(this,e)}):a&&a.indexOf("html")!==-1||"string"==typeof r?this._append_html_data(t,e(e.parseHTML(r)).filter(s),function(e){n.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:o})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))},this)).fail(e.proxy(function(e){n.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(r=e.isArray(i)||e.isPlainObject(i)?JSON.parse(JSON.stringify(i)):i,t.id===e.jstree.root?this._append_json_data(t,r,function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))):"string"==typeof i?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(i)).filter(s),function(e){n.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1)):n.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){n.call(this,e)}):n.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,n,r){t=this.get_node(t),t.children=[],t.children_d=[];var i,s,o,a=n.is("ul")?n.children():n,l=t.id,c=[],d=[],h=this._model.data,u=h[l],f=this._data.core.selected.length;for(a.each(e.proxy(function(t,n){i=this._parse_model_from_html(e(n),l,u.parents.concat()),i&&(c.push(i),d.push(i),h[i].children_d.length&&(d=d.concat(h[i].children_d)))},this)),u.children=c,u.children_d=d,s=0,o=u.parents.length;s<o;s++)h[u.parents[s]].children_d=h[u.parents[s]].children_d.concat(d);this.trigger("model",{nodes:d,parent:l}),l!==e.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==f&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)},_append_json_data:function(t,n,r,i){if(null!==this.element){t=this.get_node(t),t.children=[],t.children_d=[],n.d&&(n=n.d,
"string"==typeof n&&(n=JSON.parse(n))),e.isArray(n)||(n=[n]);var s=null,o={df:this._model.default_state,dat:n,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},a=function(e,t){e.data&&(e=e.data);var n,r,i,s,o=e.dat,a=e.par,l=[],c=[],d=[],h=e.df,u=e.t_id,f=e.t_cnt,p=e.m,g=p[a],_=e.sel,m=function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,s,o,a,l=e.id.toString(),c={id:l,name:e.name||"",icon:e.icon===t||e.icon,parent:n,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(c.state[i]=h[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),c.icon!==t&&null!==c.icon&&""!==c.icon||(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(c.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(c.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(c.li_attr[i]=e.li_attr[i]);if(c.li_attr.id||(c.li_attr.id=l),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(c.a_attr[i]=e.a_attr[i]);for(e&&e.children&&e.children===!0&&(c.state.loaded=!1,c.children=[],c.children_d=[]),p[c.id]=c,i=0,s=c.children.length;i<s;i++)o=m(p[c.children[i]],c.id,r),a=p[o],c.children_d.push(o),a.children_d.length&&(c.children_d=c.children_d.concat(a.children_d));return delete e.data,delete e.children,p[c.id].original=e,c.state.selected&&d.push(c.id),c.id},y=function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,s,o,a,l,c=!1;do c="j"+u+"_"+ ++f;while(p[c]);l={id:!1,name:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:n,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(l.state[i]=h[i]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.name&&(l.name=e.name),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,s=e.children.length;i<s;i++)o=y(e.children[i],l.id,r),a=p[o],l.children.push(o),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,p[l.id]=l,l.state.selected&&d.push(l.id),l.id};if(o.length&&o[0].id!==t&&o[0].parent!==t){for(r=0,i=o.length;r<i;r++)o[r].children||(o[r].children=[]),p[o[r].id.toString()]=o[r];for(r=0,i=o.length;r<i;r++)p[o[r].parent.toString()].children.push(o[r].id.toString()),g.children_d.push(o[r].id.toString());for(r=0,i=g.children.length;r<i;r++)n=m(p[g.children[r]],a,g.parents.concat()),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d));for(r=0,i=g.parents.length;r<i;r++)p[g.parents[r]].children_d=p[g.parents[r]].children_d.concat(c);s={cnt:f,mod:p,sel:_,par:a,dpc:c,add:d}}else{for(r=0,i=o.length;r<i;r++)n=y(o[r],a,g.parents.concat()),n&&(l.push(n),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d)));for(g.children=l,g.children_d=c,r=0,i=g.parents.length;r<i;r++)p[g.parents[r]].children_d=p[g.parents[r]].children_d.concat(c);s={cnt:f,mod:p,sel:_,par:a,dpc:c,add:d}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?s:void postMessage(s)},l=function(t,n){if(null!==this.element){this._cnt=t.cnt;var i,s=this._model.data;for(i in s)s.hasOwnProperty(i)&&s[i].state&&s[i].state.loading&&t.mod[i]&&(t.mod[i].state.loading=!0);if(this._model.data=t.mod,n){var o,a=t.add,l=t.sel,c=this._data.core.selected.slice();if(s=this._model.data,l.length!==c.length||e.vakata.array_unique(l.concat(c)).length!==l.length){for(i=0,o=l.length;i<o;i++)e.inArray(l[i],a)===-1&&e.inArray(l[i],c)===-1&&(s[l[i]].state.selected=!1);for(i=0,o=c.length;i<o;i++)e.inArray(c[i],l)===-1&&(s[c[i]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),r.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+a.toString()],{type:"name/javascript"}))),!this._data.core.working||i?(this._data.core.working=!0,s=new window.Worker(this._wrk),s.onmessage=e.proxy(function(e){l.call(this,e.data,!0);try{s.terminate(),s=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),o.par?s.postMessage(o):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,n,r,!0])}catch(e){l.call(this,a(o),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else l.call(this,a(o),!1)}},_parse_model_from_html:function(n,r,i){i=i?[].concat(i):[],r&&i.unshift(r);var s,o,a,l,c,d=this._model.data,h={id:!1,name:!1,icon:!0,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in this._model.default_state)this._model.default_state.hasOwnProperty(a)&&(h.state[a]=this._model.default_state[a]);if(l=e.vakata.attributes(n,!0),e.each(l,function(t,n){return n=e.trim(n),!n.length||(h.li_attr[t]=n,void("id"===t&&(h.id=n.toString())))}),l=n.children("a").first(),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,n){n=e.trim(n),n.length&&(h.a_attr[t]=n)})),l=n.children("a").first().length?n.children("a").first().clone():n.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),h.name=this.settings.core.force_text?l.name():l.html(),l=n.data(),h.data=l?e.extend(!0,{},l):null,h.state.opened=n.hasClass("jstree-open"),h.state.selected=n.children("a").hasClass("jstree-clicked"),h.state.disabled=n.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(a in h.data.jstree)h.data.jstree.hasOwnProperty(a)&&(h.state[a]=h.data.jstree[a]);l=n.children("a").children(".jstree-themeicon"),l.length&&(h.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),h.state.icon!==t&&(h.icon=h.state.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),l=n.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(d[c]);return h.id=h.li_attr.id?h.li_attr.id.toString():c,l.length?(l.each(e.proxy(function(t,n){s=this._parse_model_from_html(e(n),h.id,i),o=this._model.data[s],h.children.push(s),o.children_d.length&&(h.children_d=h.children_d.concat(o.children_d))},this)),h.children_d=h.children_d.concat(h.children)):n.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr["class"]&&(h.li_attr["class"]=h.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),h.a_attr["class"]&&(h.a_attr["class"]=h.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),d[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,s,o,a,l=e.id.toString(),c=this._model.data,d=this._model.default_state,h={id:l,name:e.name||"",icon:e.icon===t||e.icon,parent:n,parents:r,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in d)d.hasOwnProperty(i)&&(h.state[i]=d[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(h.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(h.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(h.li_attr[i]=e.li_attr[i]);if(h.li_attr.id||(h.li_attr.id=l),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(h.a_attr[i]=e.a_attr[i]);for(e&&e.children&&e.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),c[h.id]=h,i=0,s=h.children.length;i<s;i++)o=this._parse_model_from_flat_json(c[h.children[i]],h.id,r),a=c[o],h.children_d.push(o),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d));return delete e.data,delete e.children,c[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,n,r){r=r?r.concat():[],n&&r.unshift(n);var i,s,o,a,l,c=!1,d=this._model.data,h=this._model.default_state;do c="j"+this._id+"_"+ ++this._cnt;while(d[c]);l={id:!1,name:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:n,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(l.state[i]=h[i]);if(e&&e.id&&(l.id=e.id.toString()),e&&e.name&&(l.name=e.name),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=c),l.li_attr.id||(l.li_attr.id=l.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,s=e.children.length;i<s;i++)o=this._parse_model_from_json(e.children[i],l.id,r),a=d[o],l.children.push(o),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));l.children_d=l.children_d.concat(l.children)}return e&&e.children&&e.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete e.data,delete e.children,l.original=e,d[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var t,n,r,i=this._model.force_full_redraw?this._model.data[e.jstree.root].children.concat([]):this._model.changed.concat([]),s=d.createElement("UL"),o=this._data.core.focused;for(n=0,r=i.length;n<r;n++)t=this.redraw_node(i[n],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&s.appendChild(t);this._model.force_full_redraw&&(s.className=this.get_container_ul()[0].className,s.setAttribute("role","group"),this.element.empty().append(s)),null!==o&&(t=this.get_node(o,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==d.activeElement?t.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:i})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var n=this.get_node(t),r=!1,i=!1,s=!1,o=d;if(!n)return!1;if(n.id===e.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],n.children.length&&n.state.loaded){for(s=o.createElement("UL"),s.setAttribute("role","group"),s.className="jstree-children",r=0,i=n.children.length;r<i;r++)s.appendChild(this.redraw_node(n.children[r],!0,!0));t.appendChild(s)}},redraw_node:function(t,n,r,i){var s=this.get_node(t),o=!1,a=!1,l=!1,c=!1,u=!1,f=!1,p="",g=d,_=this._model.data,m=!1,y=null,v=0,b=0,x=!1,k=!1;if(!s)return!1;if(s.id===e.jstree.root)return this.redraw(!0);if(n=n||0===s.children.length,t=d.querySelector?this.element[0].querySelector("#"+("0123456789".indexOf(s.id[0])!==-1?"\\3"+s.id[0]+" "+s.id.substr(1).replace(e.jstree.idregex,"\\$&"):s.id.replace(e.jstree.idregex,"\\$&"))):d.getElementById(s.id))t=e(t),r||(o=t.parent().parent()[0],o===this.element[0]&&(o=null),a=t.index()),n||!s.children.length||t.children(".jstree-children").length||(n=!0),n||(l=t.children(".jstree-children")[0]),m=t.children(".jstree-anchor")[0]===d.activeElement,t.remove();else if(n=!0,!r){if(o=s.parent!==e.jstree.root?e("#"+s.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===o||o&&_[s.parent].state.opened))return!1;a=e.inArray(s.id,null===o?_[e.jstree.root].children:_[s.parent].children)}t=h.cloneNode(!0),p="jstree-node ";for(c in s.li_attr)if(s.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?t.setAttribute(c,s.li_attr[c]):p+=s.li_attr[c]}for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),t.setAttribute("aria-selected",!!s.state.selected),t.setAttribute("aria-level",s.parents.length),t.setAttribute("aria-labelledby",s.a_attr.id),s.state.disabled&&t.setAttribute("aria-disabled",!0),c=0,u=s.children.length;c<u;c++)if(!_[s.children[c]].state.hidden){x=!0;break}if(null!==s.parent&&_[s.parent]&&!s.state.hidden&&(c=e.inArray(s.id,_[s.parent].children),k=s.id,c!==-1))for(c++,u=_[s.parent].children.length;c<u&&(_[_[s.parent].children[c]].state.hidden||(k=_[s.parent].children[c]),k===s.id);c++);s.state.hidden&&(p+=" jstree-hidden"),s.state.loaded&&!x?p+=" jstree-leaf":(p+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),k===s.id&&(p+=" jstree-last"),t.id=s.id,t.className=p,p=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":"");for(u in s.a_attr)if(s.a_attr.hasOwnProperty(u)){if("href"===u&&"#"===s.a_attr[u])continue;"class"!==u?t.childNodes[1].setAttribute(u,s.a_attr[u]):p+=" "+s.a_attr[u]}if(p.length&&(t.childNodes[1].className="jstree-anchor "+p),(s.icon&&s.icon!==!0||s.icon===!1)&&(s.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":s.icon.indexOf("/")===-1&&s.icon.indexOf(".")===-1?t.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+s.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(g.createTextNode(s.name)):t.childNodes[1].innerHTML+=s.name,n&&s.children.length&&(s.state.opened||i)&&s.state.loaded){for(f=g.createElement("UL"),f.setAttribute("role","group"),f.className="jstree-children",c=0,u=s.children.length;c<u;c++)f.appendChild(this.redraw_node(s.children[c],n,!0));t.appendChild(f)}if(l&&t.appendChild(l),!r){for(o||(o=this.element[0]),c=0,u=o.childNodes.length;c<u;c++)if(o.childNodes[c]&&o.childNodes[c].className&&o.childNodes[c].className.indexOf("jstree-children")!==-1){y=o.childNodes[c];break}y||(y=g.createElement("UL"),y.setAttribute("role","group"),y.className="jstree-children",o.appendChild(y)),o=y,a<o.childNodes.length?o.insertBefore(t,o.childNodes[a]):o.appendChild(t),m&&(v=this.element[0].scrollTop,b=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=v,this.element[0].scrollLeft=b)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(s.id,!1,0)},this),0)),t},open_node:function(n,r,i){var s,o,a,l;if(e.isArray(n)){for(n=n.slice(),s=0,o=n.length;s<o;s++)this.open_node(n[s],r,i);return!0}return n=this.get_node(n),!(!n||n.id===e.jstree.root)&&(i=i===t?this.settings.core.animation:i,this.is_closed(n)?this.is_loaded(n)?(a=this.get_node(n,!0),l=this,a.length&&(i&&a.children(".jstree-children").length&&a.children(".jstree-children").stop(!0,!0),n.children.length&&!this._firstChild(a.children(".jstree-children")[0])&&this.draw_children(n),i?(this.trigger("before_open",{node:n}),a.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(i,function(){this.style.display="",l.element&&l.trigger("after_open",{node:n})})):(this.trigger("before_open",{node:n}),a[0].className=a[0].className.replace("jstree-closed","jstree-open"),a[0].setAttribute("aria-expanded",!0))),n.state.opened=!0,r&&r.call(this,n,!0),a.length||this.trigger("before_open",{node:n}),this.trigger("open_node",{node:n}),i&&a.length||this.trigger("after_open",{node:n}),!0):this.is_loading(n)?setTimeout(e.proxy(function(){this.open_node(n,r,i)},this),500):void this.load_node(n,function(e,t){return t?this.open_node(e,r,i):!!r&&r.call(this,e,!1)}):(r&&r.call(this,n,!1),!1))},_open_to:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var n,r,i=t.parents;for(n=0,r=i.length;n<r;n+=1)n!==e.jstree.root&&this.open_node(i[n],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(n,r){var i,s,o,a;if(e.isArray(n)){for(n=n.slice(),i=0,s=n.length;i<s;i++)this.close_node(n[i],r);return!0}return n=this.get_node(n),!(!n||n.id===e.jstree.root)&&(!this.is_closed(n)&&(r=r===t?this.settings.core.animation:r,o=this,a=this.get_node(n,!0),n.state.opened=!1,this.trigger("close_node",{node:n}),void(a.length?r?a.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="",a.children(".jstree-children").remove(),o.element&&o.trigger("after_close",{node:n})}):(a[0].className=a[0].className.replace("jstree-open","jstree-closed"),a.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:n})):this.trigger("after_close",{node:n}))))},toggle_node:function(t){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.toggle_node(t[n]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,n,r){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var i,s,o,a=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!a.length){for(i=0,s=t.children_d.length;i<s;i++)this.is_closed(this._model.data[t.children_d[i]])&&(this._model.data[t.children_d[i]].state.opened=!0);return this.trigger("open_all",{node:t})}r=r||a,o=this,a=this.is_closed(t)?a.find(".jstree-closed").addBack():a.find(".jstree-closed"),a.each(function(){o.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,n,r)},n||0)}),0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(t,n){if(t||(t=e.jstree.root),t=this.get_node(t),!t)return!1;var r,i,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),o=this;for(s.length&&(s=this.is_open(t)?s.find(".jstree-open").addBack():s.find(".jstree-open"),e(s.get().reverse()).each(function(){o.close_node(this,n||0)})),r=0,i=t.children_d.length;r<i;r++)this._model.data[t.children_d[r]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.enable_node(t[n]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t}))},disable_node:function(t){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.disable_node(t[n]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t}))},is_hidden:function(e){return e=this.get_node(e),e.state.hidden===!0},hide_node:function(t,n){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.hide_node(t[r],!0);return n||this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),n||this.redraw(),this.trigger("hide_node",{node:t})))},show_node:function(t,n){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.show_node(t[r],!0);return n||this.redraw(),!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),n||this.redraw(),this.trigger("show_node",{node:t})))},hide_all:function(t){var n,r=this._model.data,i=[];for(n in r)r.hasOwnProperty(n)&&n!==e.jstree.root&&!r[n].state.hidden&&(r[n].state.hidden=!0,i.push(n));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:i}),i},show_all:function(t){var n,r=this._model.data,i=[];for(n in r)r.hasOwnProperty(n)&&n!==e.jstree.root&&r[n].state.hidden&&(r[n].state.hidden=!1,i.push(n));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:i}),i},activate_node:function(e,n){if(this.is_disabled(e))return!1;if(n&&"object"==typeof n||(n={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&(!n.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(n.shiftKey){var r,i,s=this.get_node(e).id,o=this._data.core.last_clicked.id,a=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(r=0,i=a.length;r<i;r+=1)a[r]===s&&(l=!l),a[r]===o&&(l=!l),this.is_disabled(a[r])||!l&&a[r]!==s&&a[r]!==o?this.deselect_node(a[r],!0,n):this.is_hidden(a[r])||this.select_node(a[r],!0,!1,n);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:n})}else this.is_selected(e)?this.deselect_node(e,!1,n):this.select_node(e,!1,!1,n);else!this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,n):(this.deselect_all(!0),this.select_node(e,!1,!1,n),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:n})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),n=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){n.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return e=this.get_node(e,!0),!!(e&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)}))},select_node:function(t,n,r,i){var s,o,a;if(e.isArray(t)){for(t=t.slice(),o=0,a=t.length;o<a;o++)this.select_node(t[o],n,r,i);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),r||(s=this._open_to(t)),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:i}),n||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:i}))))},deselect_node:function(t,n,r){var i,s,o;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;i<s;i++)this.deselect_node(t[i],n,r);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(o=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r}),n||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r}))))},select_all:function(t){var n,r,i=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),n=0,r=this._data.core.selected.length;n<r;n++)this._model.data[this._data.core.selected[n]]&&(this._model.data[this._data.core.selected[n]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})},deselect_all:function(e){var t,n,r=this._data.core.selected.concat([]);for(t=0,n=this._data.core.selected.length;t<n;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:r}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:r})},is_selected:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(t){var n,r,i,s,o=this.get_selected(!0),a={};for(n=0,r=o.length;n<r;n++)a[o[n].id]=o[n];for(n=0,r=o.length;n<r;n++)for(i=0,s=o[n].children_d.length;i<s;i++)a[o[n].children_d[i]]&&delete a[o[n].children_d[i]];o=[];for(n in a)a.hasOwnProperty(n)&&o.push(n);return t?e.map(o,e.proxy(function(e){return this.get_node(e)},this)):o},get_bottom_selected:function(t){var n,r,i=this.get_selected(!0),s=[];for(n=0,r=i.length;n<r;n++)i[n].children.length||s.push(i[n].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},get_state:function(){var t,n={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.opened&&n.core.open.push(t),this._model.data[t].state.selected&&n.core.selected.push(t));return n},set_state:function(n,r){if(n){if(n.core){var i,s;if(n.core.open)return e.isArray(n.core.open)&&n.core.open.length?this._load_nodes(n.core.open,function(e){this.open_node(e,!1,0),delete n.core.open,this.set_state(n,r)}):(delete n.core.open,this.set_state(n,r)),!1;if(n.core.scroll)return n.core.scroll&&n.core.scroll.left!==t&&this.element.scrollLeft(n.core.scroll.left),n.core.scroll&&n.core.scroll.top!==t&&this.element.scrollTop(n.core.scroll.top),delete n.core.scroll,this.set_state(n,r),!1;if(n.core.selected)return i=this,this.deselect_all(),e.each(n.core.selected,function(e,t){i.select_node(t,!1,!0)}),delete n.core.selected,this.set_state(n,r),!1;for(s in n)n.hasOwnProperty(s)&&"core"!==s&&e.inArray(s,this.settings.plugins)===-1&&delete n[s];if(e.isEmptyObject(n.core))return delete n.core,this.set_state(n,r),!1}return!e.isEmptyObject(n)||(n=null,r&&r.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,n){this._data.core.state=n===!0?{}:this.get_state(),n&&e.isFunction(n)&&(this._data.core.state=n.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var r=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+r+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,n){n&&(this.get_container_ul()[0].className=r,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var n=[],r=[],i=this._data.core.selected.concat([]);r.push(t.id),t.state.opened===!0&&n.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){r.push(this.id),n.push(this.id)}),this._load_nodes(r,e.proxy(function(e){this.open_node(n,!1,0),this.select_node(i),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(t,n){if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;var r,i,s=this._model.data,o=t.id;for(n=n.toString(),s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=n,r=0,i=t.parents.length;r<i;r++)s[t.parents[r]].children_d[e.inArray(t.id,s[t.parents[r]].children_d)]=n;for(r=0,i=t.children.length;r<i;r++)s[t.children[r]].parent=n;for(r=0,i=t.children_d.length;r<i;r++)s[t.children_d[r]].parents[e.inArray(t.id,s[t.children_d[r]].parents)]=n;return r=e.inArray(t.id,this._data.core.selected),r!==-1&&(this._data.core.selected[r]=n),r=this.get_node(t.id,!0),r&&(r.attr("id",n),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",n)),delete s[t.id],t.id=n,t.li_attr.id=n,s[n]=t,this.trigger("set_id",{node:t,"new":t.id,old:o}),!0},get_text:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.name},set_text:function(t,n){var r,i;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.set_text(t[r],n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(t.name=n,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,name:n}),!0)},get_json:function(t,n,r){if(t=this.get_node(t||e.jstree.root),!t)return!1;n&&n.flat&&!r&&(r=[]);var i,s,o={id:t.id,name:t.name,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!n||!n.no_data)&&e.extend(!0,{},t.data)};if(n&&n.flat?o.parent=t.parent:o.children=[],n&&n.no_state)delete o.state;else for(i in t.state)t.state.hasOwnProperty(i)&&(o.state[i]=t.state[i]);if(n&&n.no_li_attr&&delete o.li_attr,n&&n.no_a_attr&&delete o.a_attr,n&&n.no_id&&(delete o.id,o.li_attr&&o.li_attr.id&&delete o.li_attr.id,o.a_attr&&o.a_attr.id&&delete o.a_attr.id),n&&n.flat&&t.id!==e.jstree.root&&r.push(o),!n||!n.no_children)for(i=0,s=t.children.length;i<s;i++)n&&n.flat?this.get_json(t.children[i],n,r):o.children.push(this.get_json(t.children[i],n));return n&&n.flat?r:t.id===e.jstree.root?o.children:o},create_node:function(n,r,i,s,o){if(null===n&&(n=e.jstree.root),n=this.get_node(n),!n)return!1;if(i=i===t?"last":i,!i.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(n))return this.load_node(n,function(){this.create_node(n,r,i,s,!0)});r||(r={name:this.get_string("New node")}),"string"==typeof r&&(r={name:r}),r.name===t&&(r.name=this.get_string("New node"));var a,l,c,d;switch(n.id===e.jstree.root&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":a=this.get_node(n.parent),i=e.inArray(n.id,a.children),n=a;break;case"after":a=this.get_node(n.parent),i=e.inArray(n.id,a.children)+1,n=a;break;case"inside":case"first":i=0;break;case"last":i=n.children.length;break;default:i||(i=0)}if(i>n.children.length&&(i=n.children.length),r.id||(r.id=!0),!this.check("create_node",r,n,i))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.id===!0&&delete r.id,r=this._parse_model_from_json(r,n.id,n.parents.concat()),!r)return!1;for(a=this.get_node(r),l=[],l.push(r),l=l.concat(a.children_d),this.trigger("model",{nodes:l,parent:n.id}),n.children_d=n.children_d.concat(l),
c=0,d=n.parents.length;c<d;c++)this._model.data[n.parents[c]].children_d=this._model.data[n.parents[c]].children_d.concat(l);for(r=a,a=[],c=0,d=n.children.length;c<d;c++)a[c>=i?c+1:c]=n.children[c];return a[i]=r.id,n.children=a,this.redraw_node(n,!0),s&&s.call(this,this.get_node(r)),this.trigger("create_node",{node:this.get_node(r),parent:n.id,position:i}),r.id},rename_node:function(t,n){var r,i,s;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.rename_node(t[r],n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=t.name,this.check("rename_node",t,this.get_parent(t),n)?(this.set_text(t,n),this.trigger("rename_node",{node:t,name:n,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(t){var n,r,i,s,o,a,l,c,d,h,u,f;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.delete_node(t[n]);return!0}if(t=this.get_node(t),!t||t.id===e.jstree.root)return!1;if(i=this.get_node(t.parent),s=e.inArray(t.id,i.children),h=!1,!this.check("delete_node",t,i,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(s!==-1&&(i.children=e.vakata.array_remove(i.children,s)),o=t.children_d.concat([]),o.push(t.id),a=0,l=t.parents.length;a<l;a++)this._model.data[t.parents[a]].children_d=e.vakata.array_filter(this._model.data[t.parents[a]].children_d,function(t){return e.inArray(t,o)===-1});for(c=0,d=o.length;c<d;c++)if(this._model.data[o[c]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return e.inArray(t,o)===-1})),this.trigger("delete_node",{node:t,parent:i.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:i.id}),c=0,d=o.length;c<d;c++)delete this._model.data[o[c]];return e.inArray(this._data.core.focused,o)!==-1&&(this._data.core.focused=null,u=this.element[0].scrollTop,f=this.element[0].scrollLeft,i.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(i,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=f),this.redraw_node(i,!0),!0},check:function(t,n,r,i,s){n=n&&n.id?n:this.get_node(n),r=r&&r.id?r:this.get_node(r);var o=t.match(/^move_node|copy_node|create_node$/i)?r:n,a=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||s&&s.is_multi||n.id!==r.id&&("move_node"!==t||e.inArray(n.id,r.children)!==i)&&e.inArray(r.id,n.children_d)===-1?(o&&o.data&&(o=o.data),o&&o.functions&&(o.functions[t]===!1||o.functions[t]===!0)?(o.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:i,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})}),o.functions[t]):!(a===!1||e.isFunction(a)&&a.call(this,t,n,r,i,s)===!1||a&&a[t]===!1)||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:i,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:i,obj:!(!n||!n.id)&&n.id,par:!(!r||!r.id)&&r.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(n,r,i,s,o,a,l){var c,d,h,u,f,p,g,_,m,y,v,b,x,k;if(r=this.get_node(r),i=i===t?0:i,!r)return!1;if(!i.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return this.load_node(r,function(){this.move_node(n,r,i,s,!0,!1,l)});if(e.isArray(n)){if(1!==n.length){for(c=0,d=n.length;c<d;c++)(m=this.move_node(n[c],r,i,s,o,!1,l))&&(r=m,i="after");return this.redraw(),!0}n=n[0]}if(n=n&&n.id?n:this.get_node(n),!n||n.id===e.jstree.root)return!1;if(h=(n.parent||e.jstree.root).toString(),f=i.toString().match(/^(before|after)$/)&&r.id!==e.jstree.root?this.get_node(r.parent):r,p=l?l:this._model.data[n.id]?this:e.jstree.reference(n.id),g=!p||!p._id||this._id!==p._id,u=p&&p._id&&h&&p._model.data[h]&&p._model.data[h].children?e.inArray(n.id,p._model.data[h].children):-1,p&&p._id&&(n=p._model.data[n.id]),g)return!!(m=this.copy_node(n,r,i,s,o,!1,l))&&(p&&p.delete_node(n),m);switch(r.id===e.jstree.root&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=e.inArray(r.id,f.children);break;case"after":i=e.inArray(r.id,f.children)+1;break;case"inside":case"first":i=0;break;case"last":i=f.children.length;break;default:i||(i=0)}if(i>f.children.length&&(i=f.children.length),!this.check("move_node",n,f,i,{core:!0,origin:l,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.parent===f.id){for(_=f.children.concat(),m=e.inArray(n.id,_),m!==-1&&(_=e.vakata.array_remove(_,m),i>m&&i--),m=[],y=0,v=_.length;y<v;y++)m[y>=i?y+1:y]=_[y];m[i]=n.id,f.children=m,this._node_changed(f.id),this.redraw(f.id===e.jstree.root)}else{for(m=n.children_d.concat(),m.push(n.id),y=0,v=n.parents.length;y<v;y++){for(_=[],k=p._model.data[n.parents[y]].children_d,b=0,x=k.length;b<x;b++)e.inArray(k[b],m)===-1&&_.push(k[b]);p._model.data[n.parents[y]].children_d=_}for(p._model.data[h].children=e.vakata.array_remove_item(p._model.data[h].children,n.id),y=0,v=f.parents.length;y<v;y++)this._model.data[f.parents[y]].children_d=this._model.data[f.parents[y]].children_d.concat(m);for(_=[],y=0,v=f.children.length;y<v;y++)_[y>=i?y+1:y]=f.children[y];for(_[i]=n.id,f.children=_,f.children_d.push(n.id),f.children_d=f.children_d.concat(n.children_d),n.parent=f.id,m=f.parents.concat(),m.unshift(f.id),k=n.parents.length,n.parents=m,m=m.concat(),y=0,v=n.children_d.length;y<v;y++)this._model.data[n.children_d[y]].parents=this._model.data[n.children_d[y]].parents.slice(0,k*-1),Array.prototype.push.apply(this._model.data[n.children_d[y]].parents,m);h!==e.jstree.root&&f.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(f.id)),a||this.redraw()}return s&&s.call(this,n,f,i),this.trigger("move_node",{node:n,parent:f.id,position:i,old_parent:h,old_position:u,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),n.id},copy_node:function(n,r,i,s,o,a,l){var c,d,h,u,f,p,g,_,m,y,v;if(r=this.get_node(r),i=i===t?0:i,!r)return!1;if(!i.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return this.load_node(r,function(){this.copy_node(n,r,i,s,!0,!1,l)});if(e.isArray(n)){if(1!==n.length){for(c=0,d=n.length;c<d;c++)(u=this.copy_node(n[c],r,i,s,o,!0,l))&&(r=u,i="after");return this.redraw(),!0}n=n[0]}if(n=n&&n.id?n:this.get_node(n),!n||n.id===e.jstree.root)return!1;switch(_=(n.parent||e.jstree.root).toString(),m=i.toString().match(/^(before|after)$/)&&r.id!==e.jstree.root?this.get_node(r.parent):r,y=l?l:this._model.data[n.id]?this:e.jstree.reference(n.id),v=!y||!y._id||this._id!==y._id,y&&y._id&&(n=y._model.data[n.id]),r.id===e.jstree.root&&("before"===i&&(i="first"),"after"===i&&(i="last")),i){case"before":i=e.inArray(r.id,m.children);break;case"after":i=e.inArray(r.id,m.children)+1;break;case"inside":case"first":i=0;break;case"last":i=m.children.length;break;default:i||(i=0)}if(i>m.children.length&&(i=m.children.length),!this.check("copy_node",n,m,i,{core:!0,origin:l,is_multi:y&&y._id&&y._id!==this._id,is_foreign:!y||!y._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(g=y?y.get_json(n,{no_id:!0,no_data:!0,no_state:!0}):n,!g)return!1;if(g.id===!0&&delete g.id,g=this._parse_model_from_json(g,m.id,m.parents.concat()),!g)return!1;for(u=this.get_node(g),n&&n.state&&n.state.loaded===!1&&(u.state.loaded=!1),h=[],h.push(g),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:m.id}),f=0,p=m.parents.length;f<p;f++)this._model.data[m.parents[f]].children_d=this._model.data[m.parents[f]].children_d.concat(h);for(h=[],f=0,p=m.children.length;f<p;f++)h[f>=i?f+1:f]=m.children[f];return h[i]=u.id,m.children=h,m.children_d.push(u.id),m.children_d=m.children_d.concat(u.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),a||this.redraw(m.id===e.jstree.root),s&&s.call(this,u,m,i),this.trigger("copy_node",{node:u,original:n,parent:m.id,position:i,old_parent:_,old_position:y&&y._id&&_&&y._model.data[_]&&y._model.data[_].children?e.inArray(n.id,y._model.data[_].children):-1,is_multi:y&&y._id&&y._id!==this._id,is_foreign:!y||!y._id,old_instance:y,new_instance:this}),u.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var n,r,i,l=[];for(r=0,i=t.length;r<i;r++)n=this.get_node(t[r]),n&&n.id&&n.id!==e.jstree.root&&l.push(n);return!!l.length&&(s=l,a=this,o="move_node",void this.trigger("cut",{node:t}))},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;var n,r,i,l=[];for(r=0,i=t.length;r<i;r++)n=this.get_node(t[r]),n&&n.id&&n.id!==e.jstree.root&&l.push(n);return!!l.length&&(s=l,a=this,o="copy_node",void this.trigger("copy",{node:t}))},get_buffer:function(){return{mode:o,node:s,inst:a}},can_paste:function(){return o!==!1&&s!==!1},paste:function(e,t){return e=this.get_node(e),!!(e&&o&&o.match(/^(copy_node|move_node)$/)&&s)&&(this[o](s,e,t,!1,!1,!1,a)&&this.trigger("paste",{parent:e.id,node:s,mode:o}),s=!1,o=!1,void(a=!1))},clear_buffer:function(){s=!1,o=!1,a=!1,this.trigger("clear_buffer")},edit:function(t,n,r){var i,s,o,a,l,c,h,u,f,p=!1;return!!(t=this.get_node(t))&&(this.settings.core.check_callback===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1):(f=t,n="string"==typeof n?n:t.name,this.set_text(t,""),t=this._open_to(t),f.name=n,i=this._data.core.rtl,s=this.element.width(),this._data.core.focused=f.id,o=t.children(".jstree-anchor").focus(),a=e("<span>"),l=n,c=e("<div />",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h=e("<input />",{value:l,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(n){n.stopImmediatePropagation(),n.preventDefault();var i,s=a.children(".jstree-rename-input"),d=s.val(),u=this.settings.core.force_text;""===d&&(d=l),c.remove(),a.replaceWith(o),a.remove(),l=u?l:e("<div></div>").append(e.parseHTML(l)).html(),this.set_text(t,l),i=!!this.rename_node(t,u?e("<div></div>").name(d).name():e("<div></div>").append(e.parseHTML(d)).html()),i||this.set_text(t,l),this._data.core.focused=f.id,setTimeout(e.proxy(function(){var e=this.get_node(f.id,!0);e.length&&(this._data.core.focused=f.id,e.children(".jstree-anchor").focus())},this),0),r&&r.call(this,f,i,p),h=null},this),keydown:function(e){var t=e.which;27===t&&(p=!0,this.value=l),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(){h.width(Math.min(c.name("pW"+this.value).width(),s))},keypress:function(e){if(13===e.which)return!1}}),u={fontFamily:o.css("fontFamily")||"",fontSize:o.css("fontSize")||"",fontWeight:o.css("fontWeight")||"",fontStyle:o.css("fontStyle")||"",fontStretch:o.css("fontStretch")||"",fontVariant:o.css("fontVariant")||"",letterSpacing:o.css("letterSpacing")||"",wordSpacing:o.css("wordSpacing")||""},a.attr("class",o.attr("class")).append(o.contents().clone()).append(h),o.replaceWith(a),c.css(u),h.css(u).width(Math.min(c.name("pW"+h[0].value).width(),s))[0].select(),void e(d).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).blur()})))},set_theme:function(t,n){if(!t)return!1;if(n===!0){var r=this.settings.core.themes.dir;r||(r=e.jstree.path+"/themes"),n=r+"/"+t+"/style.css"}n&&e.inArray(n,l)===-1&&(e("head").append('<link rel="stylesheet" href="'+n+'" type="name/css" />'),l.push(n)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(n,r){var i,s,o,a;if(e.isArray(n)){for(n=n.slice(),i=0,s=n.length;i<s;i++)this.set_icon(n[i],r);return!0}return n=this.get_node(n),!(!n||n.id===e.jstree.root)&&(a=n.icon,n.icon=r===!0||null===r||r===t||""===r||r,o=this.get_node(n,!0).children(".jstree-anchor").children(".jstree-themeicon"),r===!1?this.hide_icon(n):r===!0||null===r||r===t||""===r?(o.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),a===!1&&this.show_icon(n)):r.indexOf("/")===-1&&r.indexOf(".")===-1?(o.removeClass(a).css("background",""),o.addClass(r+" jstree-themeicon-custom").attr("rel",r),a===!1&&this.show_icon(n)):(o.removeClass(a).css("background",""),o.addClass("jstree-themeicon-custom").css("background","url('"+r+"') center center no-repeat").attr("rel",r),a===!1&&this.show_icon(n)),!0)},get_icon:function(t){return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var n,r;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.hide_icon(t[n]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(t){var n,r,i;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.show_icon(t[n]);return!0}return t=this.get_node(t),!(!t||t===e.jstree.root)&&(i=this.get_node(t,!0),t.icon=!i.length||i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},e.vakata={},e.vakata.attributes=function(t,n){t=e(t)[0];var r=n?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,i){e.inArray(i.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])===-1&&null!==i.value&&""!==e.trim(i.value)&&(n?r[i.name]=i.value:r.push(i.name))}),r},e.vakata.array_unique=function(e){var n,r,i=[],s={};for(n=0,r=e.length;n<r;n++)s[e[n]]===t&&(i.push(e[n]),s[e[n]]=!0);return i},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,n){var r=e.inArray(n,t);return r!==-1?e.vakata.array_remove(t,r):t},e.vakata.array_filter=function(e,t,n,r,i){if(e.filter)return e.filter(t,n);r=[];for(i in e)~~i+""==i+""&&i>=0&&t.call(n,e[i],+i,e)&&r.push(e[i]);return r},e.jstree.plugins.changed=function(e,t){var n=[];this.trigger=function(e,r){var i,s;if(r||(r={}),"changed"===e.replace(".jstree","")){r.changed={selected:[],deselected:[]};var o={};for(i=0,s=n.length;i<s;i++)o[n[i]]=1;for(i=0,s=r.selected.length;i<s;i++)o[r.selected[i]]?o[r.selected[i]]=2:r.changed.selected.push(r.selected[i]);for(i=0,s=n.length;i<s;i++)1===o[n[i]]&&r.changed.deselected.push(n[i]);n=r.selected.slice()}t.trigger.call(this,e,r)},this.refresh=function(){return n=[],t.refresh.apply(this,arguments)}};var u=d.createElement("I");u.className="jstree-icon jstree-checkbox",u.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(n,r){this.bind=function(){r.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),this.settings.checkbox.cascade.indexOf("undetermined")!==-1&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){var n,r,i=this._model.data,s=(i[t.parent],t.nodes);for(n=0,r=s.length;n<r;n++)i[s[n]].state.checked=i[s[n]].state.checked||i[s[n]].original&&i[s[n]].original.state&&i[s[n]].original.state.checked,i[s[n]].state.checked&&this._data.checkbox.selected.push(s[n])},this)),this.settings.checkbox.cascade.indexOf("up")===-1&&this.settings.checkbox.cascade.indexOf("down")===-1||this.element.on("model.jstree",e.proxy(function(t,n){var r,i,s,o,a,l,c=this._model.data,d=c[n.parent],h=n.nodes,u=[],f=this.settings.checkbox.cascade,p=this.settings.checkbox.tie_selection;if(f.indexOf("down")!==-1)if(d.state[p?"selected":"checked"]){for(i=0,s=h.length;i<s;i++)c[h[i]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(h)}else for(i=0,s=h.length;i<s;i++)if(c[h[i]].state[p?"selected":"checked"]){for(o=0,a=c[h[i]].children_d.length;o<a;o++)c[c[h[i]].children_d[o]].state[p?"selected":"checked"]=!0;this._data[p?"core":"checkbox"].selected=this._data[p?"core":"checkbox"].selected.concat(c[h[i]].children_d)}if(f.indexOf("up")!==-1){for(i=0,s=d.children_d.length;i<s;i++)c[d.children_d[i]].children.length||u.push(c[d.children_d[i]].parent);for(u=e.vakata.array_unique(u),o=0,a=u.length;o<a;o++)for(d=c[u[o]];d&&d.id!==e.jstree.root;){for(r=0,i=0,s=d.children.length;i<s;i++)r+=c[d.children[i]].state[p?"selected":"checked"];if(r!==s)break;d.state[p?"selected":"checked"]=!0,this._data[p?"core":"checkbox"].selected.push(d.id),l=this.get_node(d,!0),l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(p?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}}this._data[p?"core":"checkbox"].selected=e.vakata.array_unique(this._data[p?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,n){var r,i,s,o,a=n.node,l=this._model.data,c=this.get_node(a.parent),d=this.get_node(a,!0),h=this.settings.checkbox.cascade,u=this.settings.checkbox.tie_selection,f={},p=this._data[u?"core":"checkbox"].selected;for(r=0,i=p.length;r<i;r++)f[p[r]]=!0;if(h.indexOf("down")!==-1)for(r=0,i=a.children_d.length;r<i;r++)f[a.children_d[r]]=!0,o=l[a.children_d[r]],o.state[u?"selected":"checked"]=!0,o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1);if(h.indexOf("up")!==-1)for(;c&&c.id!==e.jstree.root;){for(s=0,r=0,i=c.children.length;r<i;r++)s+=l[c.children[r]].state[u?"selected":"checked"];if(s!==i)break;c.state[u?"selected":"checked"]=!0,f[c.id]=!0,o=this.get_node(c,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}p=[];for(r in f)f.hasOwnProperty(r)&&p.push(r);this._data[u?"core":"checkbox"].selected=p,h.indexOf("down")!==-1&&d.length&&d.find(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!0)},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(){var t,n,r,i=this.get_node(e.jstree.root),s=this._model.data;for(t=0,n=i.children_d.length;t<n;t++)r=s[i.children_d[t]],r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,n){var r,i,s,o=n.node,a=this.get_node(o,!0),l=this.settings.checkbox.cascade,c=this.settings.checkbox.tie_selection,d=this._data[c?"core":"checkbox"].selected,h={};if(o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1),l.indexOf("down")!==-1)for(r=0,i=o.children_d.length;r<i;r++)s=this._model.data[o.children_d[r]],s.state[c?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(l.indexOf("up")!==-1)for(r=0,i=o.parents.length;r<i;r++)s=this._model.data[o.parents[r]],s.state[c?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),s=this.get_node(o.parents[r],!0),s&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked");for(h={},r=0,i=d.length;r<i;r++)l.indexOf("down")!==-1&&e.inArray(d[r],o.children_d)!==-1||l.indexOf("up")!==-1&&e.inArray(d[r],o.parents)!==-1||(h[d[r]]=!0);d=[];for(r in h)h.hasOwnProperty(r)&&d.push(r);this._data[c?"core":"checkbox"].selected=d,l.indexOf("down")!==-1&&a.length&&a.find(".jstree-anchor").removeClass(c?"jstree-clicked":"jstree-checked").parent().attr("aria-selected",!1)},this)),this.settings.checkbox.cascade.indexOf("up")!==-1&&this.element.on("delete_node.jstree",e.proxy(function(t,n){for(var r,i,s,o,a=this.get_node(n.parent),l=this._model.data,c=this.settings.checkbox.tie_selection;a&&a.id!==e.jstree.root&&!a.state[c?"selected":"checked"];){for(s=0,r=0,i=a.children.length;r<i;r++)s+=l[a.children[r]].state[c?"selected":"checked"];if(!(i>0&&s===i))break;a.state[c?"selected":"checked"]=!0,this._data[c?"core":"checkbox"].selected.push(a.id),o=this.get_node(a,!0),o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(c?"jstree-clicked":"jstree-checked"),a=this.get_node(a.parent)}},this)).on("move_node.jstree",e.proxy(function(t,n){var r,i,s,o,a,l=n.is_multi,c=n.old_parent,d=this.get_node(n.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!l)for(r=this.get_node(c);r&&r.id!==e.jstree.root&&!r.state[u?"selected":"checked"];){for(i=0,s=0,o=r.children.length;s<o;s++)i+=h[r.children[s]].state[u?"selected":"checked"];if(!(o>0&&i===o))break;r.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(r.id),a=this.get_node(r,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),r=this.get_node(r.parent)}for(r=d;r&&r.id!==e.jstree.root;){for(i=0,s=0,o=r.children.length;s<o;s++)i+=h[r.children[s]].state[u?"selected":"checked"];if(i===o)r.state[u?"selected":"checked"]||(r.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(r.id),a=this.get_node(r,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!r.state[u?"selected":"checked"])break;r.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,r.id),a=this.get_node(r,!0),a&&a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}r=this.get_node(r.parent)}},this))},this._undetermined=function(){if(null!==this.element){var n,r,i,s,o={},a=this._model.data,l=this.settings.checkbox.tie_selection,c=this._data[l?"core":"checkbox"].selected,d=[],h=this;for(n=0,r=c.length;n<r;n++)if(a[c[n]]&&a[c[n]].parents)for(i=0,s=a[c[n]].parents.length;i<s&&o[a[c[n]].parents[i]]===t;i++)a[c[n]].parents[i]!==e.jstree.root&&(o[a[c[n]].parents[i]]=!0,d.push(a[c[n]].parents[i]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var l,c=h.get_node(this);if(c.state.loaded){for(n=0,r=c.children_d.length;n<r;n++)if(l=a[c.children_d[n]],!l.state.loaded&&l.original&&l.original.state&&l.original.state.undetermined&&l.original.state.undetermined===!0)for(o[l.id]===t&&l.id!==e.jstree.root&&(o[l.id]=!0,d.push(l.id)),i=0,s=l.parents.length;i<s;i++)o[l.parents[i]]===t&&l.parents[i]!==e.jstree.root&&(o[l.parents[i]]=!0,d.push(l.parents[i]))}else if(c.original&&c.original.state&&c.original.state.undetermined&&c.original.state.undetermined===!0)for(o[c.id]===t&&c.id!==e.jstree.root&&(o[c.id]=!0,d.push(c.id)),i=0,s=c.parents.length;i<s;i++)o[c.parents[i]]===t&&c.parents[i]!==e.jstree.root&&(o[c.parents[i]]=!0,d.push(c.parents[i]))}),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),n=0,r=d.length;n<r;n++)a[d[n]].state[l?"selected":"checked"]||(c=this.get_node(d[n],!0),c&&c.length&&c.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))}},this.redraw_node=function(t,n,i){if(t=r.redraw_node.apply(this,arguments)){var s,o,a=null,l=null;for(s=0,o=t.childNodes.length;s<o;s++)if(t.childNodes[s]&&t.childNodes[s].className&&t.childNodes[s].className.indexOf("jstree-anchor")!==-1){a=t.childNodes[s];break}a&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(a.className+=" jstree-checked"),l=u.cloneNode(!1),this._model.data[t.id].state.checkbox_disabled&&(l.className+=" jstree-checkbox-disabled"),a.insertBefore(l,a.childNodes[0]))}return i||this.settings.checkbox.cascade.indexOf("undetermined")===-1||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var n,r,i=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,o=this._data[s?"core":"checkbox"].selected,a=this._model.data;if(!t||t.state[s?"selected":"checked"]===!0||i.indexOf("undetermined")===-1||i.indexOf("down")===-1&&i.indexOf("up")===-1)return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(n=0,r=t.children_d.length;n<r;n++)if(e.inArray(t.children_d[n],o)!==-1||!a[t.children_d[n]].state.loaded&&a[t.children_d[n]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var n,r,i;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.disable_checkbox(t[n]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(i=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))))},this.enable_checkbox=function(t){var n,r,i;if(e.isArray(t)){for(t=t.slice(),n=0,r=t.length;n<r;n++)this.enable_checkbox(t[n]);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(i=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))))},this.activate_node=function(t,n){return!e(n.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(n.target).hasClass("jstree-checkbox"))&&(n.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(n.target).hasClass("jstree-checkbox")?r.activate_node.call(this,t,n):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,n):this.check_node(t,n),void this.trigger("activate_node",{node:this.get_node(t)})))},this.check_node=function(t,n){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,n);var r,i,s;if(e.isArray(t)){for(t=t.slice(),i=0,s=t.length;i<s;i++)this.check_node(t[i],n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(r=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:n}))))},this.uncheck_node=function(t,n){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,n);var r,i,s;if(e.isArray(t)){for(t=t.slice(),r=0,i=t.length;r<i;r++)this.uncheck_node(t[r],n);return!0}return t=this.get_node(t),!(!t||t.id===e.jstree.root)&&(s=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:n}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,n;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,n=this._data.checkbox.selected.length;t<n;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var e,t,n=this._data.checkbox.selected.concat([]);for(e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:n})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),!(!t||t.id===e.jstree.root)&&t.state.checked)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);var n,r,i,s,o=this.get_checked(!0),a={};for(n=0,r=o.length;n<r;n++)a[o[n].id]=o[n];for(n=0,r=o.length;n<r;n++)for(i=0,s=o[n].children_d.length;i<s;i++)a[o[n].children_d[i]]&&delete a[o[n].children_d[i]];o=[];for(n in a)a.hasOwnProperty(n)&&o.push(n);return t?e.map(o,e.proxy(function(e){return this.get_node(e)},this)):o},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);var n,r,i=this.get_checked(!0),s=[];for(n=0,r=i.length;n<r;n++)i[n].children.length||s.push(i[n].id);return t?e.map(s,e.proxy(function(e){return this.get_node(e)},this)):s},this.load_node=function(t){var n,i,s,o;if(!e.isArray(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t),o&&o.state.loaded))for(n=0,i=o.children_d.length;n<i;n++)this._model.data[o.children_d[n]].state.checked&&(s=!0,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[n]));
return r.load_node.apply(this,arguments)},this.get_state=function(){var e=r.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?e:(e.checkbox=this._data.checkbox.selected.slice(),e)},this.set_state=function(t,n){var i=r.set_state.apply(this,arguments);if(i&&t.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var s=this;e.each(t.checkbox,function(e,t){s.check_node(t)})}return delete t.checkbox,this.set_state(t,n),!1}return i},this.refresh=function(){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),r.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,n){this.settings.conditionalselect.call(this,this.get_node(e),n)&&t.activate_node.call(this,e,n)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.create_node(r,{},"last",function(e){setTimeout(function(){n.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.delete_node(n.get_selected()):n.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.cut(n.get_top_selected()):n.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.is_selected(r)?n.copy(n.get_top_selected()):n.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var n=e.jstree.reference(t.reference),r=n.get_node(t.reference);n.paste(r)}}}}}}},e.jstree.plugins.contextmenu=function(n,r){this.bind=function(){r.bind.call(this);var t,n,i=0,s=null;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),i=e.ctrlKey?+new Date:0,(t||s)&&(i=+new Date+1e4),s&&clearTimeout(s),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",e.proxy(function(){this._data.contextmenu.visible&&(!i||+new Date-i>250)&&e.vakata.context.hide(),i=0},this)).on("touchstart.jstree",".jstree-anchor",function(r){r.originalEvent&&r.originalEvent.changedTouches&&r.originalEvent.changedTouches[0]&&(t=r.originalEvent.changedTouches[0].clientX,n=r.originalEvent.changedTouches[0].clientY,s=setTimeout(function(){e(r.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){s&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(Math.abs(t-e.originalEvent.changedTouches[0].clientX)>50||Math.abs(n-e.originalEvent.changedTouches[0].clientY)>50)&&clearTimeout(s)}).on("touchend.vakata.jstree",function(){s&&clearTimeout(s)}),e(d).on("context_hide.vakata.jstree",e.proxy(function(t,n){this._data.contextmenu.visible=!1,e(n.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),r.teardown.call(this)},this.show_contextmenu=function(n,r,i,s){if(n=this.get_node(n),!n||n.id===e.jstree.root)return!1;var o=this.settings.contextmenu,a=this.get_node(n,!0),l=a.children(".jstree-anchor"),c=!1,d=!1;(o.show_at_node||r===t||i===t)&&(c=l.offset(),r=c.left,i=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(n)&&this.activate_node(n,s),d=o.items,e.isFunction(d)&&(d=d.call(this,n,e.proxy(function(e){this._show_contextmenu(n,r,i,e)},this))),e.isPlainObject(d)&&this._show_contextmenu(n,r,i,d)},this._show_contextmenu=function(t,n,r,i){var s=this.get_node(t,!0),o=s.children(".jstree-anchor");e(d).one("context_show.vakata.jstree",e.proxy(function(t,n){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(n.element).addClass(r),o.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(o,{x:n,y:r},i),this.trigger("show_contextmenu",{node:t,x:n,y:r})}},function(e){var t=!1,n={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(d).triggerHandler("context_"+t+".vakata",{reference:n.reference,element:n.element,position:{x:n.position_x,y:n.position_y}})},_execute:function(t){return t=n.items[t],!(!t||t._disabled&&(!e.isFunction(t._disabled)||t._disabled({item:t,reference:n.reference,element:n.element}))||!t.action)&&t.action.call(null,{item:t,reference:n.reference,element:n.element,position:{x:n.position_x,y:n.position_y}})},_parse:function(t,r){if(!t)return!1;r||(n.html="",n.items=[]);var i,s="",o=!1;return r&&(s+="<ul>"),e.each(t,function(t,r){return!r||(n.items.push(r),!o&&r.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),o=!1,s+="<li class='"+(r._class||"")+(r._disabled===!0||e.isFunction(r._disabled)&&r._disabled({item:r,reference:n.reference,element:n.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(n.items.length-1)+"' "+(r.title?"title='"+r.title+"'":"")+">",e.vakata.context.settings.icons&&(s+="<i ",r.icon&&(s+=r.icon.indexOf("/")!==-1||r.icon.indexOf(".")!==-1?" style='background:url(\""+r.icon+"\") center center no-repeat' ":" class='"+r.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(r.label)?r.label({item:t,reference:n.reference,element:n.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"</span>":"")+"</a>",r.submenu&&(i=e.vakata.context._parse(r.submenu,!0),i&&(s+=i)),s+="</li>",void(r.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",o=!0)))}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(s+="</ul>"),r||(n.html=s,e.vakata.context._trigger("parse")),s.length>10&&s},_show_submenu:function(n){if(n=e(n),n.length&&n.children("ul").length){var r=n.children("ul"),i=n.offset().left,s=i+n.outerWidth(),o=n.offset().top,a=r.width(),l=r.height(),c=e(window).width()+e(window).scrollLeft(),d=e(window).height()+e(window).scrollTop();t?n[s-(a+10+n.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):n[s+a>c&&i>c-s?"addClass":"removeClass"]("vakata-context-right"),o+l+10>d&&r.css("bottom","-1px"),n.hasClass("vakata-context-right")?i<a&&r.css("margin-right",i-a):c-s<a&&r.css("margin-left",c-s-a),r.show()}},show:function(r,i,s){var o,a,l,c,d,h,u,f,p=!0;switch(n.element&&n.element.length&&n.element.width(""),p){case!i&&!r:return!1;case!!i&&!!r:n.reference=r,n.position_x=i.x,n.position_y=i.y;break;case!i&&!!r:n.reference=r,o=r.offset(),n.position_x=o.left+r.outerHeight(),n.position_y=o.top;break;case!!i&&!r:n.position_x=i.x,n.position_y=i.y}r&&!s&&e(r).data("vakata_contextmenu")&&(s=e(r).data("vakata_contextmenu")),e.vakata.context._parse(s)&&n.element.html(n.html),n.items.length&&(n.element.appendTo("body"),a=n.element,l=n.position_x,c=n.position_y,d=a.width(),h=a.height(),u=e(window).width()+e(window).scrollLeft(),f=e(window).height()+e(window).scrollTop(),t&&(l-=a.outerWidth()-e(r).outerWidth(),l<e(window).scrollLeft()+20&&(l=e(window).scrollLeft()+20)),l+d+20>u&&(l=u-(d+20)),c+h+20>f&&(c=f-(h+20)),n.element.css({left:l,top:c}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),n.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){n.is_visible&&(n.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),n.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var r=!1;n.element=e("<ul class='vakata-context'></ul>"),n.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(r&&clearTimeout(r),n.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(r=setTimeout(function(){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var r=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:n.is_visible&&(n.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:n.is_visible&&(r=n.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),r.length||(r=n.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),r.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:n.is_visible&&(n.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:n.is_visible&&(r=n.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),r.length||(r=n.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),r.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=n.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.click()}),e(d).on("mousedown.vakata.jstree",function(t){n.is_visible&&!e.contains(n.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata.jstree",function(){n.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&n.element.addClass("vakata-context-rtl").css("direction","rtl"),n.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var f,p;e.jstree.plugins.dnd=function(t,n){this.init=function(e,t){n.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in d.createElement("span")},this.bind=function(){n.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",e.proxy(function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var n=this.get_node(t.target),r=this.is_selected(n)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,i=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(i=e.vakata.html.escape(i)),n&&n.id&&n.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(!0):[n],t))){if(f={jstree:!0,origin:this,obj:this.get_node(n,!0),nodes:r>1?this.get_top_selected():[n.id]},p=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,f,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+i+'<ins class="jstree-copy" style="display:none;">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:p,data:f})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:p,data:f}),!1}).on("drop.jstree",e.proxy(function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:p,data:f}),!1},this))},this.redraw_node=function(e){if(e=n.redraw_node.apply(this,arguments),e&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{var t,r,i=null;for(t=0,r=e.childNodes.length;t<r;t++)if(e.childNodes[t]&&e.childNodes[t].className&&e.childNodes[t].className.indexOf("jstree-anchor")!==-1){i=e.childNodes[t];break}i&&i.setAttribute("draggable",!0)}return e}},e(function(){var n=!1,r=!1,i=!1,s=!1,o=e('<div id="jstree-marker">&#160;</div>').hide();e(d).on("dnd_start.vakata.jstree",function(e,t){n=!1,i=!1,t&&t.data&&t.data.jstree&&o.appendTo("body")}).on("dnd_move.vakata.jstree",function(a,l){if(s&&(l.event&&"dragover"===l.event.type&&l.event.target===i.target||clearTimeout(s)),l&&l.data&&l.data.jstree&&(!l.event.target.id||"jstree-marker"!==l.event.target.id)){i=l.event;var c,d,h,u,f,p,g,_,m,y,v,b,x,k,j,w,C=e.jstree.reference(l.event.target),S=!1,A=!1,T=!1;if(C&&C._data&&C._data.dnd)if(o.attr("class","jstree-"+C.get_theme()+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")),j=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+C.get_theme()+" jstree-"+C.get_theme()+"-"+C.get_theme_variant()+" "+(C.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[j?"show":"hide"](),l.event.target!==C.element[0]&&l.event.target!==C.get_container_ul()[0]||0!==C.get_container_ul().children().length){if(S=C.settings.dnd.large_drop_target?e(l.event.target).closest(".jstree-node").children(".jstree-anchor"):e(l.event.target).closest(".jstree-anchor"),S&&S.length&&S.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(A=S.offset(),T=(l.event.pageY!==t?l.event.pageY:l.event.originalEvent.pageY)-A.top,h=S.outerHeight(),p=T<h/3?["b","i","a"]:T>h-h/3?["a","i","b"]:T>h/2?["i","a","b"]:["i","b","a"],e.each(p,function(t,i){switch(i){case"b":c=A.left-6,d=A.top,u=C.get_parent(S),f=S.parent().index();break;case"i":x=C.settings.dnd.inside_pos,k=C.get_node(S.parent()),c=A.left-2,d=A.top+h/2+1,u=k.id,f="first"===x?0:"last"===x?k.children.length:Math.min(x,k.children.length);break;case"a":c=A.left-6,d=A.top+h,u=C.get_parent(S),f=S.parent().index()+1}for(g=!0,_=0,m=l.data.nodes.length;_<m;_++)if(y=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",v=f,"move_node"===y&&"a"===i&&l.data.origin&&l.data.origin===C&&u===C.get_parent(l.data.nodes[_])&&(b=C.get_node(u),v>e.inArray(l.data.nodes[_],b.children)&&(v-=1)),g=g&&(C&&C.settings&&C.settings.dnd&&C.settings.dnd.check_while_dragging===!1||C.check(y,l.data.origin&&l.data.origin!==C?l.data.origin.get_node(l.data.nodes[_]):l.data.nodes[_],u,v,{dnd:!0,ref:C.get_node(S.parent()),pos:i,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==C,is_foreign:!l.data.origin})),!g){C&&C.last_error&&(r=C.last_error());break}if("i"===i&&S.parent().is(".jstree-closed")&&C.settings.dnd.open_timeout&&(s=setTimeout(function(e,t){return function(){e.open_node(t)}}(C,S),C.settings.dnd.open_timeout)),g)return w=C.get_node(u,!0),w.hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),w.addClass("jstree-dnd-parent")),n={ins:C,par:u,pos:"i"!==i||"last"!==x||0!==f||C.is_loaded(k)?f:"last"},o.css({left:c+"px",top:d+"px"}).show(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=j?"copy":"move"),r={},p=!0,!1}),p===!0))return}else{for(g=!0,_=0,m=l.data.nodes.length;_<m&&(g=g&&C.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==C?l.data.origin.get_node(l.data.nodes[_]):l.data.nodes[_],e.jstree.root,"last",{dnd:!0,ref:C.get_node(e.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==C,is_foreign:!l.data.origin}),g);_++);if(g)return n={ins:C,par:e.jstree.root,pos:"last"},o.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=j?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),n=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect="none"),o.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(o.hide(),n=!1,i=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,a){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),s&&clearTimeout(s),a&&a.data&&a.data.jstree){o.hide().detach();var l,c,d=[];if(n){for(l=0,c=a.data.nodes.length;l<c;l++)d[l]=a.data.origin?a.data.origin.get_node(a.data.nodes[l]):a.data.nodes[l];n.ins[a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey))?"copy_node":"move_node"](d,n.par,n.pos,!1,!1,!1,a.data.origin)}else l=e(a.event.target).closest(".jstree"),l.length&&r&&r.error&&"check"===r.error&&(l=l.jstree(!0),l&&l.settings.core.error.call(this,r));i=!1,n=!1}}).on("keyup.jstree keydown.jstree",function(t,a){a=e.vakata.dnd._get(),a&&a.data&&a.data.jstree&&("keyup"===t.type&&27===t.which?(s&&clearTimeout(s),n=!1,r=!1,i=!1,s=!1,o.hide().detach(),e.vakata.dnd._clean()):(a.helper.find(".jstree-copy").first()[a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),i&&(i.metaKey=t.metaKey,i.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",i))))})}),function(e){e.vakata.html={div:e("<div />"),escape:function(t){return e.vakata.html.div.name(t).html()},strip:function(t){return e.vakata.html.div.empty().append(e.parseHTML(t)).name()}};var n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(n,r,i){i===t&&(i=e.vakata.dnd._get()),i.event=r,e(d).triggerHandler("dnd_"+n+".vakata",i)},_get:function(){return{data:n.data,element:n.element,helper:n.helper}},_clean:function(){n.helper&&n.helper.remove(),n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(d).off("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).off("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop)},_scroll:function(t){if(!n.scroll_e||!n.scroll_l&&!n.scroll_t)return n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),!1;if(!n.scroll_i)return n.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(t===!0)return!1;var r=n.scroll_e.scrollTop(),i=n.scroll_e.scrollLeft();n.scroll_e.scrollTop(r+n.scroll_t*e.vakata.dnd.settings.scroll_speed),n.scroll_e.scrollLeft(i+n.scroll_l*e.vakata.dnd.settings.scroll_speed),r===n.scroll_e.scrollTop()&&i===n.scroll_e.scrollLeft()||e.vakata.dnd._trigger("scroll",n.scroll_e)},start:function(t,r,i){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag&&e.vakata.dnd.stop({});try{t.currentTarget.unselectable="on",t.currentTarget.onselectstart=function(){return!1},t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return n.init_x=t.pageX,n.init_y=t.pageY,n.data=r,n.is_down=!0,n.element=t.currentTarget,n.target=t.target,n.is_touch="touchstart"===t.type,i!==!1&&(n.helper=e("<div id='vakata-dnd'></div>").html(i).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(d).on("mousemove.vakata.jstree touchmove.vakata.jstree",e.vakata.dnd.drag),e(d).on("mouseup.vakata.jstree touchend.vakata.jstree",e.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_down){if(!n.is_drag){if(!(Math.abs(t.pageX-n.init_x)>(n.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(t.pageY-n.init_y)>(n.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;n.helper&&(n.helper.appendTo("body"),n.helper_w=n.helper.outerWidth()),n.is_drag=!0,e(n.target).one("click.vakata",!1),e.vakata.dnd._trigger("start",t)}var r=!1,i=!1,s=!1,o=!1,a=!1,l=!1,c=!1,h=!1,u=!1,f=!1;return n.scroll_t=0,n.scroll_l=0,n.scroll_e=!1,e(e(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var r=e(this),i=r.offset();if(this.scrollHeight>this.offsetHeight&&(i.top+r.height()-t.pageY<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),t.pageY-i.top<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(i.left+r.width()-t.pageX<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),t.pageX-i.left<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1)),n.scroll_t||n.scroll_l)return n.scroll_e=e(this),!1}),n.scroll_e||(r=e(d),i=e(window),s=r.height(),o=i.height(),a=r.width(),l=i.width(),c=r.scrollTop(),h=r.scrollLeft(),s>o&&t.pageY-c<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1),s>o&&o-(t.pageY-c)<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),a>l&&t.pageX-h<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1),a>l&&l-(t.pageX-h)<e.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),(n.scroll_t||n.scroll_l)&&(n.scroll_e=r)),n.scroll_e&&e.vakata.dnd._scroll(!0),n.helper&&(u=parseInt(t.pageY+e.vakata.dnd.settings.helper_top,10),f=parseInt(t.pageX+e.vakata.dnd.settings.helper_left,10),s&&u+25>s&&(u=s-50),a&&f+n.helper_w>a&&(f=a-(n.helper_w+2)),n.helper.css({left:f+"px",top:u+"px"})),e.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=d.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag)t.target!==n.target&&e(n.target).off("click.vakata"),e.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===n.target){var r=setTimeout(function(){e(t.target).click()},100);e(t.target).one("click",function(){r&&clearTimeout(r)})}return e.vakata.dnd._clean(),!1}}}(e),e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,n){this.init=function(e,t){this._data.massload={},n.init.call(this,e,t)},this._load_nodes=function(t,r,i,s){var o,a,l,c=this.settings.massload,d=(JSON.stringify(t),[]),h=this._model.data;if(!i){for(o=0,a=t.length;o<a;o++)h[t[o]]&&(h[t[o]].state.loaded||h[t[o]].state.failed)&&!s||(d.push(t[o]),l=this.get_node(t[o],!0),l&&l.length&&l.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},d.length){if(e.isFunction(c))return c.call(this,d,e.proxy(function(e){var o,a;if(e)for(o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);for(o=0,a=t.length;o<a;o++)l=this.get_node(t[o],!0),l&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);n._load_nodes.call(this,t,r,i,s)},this));if("object"==typeof c&&c&&c.url)return c=e.extend(!0,{},c),e.isFunction(c.url)&&(c.url=c.url.call(this,d)),e.isFunction(c.data)&&(c.data=c.data.call(this,d)),e.ajax(c).done(e.proxy(function(e){var o,a;if(e)for(o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);for(o=0,a=t.length;o<a;o++)l=this.get_node(t[o],!0),l&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);n._load_nodes.call(this,t,r,i,s)},this)).fail(e.proxy(function(){n._load_nodes.call(this,t,r,i,s)},this))}}return n._load_nodes.call(this,t,r,i,s)},this._load_node=function(t,r){var i,s=this._data.massload[t.id],o=null;return s?(o=this["string"==typeof s?"_append_html_data":"_append_json_data"](t,"string"==typeof s?e(e.parseHTML(s)).filter(function(){return 3!==this.nodeType}):s,function(e){r.call(this,e)}),i=this.get_node(t.id,!0),i&&i.length&&i.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],o):n._load_node.call(this,t,r)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(n,r){this.bind=function(){r.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",e.proxy(function(t,n){if(this._data.search.som&&n.res.length){var r,i,s,o,a=this._model.data,l=[];for(r=0,i=n.res.length;r<i;r++)if(a[n.res[r]]&&!a[n.res[r]].state.hidden&&(l.push(n.res[r]),l=l.concat(a[n.res[r]].parents),this._data.search.smc))for(s=0,o=a[n.res[r]].children_d.length;s<o;s++)a[a[n.res[r]].children_d[s]]&&!a[a[n.res[r]].children_d[s]].state.hidden&&l.push(a[n.res[r]].children_d[s]);l=e.vakata.array_remove_item(e.vakata.array_unique(l),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(l,!0),this.redraw(!0)}},this)).on("clear_search.jstree",e.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(n,r,i,s,o,a){if(n===!1||""===e.trim(n.toString()))return this.clear_search();s=this.get_node(s),s=s&&s.id?s.id:null,n=n.toString();var l,c,d=this.settings.search,h=!!d.ajax&&d.ajax,u=this._model.data,f=null,p=[],g=[];if(this._data.search.res.length&&!o&&this.clear_search(),i===t&&(i=d.show_only_matches),a===t&&(a=d.show_only_matches_children),!r&&h!==!1)return e.isFunction(h)?h.call(this,n,e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(n,!0,i,s,o)})},this),s):(h=e.extend({},h),h.data||(h.data={}),h.data.str=n,s&&(h.data.inside=s),e.ajax(h).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.isArray(t)?e.vakata.array_unique(t):[],function(){this.search(n,!0,i,s,o)})},this)));if(o||(this._data.search.str=n,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=i,this._data.search.smc=a),f=new e.vakata.search(n,!0,{caseSensitive:d.case_sensitive,fuzzy:d.fuzzy}),e.each(u[s?s:e.jstree.root].children_d,function(e,t){var r=u[t];r.name&&!r.state.hidden&&(!d.search_leaves_only||r.state.loaded&&0===r.children.length)&&(d.search_callback&&d.search_callback.call(this,n,r)||!d.search_callback&&f.search(r.name).isMatch)&&(p.push(t),g=g.concat(r.parents))}),p.length){for(g=e.vakata.array_unique(g),l=0,c=g.length;l<c;l++)g[l]!==e.jstree.root&&u[g[l]]&&this.open_node(g[l],null,0)===!0&&this._data.search.opn.push(g[l]);o?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(p))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=p),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:n,res:this._data.search.res,show_only_matches:i})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return"0123456789".indexOf(t[0])!==-1?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t){if(t=r.redraw_node.apply(this,arguments),t&&e.inArray(t.id,this._data.search.res)!==-1){var n,i,s=null;for(n=0,i=t.childNodes.length;n<i;n++)if(t.childNodes[n]&&t.childNodes[n].className&&t.childNodes[n].className.indexOf("jstree-anchor")!==-1){s=t.childNodes[n];break}s&&(s.className+=" jstree-search")}return t}},function(e){e.vakata.search=function(t,n,r){r=r||{},r=e.extend({},e.vakata.search.defaults,r),r.fuzzy!==!1&&(r.fuzzy=!0),t=r.caseSensitive?t:t.toLowerCase();var i,s,o,a,l=r.location,c=r.distance,d=r.threshold,h=t.length;return h>32&&(r.fuzzy=!1),r.fuzzy&&(i=1<<h-1,s=function(){var e={},n=0;for(n=0;n<h;n++)e[t.charAt(n)]=0;for(n=0;n<h;n++)e[t.charAt(n)]|=1<<h-n-1;return e}(),o=function(e,t){var n=e/h,r=Math.abs(l-t);return c?n+r/c:r?1:n}),a=function(e){if(e=r.caseSensitive?e:e.toLowerCase(),t===e||e.indexOf(t)!==-1)return{isMatch:!0,score:0};if(!r.fuzzy)return{isMatch:!1,score:1};var n,a,c,u,f,p,g,_,m,y=e.length,v=d,b=e.indexOf(t,l),x=h+y,k=1,j=[];for(b!==-1&&(v=Math.min(o(0,b),v),b=e.lastIndexOf(t,l+h),b!==-1&&(v=Math.min(o(0,b),v))),b=-1,n=0;n<h;n++){for(c=0,u=x;c<u;)o(n,l+u)<=v?c=u:x=u,
u=Math.floor((x-c)/2+c);for(x=u,p=Math.max(1,l-u+1),g=Math.min(l+u,y)+h,_=new Array(g+2),_[g+1]=(1<<n)-1,a=g;a>=p;a--)if(m=s[e.charAt(a-1)],0===n?_[a]=(_[a+1]<<1|1)&m:_[a]=(_[a+1]<<1|1)&m|((f[a+1]|f[a])<<1|1)|f[a+1],_[a]&i&&(k=o(n,a-1),k<=v)){if(v=k,b=a-1,j.push(b),!(b>l))break;p=Math.max(1,2*l-b)}if(o(n+1,l)>v)break;f=_}return{isMatch:b>=0,score:k}},n===!0?{search:a}:a(n)},e.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(e),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,n){this.bind=function(){n.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,n){var r,i;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),n))for(r=0,i=t.children_d.length;r<i;r++)this.sort(t.children_d[r],!1)}};var g=!1;e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,n){this.bind=function(){n.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){g&&clearTimeout(g),g=setTimeout(e.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",e.proxy(function(){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl)&&(t&&t.state&&(t=t.state),t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),!!t&&(this.element.one("set_state.jstree",function(n,r){r.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(e),e.jstree.defaults.types={"default":{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(n,r){this.init=function(n,i){var s,o;if(i&&i.types&&i.types["default"])for(s in i.types)if("default"!==s&&s!==e.jstree.root&&i.types.hasOwnProperty(s))for(o in i.types["default"])i.types["default"].hasOwnProperty(o)&&i.types[s][o]===t&&(i.types[s][o]=i.types["default"][o]);r.init.call(this,n,i),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,n){r.refresh.call(this,t,n),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",e.proxy(function(n,r){var i,s,o,a=this._model.data,l=r.nodes,c=this.settings.types,d="default";for(i=0,s=l.length;i<s;i++){if(d="default",a[l[i]].original&&a[l[i]].original.type&&c[a[l[i]].original.type]&&(d=a[l[i]].original.type),a[l[i]].data&&a[l[i]].data.jstree&&a[l[i]].data.jstree.type&&c[a[l[i]].data.jstree.type]&&(d=a[l[i]].data.jstree.type),a[l[i]].type=d,a[l[i]].icon===!0&&c[d].icon!==t&&(a[l[i]].icon=c[d].icon),c[d].li_attr!==t&&"object"==typeof c[d].li_attr)for(o in c[d].li_attr)if(c[d].li_attr.hasOwnProperty(o)){if("id"===o)continue;a[l[i]].li_attr[o]===t?a[l[i]].li_attr[o]=c[d].li_attr[o]:"class"===o&&(a[l[i]].li_attr["class"]=c[d].li_attr["class"]+" "+a[l[i]].li_attr["class"])}if(c[d].a_attr!==t&&"object"==typeof c[d].a_attr)for(o in c[d].a_attr)if(c[d].a_attr.hasOwnProperty(o)){if("id"===o)continue;a[l[i]].a_attr[o]===t?a[l[i]].a_attr[o]=c[d].a_attr[o]:"href"===o&&"#"===a[l[i]].a_attr[o]?a[l[i]].a_attr.href=c[d].a_attr.href:"class"===o&&(a[l[i]].a_attr["class"]=c[d].a_attr["class"]+" "+a[l[i]].a_attr["class"])}}a[e.jstree.root].type=e.jstree.root},this)),r.bind.call(this)},this.get_json=function(t,n,i){var s,o,a=this._model.data,l=n?e.extend(!0,{},n,{no_id:!1}):{},c=r.get_json.call(this,t,l,i);if(c===!1)return!1;if(e.isArray(c))for(s=0,o=c.length;s<o;s++)c[s].type=c[s].id&&a[c[s].id]&&a[c[s].id].type?a[c[s].id].type:"default",n&&n.no_id&&(delete c[s].id,c[s].li_attr&&c[s].li_attr.id&&delete c[s].li_attr.id,c[s].a_attr&&c[s].a_attr.id&&delete c[s].a_attr.id);else c.type=c.id&&a[c.id]&&a[c.id].type?a[c.id].type:"default",n&&n.no_id&&(c=this._delete_ids(c));return c},this._delete_ids=function(t){if(e.isArray(t)){for(var n=0,r=t.length;n<r;n++)t[n]=this._delete_ids(t[n]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(n,i,s,o,a){if(r.check.call(this,n,i,s,o,a)===!1)return!1;i=i&&i.id?i:this.get_node(i),s=s&&s.id?s:this.get_node(s);var l,c,d,h,u=i&&i.id?a&&a.origin?a.origin:e.jstree.reference(i.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,n){case"create_node":case"move_node":case"copy_node":if("move_node"!==n||e.inArray(i.id,s.children)===-1){if(l=this.get_rules(s),l.max_children!==t&&l.max_children!==-1&&l.max_children===s.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+n,data:JSON.stringify({chk:n,pos:o,obj:!(!i||!i.id)&&i.id,par:!(!s||!s.id)&&s.id})},!1;if(l.valid_children!==t&&l.valid_children!==-1&&e.inArray(i.type||"default",l.valid_children)===-1)return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+n,data:JSON.stringify({chk:n,pos:o,obj:!(!i||!i.id)&&i.id,par:!(!s||!s.id)&&s.id})},!1;if(u&&i.children_d&&i.parents){for(c=0,d=0,h=i.children_d.length;d<h;d++)c=Math.max(c,u[i.children_d[d]].parents.length);c=c-i.parents.length+1}(c<=0||c===t)&&(c=1);do{if(l.max_depth!==t&&l.max_depth!==-1&&l.max_depth<c)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+n,data:JSON.stringify({chk:n,pos:o,obj:!(!i||!i.id)&&i.id,par:!(!s||!s.id)&&s.id})},!1;s=this.get_node(s.parent),l=this.get_rules(s),c++}while(s)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var n=this.get_type(e,!0);return n.max_depth===t&&(n.max_depth=-1),n.max_children===t&&(n.max_children=-1),n.valid_children===t&&(n.valid_children=-1),n},this.get_type=function(t,n){return t=this.get_node(t),!!t&&(n?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(n,r){var i,s,o,a,l,c,d,h,u=this._model.data;if(e.isArray(n)){for(n=n.slice(),s=0,o=n.length;s<o;s++)this.set_type(n[s],r);return!0}if(i=this.settings.types,n=this.get_node(n),!i[r]||!n)return!1;if(d=this.get_node(n,!0),d&&d.length&&(h=d.children(".jstree-anchor")),a=n.type,l=this.get_icon(n),n.type=r,(l===!0||i[a]&&i[a].icon!==t&&l===i[a].icon)&&this.set_icon(n,i[r].icon===t||i[r].icon),i[a].li_attr!==t&&"object"==typeof i[a].li_attr)for(c in i[a].li_attr)if(i[a].li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(u[n.id].li_attr["class"]=(u[n.id].li_attr["class"]||"").replace(i[a].li_attr[c],""),d&&d.removeClass(i[a].li_attr[c])):u[n.id].li_attr[c]===i[a].li_attr[c]&&(u[n.id].li_attr[c]=null,d&&d.removeAttr(c))}if(i[a].a_attr!==t&&"object"==typeof i[a].a_attr)for(c in i[a].a_attr)if(i[a].a_attr.hasOwnProperty(c)){if("id"===c)continue;"class"===c?(u[n.id].a_attr["class"]=(u[n.id].a_attr["class"]||"").replace(i[a].a_attr[c],""),h&&h.removeClass(i[a].a_attr[c])):u[n.id].a_attr[c]===i[a].a_attr[c]&&("href"===c?(u[n.id].a_attr[c]="#",h&&h.attr("href","#")):(delete u[n.id].a_attr[c],h&&h.removeAttr(c)))}if(i[r].li_attr!==t&&"object"==typeof i[r].li_attr)for(c in i[r].li_attr)if(i[r].li_attr.hasOwnProperty(c)){if("id"===c)continue;u[n.id].li_attr[c]===t?(u[n.id].li_attr[c]=i[r].li_attr[c],d&&("class"===c?d.addClass(i[r].li_attr[c]):d.attr(c,i[r].li_attr[c]))):"class"===c&&(u[n.id].li_attr["class"]=i[r].li_attr[c]+" "+u[n.id].li_attr["class"],d&&d.addClass(i[r].li_attr[c]))}if(i[r].a_attr!==t&&"object"==typeof i[r].a_attr)for(c in i[r].a_attr)if(i[r].a_attr.hasOwnProperty(c)){if("id"===c)continue;u[n.id].a_attr[c]===t?(u[n.id].a_attr[c]=i[r].a_attr[c],h&&("class"===c?h.addClass(i[r].a_attr[c]):h.attr(c,i[r].a_attr[c]))):"href"===c&&"#"===u[n.id].a_attr[c]?(u[n.id].a_attr.href=i[r].a_attr.href,h&&h.attr("href",i[r].a_attr.href)):"class"===c&&(u[n.id].a_attr["class"]=i[r].a_attr["class"]+" "+u[n.id].a_attr["class"],h&&h.addClass(i[r].a_attr[c]))}return!0}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(n,r){this.check=function(t,n,i,s,o){if(r.check.call(this,t,n,i,s,o)===!1)return!1;if(n=n&&n.id?n:this.get_node(n),i=i&&i.id?i:this.get_node(i),!i||!i.children)return!0;var a,l,c="rename_node"===t?s:n.name,d=[],h=this.settings.unique.case_sensitive,u=this._model.data;for(a=0,l=i.children.length;a<l;a++)d.push(h?u[i.children[a]].name:u[i.children[a]].name.toLowerCase());switch(h||(c=c.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return a=e.inArray(c,d)===-1||n.name&&n.name[h?"toString":"toLowerCase"]()===c,a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})}),a;case"create_node":return a=e.inArray(c,d)===-1,a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})}),a;case"copy_node":return a=e.inArray(c,d)===-1,a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})}),a;case"move_node":return a=n.parent===i.id&&(!o||!o.is_multi)||e.inArray(c,d)===-1,a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})}),a}return!0},this.create_node=function(n,i,s,o,a){if(!i||i.name===t){if(null===n&&(n=e.jstree.root),n=this.get_node(n),!n)return r.create_node.call(this,n,i,s,o,a);if(s=s===t?"last":s,!s.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(n))return r.create_node.call(this,n,i,s,o,a);i||(i={});var l,c,d,h,u,f=this._model.data,p=this.settings.unique.case_sensitive,g=this.settings.unique.duplicate;for(c=l=this.get_string("New node"),d=[],h=0,u=n.children.length;h<u;h++)d.push(p?f[n.children[h]].name:f[n.children[h]].name.toLowerCase());for(h=1;e.inArray(p?c:c.toLowerCase(),d)!==-1;)c=g.call(this,l,++h).toString();i.name=c}return r.create_node.call(this,n,i,s,o,a)}};var _=d.createElement("DIV");if(_.setAttribute("unselectable","on"),_.setAttribute("role","presentation"),_.className="jstree-wholerow",_.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,n){this.bind=function(){n.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var n,r,i=!1;for(n=0,r=t.selected.length;n<r;n++)i=this.get_node(t.selected[n],!0),i&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){if(this._data.contextmenu){t.preventDefault();var n=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n)}},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var n=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var n=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),n.teardown.call(this)},this.redraw_node=function(t){if(t=n.redraw_node.apply(this,arguments)){var r=_.cloneNode(!0);e.inArray(t.id,this._data.core.selected)!==-1&&(r.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(r.className+=" jstree-wholerow-hovered"),t.insertBefore(r,t.childNodes[0])}return t}},d.registerElement&&Object&&Object.create){var m=Object.create(HTMLElement.prototype);m.createdCallback=function(){var t,n={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(n.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(n[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(n.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(n)};try{d.registerElement("vakata-jstree",{prototype:m})}catch(e){}}}}),function(){}.call(this),function(){}.call(this),function(){jQuery(function(){return $("#search").autocomplete({source:"/search_suggestions"})})}.call(this),function(){}.call(this),function(e){var t,n,r="0.4.2",i="hasOwnProperty",s=/[\.\/]/,o=/\s*,\s*/,a="*",l=function(e,t){return e-t},c={n:{}},d=function(){for(var e=0,t=this.length;e<t;e++)if("undefined"!=typeof this[e])return this[e]},h=function(){for(var e=this.length;--e;)if("undefined"!=typeof this[e])return this[e]},u=function(e,r){e=String(e);var i,s=n,o=Array.prototype.slice.call(arguments,2),a=u.listeners(e),c=0,f=[],p={},g=[],_=t;g.firstDefined=d,g.lastDefined=h,t=e,n=0;for(var m=0,y=a.length;m<y;m++)"zIndex"in a[m]&&(f.push(a[m].zIndex),a[m].zIndex<0&&(p[a[m].zIndex]=a[m]));for(f.sort(l);f[c]<0;)if(i=p[f[c++]],g.push(i.apply(r,o)),n)return n=s,g;for(m=0;m<y;m++)if(i=a[m],"zIndex"in i)if(i.zIndex==f[c]){if(g.push(i.apply(r,o)),n)break;do if(c++,i=p[f[c]],i&&g.push(i.apply(r,o)),n)break;while(i)}else p[i.zIndex]=i;else if(g.push(i.apply(r,o)),n)break;return n=s,t=_,g};u._events=c,u.listeners=function(e){var t,n,r,i,o,l,d,h,u=e.split(s),f=c,p=[f],g=[];for(i=0,o=u.length;i<o;i++){for(h=[],l=0,d=p.length;l<d;l++)for(f=p[l].n,n=[f[u[i]],f[a]],r=2;r--;)t=n[r],t&&(h.push(t),g=g.concat(t.f||[]));p=h}return g},u.on=function(e,t){if(e=String(e),"function"!=typeof t)return function(){};for(var n=e.split(o),r=0,i=n.length;r<i;r++)!function(e){for(var n,r=e.split(s),i=c,o=0,a=r.length;o<a;o++)i=i.n,i=i.hasOwnProperty(r[o])&&i[r[o]]||(i[r[o]]={n:{}});for(i.f=i.f||[],o=0,a=i.f.length;o<a;o++)if(i.f[o]==t){n=!0;break}!n&&i.f.push(t)}(n[r]);return function(e){+e==+e&&(t.zIndex=+e)}},u.f=function(e){var t=[].slice.call(arguments,1);return function(){u.apply(null,[e,null].concat(t).concat([].slice.call(arguments,0)))}},u.stop=function(){n=1},u.nt=function(e){return e?new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)").test(t):t},u.nts=function(){return t.split(s)},u.off=u.unbind=function(e,t){if(!e)return void(u._events=c={n:{}});var n=e.split(o);if(n.length>1)for(var r=0,l=n.length;r<l;r++)u.off(n[r],t);else{n=e.split(s);var d,h,f,r,l,p,g,_=[c];for(r=0,l=n.length;r<l;r++)for(p=0;p<_.length;p+=f.length-2){if(f=[p,1],d=_[p].n,n[r]!=a)d[n[r]]&&f.push(d[n[r]]);else for(h in d)d[i](h)&&f.push(d[h]);_.splice.apply(_,f)}for(r=0,l=_.length;r<l;r++)for(d=_[r];d.n;){if(t){if(d.f){for(p=0,g=d.f.length;p<g;p++)if(d.f[p]==t){d.f.splice(p,1);break}!d.f.length&&delete d.f}for(h in d.n)if(d.n[i](h)&&d.n[h].f){var m=d.n[h].f;for(p=0,g=m.length;p<g;p++)if(m[p]==t){m.splice(p,1);break}!m.length&&delete d.n[h].f}}else{delete d.f;for(h in d.n)d.n[i](h)&&d.n[h].f&&delete d.n[h].f}d=d.n}}},u.once=function(e,t){var n=function(){return u.unbind(e,n),t.apply(this,arguments)};return u.on(e,n)},u.version=r,u.toString=function(){return"You are running Eve "+r},"undefined"!=typeof module&&module.exports?module.exports=u:"function"==typeof define&&define.amd?define("eve",[],function(){return u}):e.eve=u}(this),function(e,t){if("function"==typeof define&&define.amd)define(["eve"],function(n){return t(e,n)});else if("undefined"!=typeof exports){var n=require("eve");module.exports=t(e,n)}else t(e,e.eve)}(window||this,function(e,t){var n=function(t){var n={},r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,16)},i=Array.isArray||function(e){return e instanceof Array||"[object Array]"==Object.prototype.toString.call(e)},s=0,o="M"+(+new Date).toString(36),a=function(){return o+(s++).toString(36)},l=Date.now||function(){return+new Date},c=function(e){var t=this;if(null==e)return t.s;var n=t.s-e;t.b+=t.dur*n,t.B+=t.dur*n,t.s=e},d=function(e){var t=this;return null==e?t.spd:void(t.spd=e)},h=function(e){var t=this;return null==e?t.dur:(t.s=t.s*e/t.dur,void(t.dur=e))},u=function(){var e=this;delete n[e.id],e.update(),t("mina.stop."+e.id,e)},f=function(){var e=this;e.pdif||(delete n[e.id],e.update(),e.pdif=e.get()-e.b)},p=function(){var e=this;e.pdif&&(e.b=e.get()-e.pdif,delete e.pdif,n[e.id]=e)},g=function(){var e,t=this;if(i(t.start)){e=[];for(var n=0,r=t.start.length;n<r;n++)e[n]=+t.start[n]+(t.end[n]-t.start[n])*t.easing(t.s)}else e=+t.start+(t.end-t.start)*t.easing(t.s);t.set(e)},_=function(){var e=0;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i],o=s.get();e++,s.s=(o-s.b)/(s.dur/s.spd),s.s>=1&&(delete n[i],s.s=1,e--,function(e){setTimeout(function(){t("mina.finish."+e.id,e)})}(s)),s.update()}e&&r(_)},m=function(e,t,i,s,o,l,y){var v={id:a(),start:e,end:t,b:i,s:0,dur:s-i,spd:1,get:o,set:l,easing:y||m.linear,status:c,speed:d,duration:h,stop:u,pause:f,resume:p,update:g};n[v.id]=v;var b,x=0;for(b in n)if(n.hasOwnProperty(b)&&(x++,2==x))break;return 1==x&&r(_),v};return m.time=l,m.getById=function(e){return n[e]||null},m.linear=function(e){return e},m.easeout=function(e){return Math.pow(e,1.7)},m.easein=function(e){return Math.pow(e,.48)},m.easeinout=function(e){if(1==e)return 1;if(0==e)return 0;var t=.48-e/1.04,n=Math.sqrt(.1734+t*t),r=n-t,i=Math.pow(Math.abs(r),1/3)*(r<0?-1:1),s=-n-t,o=Math.pow(Math.abs(s),1/3)*(s<0?-1:1),a=i+o+.5;return 3*(1-a)*a*a+a*a*a},m.backin=function(e){if(1==e)return 1;var t=1.70158;return e*e*((t+1)*e-t)},m.backout=function(e){if(0==e)return 0;e-=1;var t=1.70158;return e*e*((t+1)*e+t)+1},m.elastic=function(e){return e==!!e?e:Math.pow(2,-10*e)*Math.sin((e-.075)*(2*Math.PI)/.3)+1},m.bounce=function(e){var t,n=7.5625,r=2.75;return e<1/r?t=n*e*e:e<2/r?(e-=1.5/r,t=n*e*e+.75):e<2.5/r?(e-=2.25/r,t=n*e*e+.9375):(e-=2.625/r,t=n*e*e+.984375),t},e.mina=m,m}("undefined"==typeof t?function(){}:t),r=function(e){function n(e,t){if(e){if(e.nodeType)return k(e);if(i(e,"array")&&n.set)return n.set.apply(n,e);if(e instanceof y)return e;if(null==t)return e=w.doc.querySelector(String(e)),k(e)}return e=null==e?"100%":e,t=null==t?"100%":t,new x(e,t)}function r(e,t){if(t){if("#text"==e&&(e=w.doc.createTextNode(t.text||t["#text"]||"")),"#comment"==e&&(e=w.doc.createComment(t.text||t["#text"]||"")),"string"==typeof e&&(e=r(e)),"string"==typeof t)return 1==e.nodeType?"xlink:"==t.substring(0,6)?e.getAttributeNS(V,t.substring(6)):"xml:"==t.substring(0,4)?e.getAttributeNS(K,t.substring(4)):e.getAttribute(t):"text"==t?e.nodeValue:null;if(1==e.nodeType){for(var n in t)if(t[C](n)){var i=S(t[n]);i?"xlink:"==n.substring(0,6)?e.setAttributeNS(V,n.substring(6),i):"xml:"==n.substring(0,4)?e.setAttributeNS(K,n.substring(4),i):e.setAttribute(n,i):e.removeAttribute(n)}}else"text"in t&&(e.nodeValue=t.text)}else e=w.doc.createElementNS(K,e);return e}function i(e,t){return t=S.prototype.toLowerCase.call(t),"finite"==t?isFinite(e):!("array"!=t||!(e instanceof Array||Array.isArray&&Array.isArray(e)))||("null"==t&&null===e||t==typeof e&&null!==e||"object"==t&&e===Object(e)||q.call(e).slice(8,-1).toLowerCase()==t)}function s(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[C](n)&&(t[n]=s(e[n]));return t}function o(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function a(e,t,n){function r(){var i=Array.prototype.slice.call(arguments,0),s=i.join("\u2400"),a=r.cache=r.cache||{},l=r.count=r.count||[];return a[C](s)?(o(l,s),n?n(a[s]):a[s]):(l.length>=1e3&&delete a[l.shift()],l.push(s),a[s]=e.apply(t,i),n?n(a[s]):a[s])}return r}function l(e,t,n,r,i,s){if(null==i){var o=e-n,a=t-r;return o||a?(180+180*O.atan2(-a,-o)/F+360)%360:0}return l(e,t,i,s)-l(n,r,i,s)}function c(e){return e%360*F/180}function d(e){return 180*e/F%360}function h(e){var t=[];return e=e.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(e,n,r){return r=r.split(/\s*,\s*|\s+/),"rotate"==n&&1==r.length&&r.push(0,0),"scale"==n&&(r.length>2?r=r.slice(0,2):2==r.length&&r.push(0,0),1==r.length&&r.push(r[0],0,0)),"skewX"==n?t.push(["m",1,0,O.tan(c(r[0])),1,0,0]):"skewY"==n?t.push(["m",1,O.tan(c(r[0])),0,1,0,0]):t.push([n.charAt(0)].concat(r)),e}),t}function u(e,t){var r=ee(e),i=new n.Matrix;if(r)for(var s=0,o=r.length;s<o;s++){var a,l,c,d,h,u=r[s],f=u.length,p=S(u[0]).toLowerCase(),g=u[0]!=p,_=g?i.invert():0;"t"==p&&2==f?i.translate(u[1],0):"t"==p&&3==f?g?(a=_.x(0,0),l=_.y(0,0),c=_.x(u[1],u[2]),d=_.y(u[1],u[2]),i.translate(c-a,d-l)):i.translate(u[1],u[2]):"r"==p?2==f?(h=h||t,i.rotate(u[1],h.x+h.width/2,h.y+h.height/2)):4==f&&(g?(c=_.x(u[2],u[3]),d=_.y(u[2],u[3]),i.rotate(u[1],c,d)):i.rotate(u[1],u[2],u[3])):"s"==p?2==f||3==f?(h=h||t,i.scale(u[1],u[f-1],h.x+h.width/2,h.y+h.height/2)):4==f?g?(c=_.x(u[2],u[3]),d=_.y(u[2],u[3]),i.scale(u[1],u[1],c,d)):i.scale(u[1],u[1],u[2],u[3]):5==f&&(g?(c=_.x(u[3],u[4]),d=_.y(u[3],u[4]),i.scale(u[1],u[2],c,d)):i.scale(u[1],u[2],u[3],u[4])):"m"==p&&7==f&&i.add(u[1],u[2],u[3],u[4],u[5],u[6])}return i}function f(e){var t=e.node.ownerSVGElement&&k(e.node.ownerSVGElement)||e.node.parentNode&&k(e.node.parentNode)||n.select("svg")||n(0,0),r=t.select("defs"),i=null!=r&&r.node;return i||(i=b("defs",t.node).node),i}function p(e){return e.node.ownerSVGElement&&k(e.node.ownerSVGElement)||n.select("svg")}function _(e,t,n){function i(e){if(null==e)return L;if(e==+e)return e;r(c,{width:e});try{return c.getBBox().width}catch(e){return 0}}function s(e){if(null==e)return L;if(e==+e)return e;r(c,{height:e});try{return c.getBBox().height}catch(e){return 0}}function o(r,i){null==t?l[r]=i(e.attr(r)||0):r==t&&(l=i(null==n?e.attr(r)||0:n))}var a=p(e).node,l={},c=a.querySelector(".svg---mgr");switch(c||(c=r("rect"),r(c,{x:-9e9,y:-9e9,width:10,height:10,"class":"svg---mgr",fill:"none"}),a.appendChild(c)),e.type){case"rect":o("rx",i),o("ry",s);case"image":o("width",i),o("height",s);case"text":o("x",i),o("y",s);break;case"circle":o("cx",i),o("cy",s),o("r",i);break;case"ellipse":o("cx",i),o("cy",s),o("rx",i),o("ry",s);break;case"line":o("x1",i),o("x2",i),o("y1",s),o("y2",s);break;case"marker":o("refX",i),o("markerWidth",i),o("refY",s),o("markerHeight",s);break;case"radialGradient":o("fx",i),o("fy",s);break;case"tspan":o("dx",i),o("dy",s);break;default:o(t,i)}return a.removeChild(c),l}function m(e){i(e,"array")||(e=Array.prototype.slice.call(arguments,0));for(var t=0,n=0,r=this.node;this[t];)delete this[t++];for(t=0;t<e.length;t++)"set"==e[t].type?e[t].forEach(function(e){r.appendChild(e.node)}):r.appendChild(e[t].node);var s=r.childNodes;for(t=0;t<s.length;t++)this[n++]=k(s[t]);return this}function y(e){if(e.snap in X)return X[e.snap];var t;try{t=e.ownerSVGElement}catch(e){}this.node=e,t&&(this.paper=new x(t)),this.type=e.tagName||e.nodeName;var n=this.id=$(this);if(this.anims={},this._={transform:[]},e.snap=n,X[n]=this,"g"==this.type&&(this.add=m),this.type in{g:1,mask:1,pattern:1,symbol:1})for(var r in x.prototype)x.prototype[C](r)&&(this[r]=x.prototype[r])}function v(e){this.node=e}function b(e,t){var n=r(e);t.appendChild(n);var i=k(n);return i}function x(e,t){var n,i,s,o=x.prototype;if(e&&"svg"==e.tagName){if(e.snap in X)return X[e.snap];var a=e.ownerDocument;n=new y(e),i=e.getElementsByTagName("desc")[0],s=e.getElementsByTagName("defs")[0],i||(i=r("desc"),i.appendChild(a.createTextNode("Created with Snap")),n.node.appendChild(i)),s||(s=r("defs"),n.node.appendChild(s)),n.defs=s;for(var l in o)o[C](l)&&(n[l]=o[l]);n.paper=n.root=n}else n=b("svg",w.doc.body),r(n.node,{height:t,version:1.1,width:e,xmlns:K});return n}function k(e){return e?e instanceof y||e instanceof v?e:e.tagName&&"svg"==e.tagName.toLowerCase()?new x(e):e.tagName&&"object"==e.tagName.toLowerCase()&&"image/svg+xml"==e.type?new x(e.contentDocument.getElementsByTagName("svg")[0]):new y(e):e}function j(e,t){for(var n=0,r=e.length;n<r;n++){var i={type:e[n].type,attr:e[n].attr()},s=e[n].children();t.push(i),s.length&&j(s,i.childNodes=[])}}n.version="0.4.0",n.toString=function(){return"Snap v"+this.version},n._={};var w={win:e.window,doc:e.window.document};n._.glob=w;var C="hasOwnProperty",S=String,A=parseFloat,T=parseInt,O=Math,N=O.max,P=O.min,M=O.abs,F=(O.pow,O.PI),L=(O.round,""),q=Object.prototype.toString,E=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,B=(n._.separator=/[,\s]+/,/[\s]*,[\s]*/),I={hs:1,rg:1},z=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,D=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,R=/(-?\d*\.?\d*(?:e[\-+]?\\d+)?)[\s]*,?[\s]*/gi,H=0,G="S"+(+new Date).toString(36),$=function(e){return(e&&e.type?e.type:L)+G+(H++).toString(36)},V="http://www.w3.org/1999/xlink",K="http://www.w3.org/2000/svg",X={};n.url=function(e){return"url('#"+e+"')"};n._.$=r,n._.id=$,n.format=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r){var i=r;return n.replace(t,function(e,t,n,r,s){t=t||r,i&&(t in i&&(i=i[t]),"function"==typeof i&&s&&(i=i()))}),i=(null==i||i==r?e:i)+""};return function(t,r){return S(t).replace(e,function(e,t){return n(e,t,r)})}}(),n._.clone=s,n._.cacher=a,n.rad=c,n.deg=d,n.sin=function(e){return O.sin(n.rad(e))},n.tan=function(e){return O.tan(n.rad(e))},n.cos=function(e){return O.cos(n.rad(e))},n.asin=function(e){return n.deg(O.asin(e))},n.acos=function(e){return n.deg(O.acos(e))},n.atan=function(e){return n.deg(O.atan(e))},n.atan2=function(e){return n.deg(O.atan2(e))},n.angle=l,n.len=function(e,t,r,i){return Math.sqrt(n.len2(e,t,r,i))},n.len2=function(e,t,n,r){return(e-n)*(e-n)+(t-r)*(t-r)},n.closestPoint=function(e,t,n){function r(e){var r=e.x-t,i=e.y-n;return r*r+i*i}for(var i,s,o,a,l=e.node,c=l.getTotalLength(),d=c/l.pathSegList.numberOfItems*.125,h=1/0,u=0;u<=c;u+=d)(a=r(o=l.getPointAtLength(u)))<h&&(i=o,s=u,h=a);for(d*=.5;d>.5;){var f,p,g,_,m,y;(g=s-d)>=0&&(m=r(f=l.getPointAtLength(g)))<h?(i=f,s=g,h=m):(_=s+d)<=c&&(y=r(p=l.getPointAtLength(_)))<h?(i=p,s=_,h=y):d*=.5}return i={x:i.x,y:i.y,length:s,distance:Math.sqrt(h)}},n.is=i,n.snapTo=function(e,t,n){if(n=i(n,"finite")?n:10,i(e,"array")){for(var r=e.length;r--;)if(M(e[r]-t)<=n)return e[r]}else{e=+e;var s=t%e;if(s<n)return t-s;if(s>e-n)return t-s+e}return t},n.getRGB=a(function(e){if(!e||(e=S(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Q};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none",toString:Q};if(!(I[C](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=U(e)),!e)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Q};var t,r,s,o,a,l,c=e.match(E);return c?(c[2]&&(s=T(c[2].substring(5),16),r=T(c[2].substring(3,5),16),t=T(c[2].substring(1,3),16)),c[3]&&(s=T((a=c[3].charAt(3))+a,16),r=T((a=c[3].charAt(2))+a,16),t=T((a=c[3].charAt(1))+a,16)),c[4]&&(l=c[4].split(B),t=A(l[0]),"%"==l[0].slice(-1)&&(t*=2.55),r=A(l[1]),"%"==l[1].slice(-1)&&(r*=2.55),s=A(l[2]),"%"==l[2].slice(-1)&&(s*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(o=A(l[3])),l[3]&&"%"==l[3].slice(-1)&&(o/=100)),c[5]?(l=c[5].split(B),t=A(l[0]),"%"==l[0].slice(-1)&&(t/=100),r=A(l[1]),"%"==l[1].slice(-1)&&(r/=100),s=A(l[2]),"%"==l[2].slice(-1)&&(s/=100),("deg"==l[0].slice(-3)||"\xb0"==l[0].slice(-1))&&(t/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(o=A(l[3])),l[3]&&"%"==l[3].slice(-1)&&(o/=100),n.hsb2rgb(t,r,s,o)):c[6]?(l=c[6].split(B),t=A(l[0]),"%"==l[0].slice(-1)&&(t/=100),r=A(l[1]),"%"==l[1].slice(-1)&&(r/=100),s=A(l[2]),"%"==l[2].slice(-1)&&(s/=100),("deg"==l[0].slice(-3)||"\xb0"==l[0].slice(-1))&&(t/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(o=A(l[3])),l[3]&&"%"==l[3].slice(-1)&&(o/=100),n.hsl2rgb(t,r,s,o)):(t=P(O.round(t),255),r=P(O.round(r),255),s=P(O.round(s),255),o=P(N(o,0),1),c={r:t,g:r,b:s,toString:Q},c.hex="#"+(16777216|s|r<<8|t<<16).toString(16).slice(1),c.opacity=i(o,"finite")?o:1,c)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Q}},n),n.hsb=a(function(e,t,r){return n.hsb2rgb(e,t,r).hex}),n.hsl=a(function(e,t,r){return n.hsl2rgb(e,t,r).hex}),n.rgb=a(function(e,t,n,r){if(i(r,"finite")){var s=O.round;return"rgba("+[s(e),s(t),s(n),+r.toFixed(2)]+")"}return"#"+(16777216|n|t<<8|e<<16).toString(16).slice(1)});var U=function(e){var t=w.doc.getElementsByTagName("head")[0]||w.doc.getElementsByTagName("svg")[0],n="rgb(255, 0, 0)";return(U=a(function(e){if("red"==e.toLowerCase())return n;t.style.color=n,t.style.color=e;var r=w.doc.defaultView.getComputedStyle(t,L).getPropertyValue("color");return r==n?null:r}))(e)},W=function(){return"hsb("+[this.h,this.s,this.b]+")"},Y=function(){return"hsl("+[this.h,this.s,this.l]+")"},Q=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},J=function(e,t,r){if(null==t&&i(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,t=e.g,e=e.r),null==t&&i(e,string)){var s=n.getRGB(e);e=s.r,t=s.g,r=s.b}return(e>1||t>1||r>1)&&(e/=255,t/=255,r/=255),[e,t,r]},Z=function(e,t,r,s){e=O.round(255*e),t=O.round(255*t),r=O.round(255*r);var o={r:e,g:t,b:r,opacity:i(s,"finite")?s:1,hex:n.rgb(e,t,r),toString:Q};return i(s,"finite")&&(o.opacity=s),o};n.color=function(e){var t;return i(e,"object")&&"h"in e&&"s"in e&&"b"in e?(t=n.hsb2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.opacity=1,e.hex=t.hex):i(e,"object")&&"h"in e&&"s"in e&&"l"in e?(t=n.hsl2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.opacity=1,e.hex=t.hex):(i(e,"string")&&(e=n.getRGB(e)),i(e,"object")&&"r"in e&&"g"in e&&"b"in e&&!("error"in e)?(t=n.rgb2hsl(e),e.h=t.h,e.s=t.s,e.l=t.l,t=n.rgb2hsb(e),e.v=t.b):(e={hex:"none"},e.r=e.g=e.b=e.h=e.s=e.v=e.l=-1,e.error=1)),e.toString=Q,e},n.hsb2rgb=function(e,t,n,r){i(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,t=e.s,r=e.o,e=e.h),e*=360;var s,o,a,l,c;return e=e%360/60,c=n*t,l=c*(1-M(e%2-1)),s=o=a=n-c,e=~~e,s+=[c,l,0,0,l,c][e],o+=[l,c,c,l,0,0][e],a+=[0,0,l,c,c,l][e],Z(s,o,a,r)},n.hsl2rgb=function(e,t,n,r){i(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,t=e.s,e=e.h),(e>1||t>1||n>1)&&(e/=360,t/=100,n/=100),e*=360;var s,o,a,l,c;return e=e%360/60,
c=2*t*(n<.5?n:1-n),l=c*(1-M(e%2-1)),s=o=a=n-c/2,e=~~e,s+=[c,l,0,0,l,c][e],o+=[l,c,c,l,0,0][e],a+=[0,0,l,c,c,l][e],Z(s,o,a,r)},n.rgb2hsb=function(e,t,n){n=J(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o;return s=N(e,t,n),o=s-P(e,t,n),r=0==o?null:s==e?(t-n)/o:s==t?(n-e)/o+2:(e-t)/o+4,r=(r+360)%6*60/360,i=0==o?0:o/s,{h:r,s:i,b:s,toString:W}},n.rgb2hsl=function(e,t,n){n=J(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o,a,l;return o=N(e,t,n),a=P(e,t,n),l=o-a,r=0==l?null:o==e?(t-n)/l:o==t?(n-e)/l+2:(e-t)/l+4,r=(r+360)%6*60/360,s=(o+a)/2,i=0==l?0:s<.5?l/(2*s):l/(2-2*s),{h:r,s:i,l:s,toString:Y}},n.parsePathString=function(e){if(!e)return null;var t=n.path(e);if(t.arr)return n.path.clone(t.arr);var r={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},s=[];return i(e,"array")&&i(e[0],"array")&&(s=n.path.clone(e)),s.length||S(e).replace(z,function(e,t,n){var i=[],o=t.toLowerCase();if(n.replace(R,function(e,t){t&&i.push(+t)}),"m"==o&&i.length>2&&(s.push([t].concat(i.splice(0,2))),o="l",t="m"==t?"l":"L"),"o"==o&&1==i.length&&s.push([t,i[0]]),"r"==o)s.push([t].concat(i));else for(;i.length>=r[o]&&(s.push([t].concat(i.splice(0,r[o]))),r[o]););}),s.toString=n.path.toString,t.arr=n.path.clone(s),s};var ee=n.parseTransformString=function(e){if(!e)return null;var t=[];return i(e,"array")&&i(e[0],"array")&&(t=n.path.clone(e)),t.length||S(e).replace(D,function(e,n,r){var i=[];n.toLowerCase();r.replace(R,function(e,t){t&&i.push(+t)}),t.push([n].concat(i))}),t.toString=n.path.toString,t};n._.svgTransform2string=h,n._.rgTransform=/^[a-z][\s]*-?\.?\d/i,n._.transform2matrix=u,n._unit2px=_;w.doc.contains||w.doc.compareDocumentPosition?function(e,t){var n=9==e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e==r||!(!r||1!=r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t;)if(t=t.parentNode,t==e)return!0;return!1};n._.getSomeDefs=f,n._.getSomeSVG=p,n.select=function(e){return e=S(e).replace(/([^\\]):/g,"$1\\:"),k(w.doc.querySelector(e))},n.selectAll=function(e){for(var t=w.doc.querySelectorAll(e),r=(n.set||Array)(),i=0;i<t.length;i++)r.push(k(t[i]));return r},setInterval(function(){for(var e in X)if(X[C](e)){var t=X[e],n=t.node;("svg"!=t.type&&!n.ownerSVGElement||"svg"==t.type&&(!n.parentNode||"ownerSVGElement"in n.parentNode&&!n.ownerSVGElement))&&delete X[e]}},1e4),y.prototype.attr=function(e,n){var r=this,s=r.node;if(!e){if(1!=s.nodeType)return{text:s.nodeValue};for(var o=s.attributes,a={},l=0,c=o.length;l<c;l++)a[o[l].nodeName]=o[l].nodeValue;return a}if(i(e,"string")){if(!(arguments.length>1))return t("snap.util.getattr."+e,r).firstDefined();var d={};d[e]=n,e=d}for(var h in e)e[C](h)&&t("snap.util.attr."+h,r,e[h]);return r},n.parse=function(e){var t=w.doc.createDocumentFragment(),n=!0,r=w.doc.createElement("div");if(e=S(e),e.match(/^\s*<\s*svg(?:\s|>)/)||(e="<svg>"+e+"</svg>",n=!1),r.innerHTML=e,e=r.getElementsByTagName("svg")[0])if(n)t=e;else for(;e.firstChild;)t.appendChild(e.firstChild);return new v(t)},n.fragment=function(){for(var e=Array.prototype.slice.call(arguments,0),t=w.doc.createDocumentFragment(),r=0,i=e.length;r<i;r++){var s=e[r];s.node&&s.node.nodeType&&t.appendChild(s.node),s.nodeType&&t.appendChild(s),"string"==typeof s&&t.appendChild(n.parse(s).node)}return new v(t)},n._.make=b,n._.wrap=k,x.prototype.el=function(e,t){var n=b(e,this.node);return t&&n.attr(t),n},y.prototype.children=function(){for(var e=[],t=this.node.childNodes,r=0,i=t.length;r<i;r++)e[r]=n(t[r]);return e},y.prototype.toJSON=function(){var e=[];return j([this],e),e[0]},t.on("snap.util.getattr",function(){var e=t.nt();e=e.substring(e.lastIndexOf(".")+1);var n=e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()});return te[C](n)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(n):r(this.node,e)});var te={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};t.on("snap.util.attr",function(e){var n=t.nt(),i={};n=n.substring(n.lastIndexOf(".")+1),i[n]=e;var s=n.replace(/-(\w)/gi,function(e,t){return t.toUpperCase()}),o=n.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()});te[C](o)?this.node.style[s]=null==e?L:e:r(this.node,i)}),function(){}(x.prototype),n.ajax=function(e,n,r,s){var o=new XMLHttpRequest,a=$();if(o){if(i(n,"function"))s=r,r=n,n=null;else if(i(n,"object")){var l=[];for(var c in n)n.hasOwnProperty(c)&&l.push(encodeURIComponent(c)+"="+encodeURIComponent(n[c]));n=l.join("&")}return o.open(n?"POST":"GET",e,!0),n&&(o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded")),r&&(t.once("snap.ajax."+a+".0",r),t.once("snap.ajax."+a+".200",r),t.once("snap.ajax."+a+".304",r)),o.onreadystatechange=function(){4==o.readyState&&t("snap.ajax."+a+"."+o.status,s,o)},4==o.readyState?o:(o.send(n),o)}},n.load=function(e,t,r){n.ajax(e,function(e){var i=n.parse(e.responseText);r?t.call(r,i):t(i)})};var ne=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.body,i=n.documentElement,s=i.clientTop||r.clientTop||0,o=i.clientLeft||r.clientLeft||0,a=t.top+(g.win.pageYOffset||i.scrollTop||r.scrollTop)-s,l=t.left+(g.win.pageXOffset||i.scrollLeft||r.scrollLeft)-o;return{y:a,x:l}};return n.getElementByPoint=function(e,t){var n=this,r=(n.canvas,w.doc.elementFromPoint(e,t));if(w.win.opera&&"svg"==r.tagName){var i=ne(r),s=r.createSVGRect();s.x=e-i.x,s.y=t-i.y,s.width=s.height=1;var o=r.getIntersectionList(s,null);o.length&&(r=o[o.length-1])}return r?k(r):null},n.plugin=function(e){e(n,y,x,w,v)},w.win.Snap=n,n}(e||this);return r.plugin(function(r,i,s,o,a){function l(e,t){if(null==t){var n=!0;if(t="linearGradient"==e.type||"radialGradient"==e.type?e.node.getAttribute("gradientTransform"):"pattern"==e.type?e.node.getAttribute("patternTransform"):e.node.getAttribute("transform"),!t)return new r.Matrix;t=r._.svgTransform2string(t)}else t=r._.rgTransform.test(t)?p(t).replace(/\.{3}|\u2026/g,e._.transform||""):r._.svgTransform2string(t),f(t,"array")&&(t=r.path?r.path.toString.call(t):p(t)),e._.transform=t;var i=r._.transform2matrix(t,e.getBBox(1));return n?i:void(e.matrix=i)}function c(e){function t(e,t){var n=_(e.node,t);n=n&&n.match(s),n=n&&n[2],n&&"#"==n.charAt()&&(n=n.substring(1),n&&(a[n]=(a[n]||[]).concat(function(n){var r={};r[t]=URL(n),_(e.node,r)})))}function n(e){var t=_(e.node,"xlink:href");t&&"#"==t.charAt()&&(t=t.substring(1),t&&(a[t]=(a[t]||[]).concat(function(t){e.attr("xlink:href","#"+t)})))}for(var r,i=e.selectAll("*"),s=/^\s*url\(("|'|)(.*)\1\)\s*$/,o=[],a={},l=0,c=i.length;l<c;l++){r=i[l],t(r,"fill"),t(r,"stroke"),t(r,"filter"),t(r,"mask"),t(r,"clip-path"),n(r);var d=_(r.node,"id");d&&(_(r.node,{id:r.id}),o.push({old:d,id:r.id}))}for(l=0,c=o.length;l<c;l++){var h=a[o[l].old];if(h)for(var u=0,f=h.length;u<f;u++)h[u](o[l].id)}}function d(e,t,n){return function(r){var i=r.slice(e,t);return 1==i.length&&(i=i[0]),n?n(i):i}}function h(e){return function(){var t=e?"<"+this.type:"",n=this.node.attributes,r=this.node.childNodes;if(e)for(var i=0,s=n.length;i<s;i++)t+=" "+n[i].name+'="'+n[i].value.replace(/"/g,'\\"')+'"';if(r.length){for(e&&(t+=">"),i=0,s=r.length;i<s;i++)3==r[i].nodeType?t+=r[i].nodeValue:1==r[i].nodeType&&(t+=b(r[i]).toString());e&&(t+="</"+this.type+">")}else e&&(t+="/>");return t}}var u=i.prototype,f=r.is,p=String,g=r._unit2px,_=r._.$,m=r._.make,y=r._.getSomeDefs,v="hasOwnProperty",b=r._.wrap;u.getBBox=function(e){if(!r.Matrix||!r.path)return this.node.getBBox();var t=this,n=new r.Matrix;if(t.removed)return r._.box();for(;"use"==t.type;)if(e||(n=n.add(t.transform().localMatrix.translate(t.attr("x")||0,t.attr("y")||0))),t.original)t=t.original;else{var i=t.attr("xlink:href");t=t.original=t.node.ownerDocument.getElementById(i.substring(i.indexOf("#")+1))}var s=t._,o=r.path.get[t.type]||r.path.get.deflt;try{return e?(s.bboxwt=o?r.path.getBBox(t.realPath=o(t)):r._.box(t.node.getBBox()),r._.box(s.bboxwt)):(t.realPath=o(t),t.matrix=t.transform().localMatrix,s.bbox=r.path.getBBox(r.path.map(t.realPath,n.add(t.matrix))),r._.box(s.bbox))}catch(e){return r._.box()}};var x=function(){return this.string};u.transform=function(e){var t=this._;if(null==e){for(var n,i=this,s=new r.Matrix(this.node.getCTM()),o=l(this),a=[o],c=new r.Matrix,d=o.toTransformString(),h=p(o)==p(this.matrix)?p(t.transform):d;"svg"!=i.type&&(i=i.parent());)a.push(l(i));for(n=a.length;n--;)c.add(a[n]);return{string:h,globalMatrix:s,totalMatrix:c,localMatrix:o,diffMatrix:s.clone().add(o.invert()),global:s.toTransformString(),total:c.toTransformString(),local:d,toString:x}}return e instanceof r.Matrix?(this.matrix=e,this._.transform=e.toTransformString()):l(this,e),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?_(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?_(this.node,{patternTransform:this.matrix}):_(this.node,{transform:this.matrix})),this},u.parent=function(){return b(this.node.parentNode)},u.append=u.add=function(e){if(e){if("set"==e.type){var t=this;return e.forEach(function(e){t.add(e)}),this}e=b(e),this.node.appendChild(e.node),e.paper=this.paper}return this},u.appendTo=function(e){return e&&(e=b(e),e.append(this)),this},u.prepend=function(e){if(e){if("set"==e.type){var t,n=this;return e.forEach(function(e){t?t.after(e):n.prepend(e),t=e}),this}e=b(e);var r=e.parent();this.node.insertBefore(e.node,this.node.firstChild),this.add&&this.add(),e.paper=this.paper,this.parent()&&this.parent().add(),r&&r.add()}return this},u.prependTo=function(e){return e=b(e),e.prepend(this),this},u.before=function(e){if("set"==e.type){var t=this;return e.forEach(function(e){var n=e.parent();t.node.parentNode.insertBefore(e.node,t.node),n&&n.add()}),this.parent().add(),this}e=b(e);var n=e.parent();return this.node.parentNode.insertBefore(e.node,this.node),this.parent()&&this.parent().add(),n&&n.add(),e.paper=this.paper,this},u.after=function(e){e=b(e);var t=e.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(e.node,this.node.nextSibling):this.node.parentNode.appendChild(e.node),this.parent()&&this.parent().add(),t&&t.add(),e.paper=this.paper,this},u.insertBefore=function(e){e=b(e);var t=this.parent();return e.node.parentNode.insertBefore(this.node,e.node),this.paper=e.paper,t&&t.add(),e.parent()&&e.parent().add(),this},u.insertAfter=function(e){e=b(e);var t=this.parent();return e.node.parentNode.insertBefore(this.node,e.node.nextSibling),this.paper=e.paper,t&&t.add(),e.parent()&&e.parent().add(),this},u.remove=function(){var e=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,e&&e.add(),this},u.select=function(e){return b(this.node.querySelector(e))},u.selectAll=function(e){for(var t=this.node.querySelectorAll(e),n=(r.set||Array)(),i=0;i<t.length;i++)n.push(b(t[i]));return n},u.asPX=function(e,t){return null==t&&(t=this.attr(e)),+g(this,e,t)},u.use=function(){var e,t=this.node.id;return t||(t=this.id,_(this.node,{id:t})),e="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?m(this.type,this.node.parentNode):m("use",this.node.parentNode),_(e.node,{"xlink:href":"#"+t}),e.original=this,e},u.clone=function(){var e=b(this.node.cloneNode(!0));return _(e.node,"id")&&_(e.node,{id:e.id}),c(e),e.insertAfter(this),e},u.toDefs=function(){var e=y(this);return e.appendChild(this.node),this},u.pattern=u.toPattern=function(e,t,n,r){var i=m("pattern",y(this));return null==e&&(e=this.getBBox()),f(e,"object")&&"x"in e&&(t=e.y,n=e.width,r=e.height,e=e.x),_(i.node,{x:e,y:t,width:n,height:r,patternUnits:"userSpaceOnUse",id:i.id,viewBox:[e,t,n,r].join(" ")}),i.node.appendChild(this.node),i},u.marker=function(e,t,n,r,i,s){var o=m("marker",y(this));return null==e&&(e=this.getBBox()),f(e,"object")&&"x"in e&&(t=e.y,n=e.width,r=e.height,i=e.refX||e.cx,s=e.refY||e.cy,e=e.x),_(o.node,{viewBox:[e,t,n,r].join(" "),markerWidth:n,markerHeight:r,orient:"auto",refX:i||0,refY:s||0,id:o.id}),o.node.appendChild(this.node),o};var k=function(e,t,r,i){"function"!=typeof r||r.length||(i=r,r=n.linear),this.attr=e,this.dur=t,r&&(this.easing=r),i&&(this.callback=i)};r._.Animation=k,r.animation=function(e,t,n,r){return new k(e,t,n,r)},u.inAnim=function(){var e=this,t=[];for(var n in e.anims)e.anims[v](n)&&!function(e){t.push({anim:new k(e._attrs,e.dur,e.easing,e._callback),mina:e,curStatus:e.status(),status:function(t){return e.status(t)},stop:function(){e.stop()}})}(e.anims[n]);return t},r.animate=function(e,r,i,s,o,a){"function"!=typeof o||o.length||(a=o,o=n.linear);var l=n.time(),c=n(e,r,l,l+s,n.time,i,o);return a&&t.once("mina.finish."+c.id,a),c},u.stop=function(){for(var e=this.inAnim(),t=0,n=e.length;t<n;t++)e[t].stop();return this},u.animate=function(e,r,i,s){"function"!=typeof i||i.length||(s=i,i=n.linear),e instanceof k&&(s=e.callback,i=e.easing,r=e.dur,e=e.attr);var o,a,l,c,h=[],u=[],g={},_=this;for(var m in e)if(e[v](m)){_.equal?(c=_.equal(m,p(e[m])),o=c.from,a=c.to,l=c.f):(o=+_.attr(m),a=+e[m]);var y=f(o,"array")?o.length:1;g[m]=d(h.length,h.length+y,l),h=h.concat(o),u=u.concat(a)}var b=n.time(),x=n(h,u,b,b+r,n.time,function(e){var t={};for(var n in g)g[v](n)&&(t[n]=g[n](e));_.attr(t)},i);return _.anims[x.id]=x,x._attrs=e,x._callback=s,t("snap.animcreated."+_.id,x),t.once("mina.finish."+x.id,function(){delete _.anims[x.id],s&&s.call(_)}),t.once("mina.stop."+x.id,function(){delete _.anims[x.id]}),_};var j={};u.data=function(e,n){var i=j[this.id]=j[this.id]||{};if(0==arguments.length)return t("snap.data.get."+this.id,this,i,null),i;if(1==arguments.length){if(r.is(e,"object")){for(var s in e)e[v](s)&&this.data(s,e[s]);return this}return t("snap.data.get."+this.id,this,i[e],e),i[e]}return i[e]=n,t("snap.data.set."+this.id,this,n,e),this},u.removeData=function(e){return null==e?j[this.id]={}:j[this.id]&&delete j[this.id][e],this},u.outerSVG=u.toString=h(1),u.innerSVG=h(),u.toDataURL=function(){if(e&&e.btoa){var t=this.getBBox(),n=r.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+t.x.toFixed(3),y:+t.y.toFixed(3),width:+t.width.toFixed(3),height:+t.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(n)))}},a.prototype.select=u.select,a.prototype.selectAll=u.selectAll}),r.plugin(function(e){function t(e,t,r,i,s,o){return null==t&&"[object SVGMatrix]"==n.call(e)?(this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.e=e.e,void(this.f=e.f)):void(null!=e?(this.a=+e,this.b=+t,this.c=+r,this.d=+i,this.e=+s,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var n=Object.prototype.toString,r=String,i=Math,s="";!function(n){function o(e){return e[0]*e[0]+e[1]*e[1]}function a(e){var t=i.sqrt(o(e));e[0]&&(e[0]/=t),e[1]&&(e[1]/=t)}n.add=function(e,n,r,i,s,o){var a,l,c,d,h=[[],[],[]],u=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],f=[[e,r,s],[n,i,o],[0,0,1]];for(e&&e instanceof t&&(f=[[e.a,e.c,e.e],[e.b,e.d,e.f],[0,0,1]]),a=0;a<3;a++)for(l=0;l<3;l++){for(d=0,c=0;c<3;c++)d+=u[a][c]*f[c][l];h[a][l]=d}return this.a=h[0][0],this.b=h[1][0],this.c=h[0][1],this.d=h[1][1],this.e=h[0][2],this.f=h[1][2],this},n.invert=function(){var e=this,n=e.a*e.d-e.b*e.c;return new t(e.d/n,-e.b/n,-e.c/n,e.a/n,(e.c*e.f-e.d*e.e)/n,(e.b*e.e-e.a*e.f)/n)},n.clone=function(){return new t(this.a,this.b,this.c,this.d,this.e,this.f)},n.translate=function(e,t){return this.add(1,0,0,1,e,t)},n.scale=function(e,t,n,r){return null==t&&(t=e),(n||r)&&this.add(1,0,0,1,n,r),this.add(e,0,0,t,0,0),(n||r)&&this.add(1,0,0,1,-n,-r),this},n.rotate=function(t,n,r){t=e.rad(t),n=n||0,r=r||0;var s=+i.cos(t).toFixed(9),o=+i.sin(t).toFixed(9);return this.add(s,o,-o,s,n,r),this.add(1,0,0,1,-n,-r)},n.x=function(e,t){return e*this.a+t*this.c+this.e},n.y=function(e,t){return e*this.b+t*this.d+this.f},n.get=function(e){return+this[r.fromCharCode(97+e)].toFixed(4)},n.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},n.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},n.determinant=function(){return this.a*this.d-this.b*this.c},n.split=function(){var t={};t.dx=this.e,t.dy=this.f;var n=[[this.a,this.c],[this.b,this.d]];t.scalex=i.sqrt(o(n[0])),a(n[0]),t.shear=n[0][0]*n[1][0]+n[0][1]*n[1][1],n[1]=[n[1][0]-n[0][0]*t.shear,n[1][1]-n[0][1]*t.shear],t.scaley=i.sqrt(o(n[1])),a(n[1]),t.shear/=t.scaley,this.determinant()<0&&(t.scalex=-t.scalex);var r=-n[0][1],s=n[1][1];return s<0?(t.rotate=e.deg(i.acos(s)),r<0&&(t.rotate=360-t.rotate)):t.rotate=e.deg(i.asin(r)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},n.toTransformString=function(e){var t=e||this.split();return+t.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[+t.dx.toFixed(4),+t.dy.toFixed(4)]:s)+(1!=t.scalex||1!=t.scaley?"s"+[t.scalex,t.scaley,0,0]:s)+(t.rotate?"r"+[+t.rotate.toFixed(4),0,0]:s))}}(t.prototype),e.Matrix=t,e.matrix=function(e,n,r,i,s,o){return new t(e,n,r,i,s,o)}}),r.plugin(function(e,n,r,i,s){function o(r){return function(i){if(t.stop(),i instanceof s&&1==i.node.childNodes.length&&("radialGradient"==i.node.firstChild.tagName||"linearGradient"==i.node.firstChild.tagName||"pattern"==i.node.firstChild.tagName)&&(i=i.node.firstChild,f(this).appendChild(i),i=h(i)),i instanceof n)if("radialGradient"==i.type||"linearGradient"==i.type||"pattern"==i.type){i.node.id||g(i.node,{id:i.id});var o=_(i.node.id)}else o=i.attr(r);else if(o=e.color(i),o.error){var a=e(f(this).ownerSVGElement).gradient(i);a?(a.node.id||g(a.node,{id:a.id}),o=_(a.node.id)):o=i}else o=m(o);var l={};l[r]=o,g(this.node,l),this.node.style[r]=v}}function a(e){t.stop(),e==+e&&(e+="px"),this.node.style.fontSize=e}function l(e){for(var t=[],n=e.childNodes,r=0,i=n.length;r<i;r++){var s=n[r];3==s.nodeType&&t.push(s.nodeValue),"tspan"==s.tagName&&(1==s.childNodes.length&&3==s.firstChild.nodeType?t.push(s.firstChild.nodeValue):t.push(l(s)))}return t}function c(){return t.stop(),this.node.style.fontSize}var d=e._.make,h=e._.wrap,u=e.is,f=e._.getSomeDefs,p=/^url\(#?([^)]+)\)$/,g=e._.$,_=e.url,m=String,y=e._.separator,v="";t.on("snap.util.attr.mask",function(e){if(e instanceof n||e instanceof s){if(t.stop(),e instanceof s&&1==e.node.childNodes.length&&(e=e.node.firstChild,f(this).appendChild(e),e=h(e)),"mask"==e.type)var r=e;else r=d("mask",f(this)),r.node.appendChild(e.node);!r.node.id&&g(r.node,{id:r.id}),g(this.node,{mask:_(r.id)})}}),function(e){t.on("snap.util.attr.clip",e),t.on("snap.util.attr.clip-path",e),t.on("snap.util.attr.clipPath",e)}(function(e){if(e instanceof n||e instanceof s){if(t.stop(),"clipPath"==e.type)var r=e;else r=d("clipPath",f(this)),r.node.appendChild(e.node),!r.node.id&&g(r.node,{id:r.id});g(this.node,{"clip-path":_(r.node.id||r.id)})}}),t.on("snap.util.attr.fill",o("fill")),t.on("snap.util.attr.stroke",o("stroke"));var b=/^([lr])(?:\(([^)]*)\))?(.*)$/i;t.on("snap.util.grad.parse",function(e){e=m(e);var t=e.match(b);if(!t)return null;var n=t[1],r=t[2],i=t[3];return r=r.split(/\s*,\s*/).map(function(e){return+e==e?+e:e}),1==r.length&&0==r[0]&&(r=[]),i=i.split("-"),i=i.map(function(e){e=e.split(":");var t={color:e[0]};return e[1]&&(t.offset=parseFloat(e[1])),t}),{type:n,params:r,stops:i}}),t.on("snap.util.attr.d",function(n){t.stop(),u(n,"array")&&u(n[0],"array")&&(n=e.path.toString.call(n)),n=m(n),n.match(/[ruo]/i)&&(n=e.path.toAbsolute(n)),g(this.node,{d:n})})(-1),t.on("snap.util.attr.#text",function(e){t.stop(),e=m(e);for(var n=i.doc.createTextNode(e);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(n)})(-1),t.on("snap.util.attr.path",function(e){t.stop(),this.attr({d:e})})(-1),t.on("snap.util.attr.class",function(e){t.stop(),this.node.className.baseVal=e})(-1),t.on("snap.util.attr.viewBox",function(e){var n;n=u(e,"object")&&"x"in e?[e.x,e.y,e.width,e.height].join(" "):u(e,"array")?e.join(" "):e,g(this.node,{viewBox:n}),t.stop()})(-1),t.on("snap.util.attr.transform",function(e){this.transform(e),t.stop()})(-1),t.on("snap.util.attr.r",function(e){"rect"==this.type&&(t.stop(),g(this.node,{rx:e,ry:e}))})(-1),t.on("snap.util.attr.textpath",function(e){if(t.stop(),"text"==this.type){var r,i,s;if(!e&&this.textPath){for(i=this.textPath;i.node.firstChild;)this.node.appendChild(i.node.firstChild);return i.remove(),void delete this.textPath}if(u(e,"string")){var o=f(this),a=h(o.parentNode).path(e);o.appendChild(a.node),r=a.id,a.attr({id:r})}else e=h(e),e instanceof n&&(r=e.attr("id"),r||(r=e.id,e.attr({id:r})));if(r)if(i=this.textPath,s=this.node,i)i.attr({"xlink:href":"#"+r});else{for(i=g("textPath",{"xlink:href":"#"+r});s.firstChild;)i.appendChild(s.firstChild);s.appendChild(i),this.textPath=h(i)}}})(-1),t.on("snap.util.attr.text",function(e){if("text"==this.type){for(var n=this.node,r=function(e){var t=g("tspan");if(u(e,"array"))for(var n=0;n<e.length;n++)t.appendChild(r(e[n]));else t.appendChild(i.doc.createTextNode(e));return t.normalize&&t.normalize(),t};n.firstChild;)n.removeChild(n.firstChild);for(var s=r(e);s.firstChild;)n.appendChild(s.firstChild)}t.stop()})(-1),t.on("snap.util.attr.fontSize",a)(-1),t.on("snap.util.attr.font-size",a)(-1),t.on("snap.util.getattr.transform",function(){return t.stop(),this.transform()})(-1),t.on("snap.util.getattr.textpath",function(){return t.stop(),this.textPath})(-1),function(){function n(n){return function(){t.stop();var r=i.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+n);return"none"==r?r:e(i.doc.getElementById(r.match(p)[1]))}}function r(e){return function(n){t.stop();var r="marker"+e.charAt(0).toUpperCase()+e.substring(1);if(""==n||!n)return void(this.node.style[r]="none");if("marker"==n.type){var i=n.node.id;return i||g(n.node,{id:n.id}),void(this.node.style[r]=_(i))}}}t.on("snap.util.getattr.marker-end",n("end"))(-1),t.on("snap.util.getattr.markerEnd",n("end"))(-1),t.on("snap.util.getattr.marker-start",n("start"))(-1),t.on("snap.util.getattr.markerStart",n("start"))(-1),t.on("snap.util.getattr.marker-mid",n("mid"))(-1),t.on("snap.util.getattr.markerMid",n("mid"))(-1),t.on("snap.util.attr.marker-end",r("end"))(-1),t.on("snap.util.attr.markerEnd",r("end"))(-1),t.on("snap.util.attr.marker-start",r("start"))(-1),t.on("snap.util.attr.markerStart",r("start"))(-1),t.on("snap.util.attr.marker-mid",r("mid"))(-1),t.on("snap.util.attr.markerMid",r("mid"))(-1)}(),t.on("snap.util.getattr.r",function(){if("rect"==this.type&&g(this.node,"rx")==g(this.node,"ry"))return t.stop(),g(this.node,"rx")})(-1),t.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){t.stop();var e=l(this.node);return 1==e.length?e[0]:e}})(-1),t.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),t.on("snap.util.getattr.viewBox",function(){t.stop();var n=g(this.node,"viewBox");return n?(n=n.split(y),e._.box(+n[0],+n[1],+n[2],+n[3])):void 0})(-1),t.on("snap.util.getattr.points",function(){var e=g(this.node,"points");return t.stop(),e?e.split(y):void 0})(-1),t.on("snap.util.getattr.path",function(){var e=g(this.node,"d");return t.stop(),e})(-1),t.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),t.on("snap.util.getattr.fontSize",c)(-1),t.on("snap.util.getattr.font-size",c)(-1)}),r.plugin(function(e,t){var n=/\S+/g,r=String,i=t.prototype;i.addClass=function(e){var t,i,s,o,a=r(e||"").match(n)||[],l=this.node,c=l.className.baseVal,d=c.match(n)||[];if(a.length){for(t=0;s=a[t++];)i=d.indexOf(s),~i||d.push(s);o=d.join(" "),c!=o&&(l.className.baseVal=o)}return this},i.removeClass=function(e){var t,i,s,o,a=r(e||"").match(n)||[],l=this.node,c=l.className.baseVal,d=c.match(n)||[];if(d.length){for(t=0;s=a[t++];)i=d.indexOf(s),~i&&d.splice(i,1);o=d.join(" "),c!=o&&(l.className.baseVal=o)}return this},i.hasClass=function(e){var t=this.node,r=t.className.baseVal,i=r.match(n)||[];return!!~i.indexOf(e)},i.toggleClass=function(e,t){if(null!=t)return t?this.addClass(e):this.removeClass(e);var r,i,s,o,a=(e||"").match(n)||[],l=this.node,c=l.className.baseVal,d=c.match(n)||[];for(r=0;s=a[r++];)i=d.indexOf(s),~i?d.splice(i,1):d.push(s);return o=d.join(" "),c!=o&&(l.className.baseVal=o),this}}),r.plugin(function(){function e(e){return e}function n(e){return function(t){return+t.toFixed(3)+e}}var r={"+":function(e,t){return e+t},"-":function(e,t){return e-t},"/":function(e,t){return e/t},"*":function(e,t){return e*t}},i=String,s=/[a-z]+$/i,o=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;t.on("snap.util.attr",function(e){var n=i(e).match(o);if(n){var a=t.nt(),l=a.substring(a.lastIndexOf(".")+1),c=this.attr(l),d={};t.stop();var h=n[3]||"",u=c.match(s),f=r[n[1]];if(u&&u==h?e=f(parseFloat(c),+n[2]):(c=this.asPX(l),e=f(this.asPX(l),this.asPX(l,n[2]+h))),isNaN(c)||isNaN(e))return;d[l]=e,this.attr(d)}})(-10),t.on("snap.util.equal",function(a,l){var c=i(this.attr(a)||""),d=i(l).match(o);if(d){t.stop();var h=d[3]||"",u=c.match(s),f=r[d[1]];return u&&u==h?{from:parseFloat(c),to:f(parseFloat(c),+d[2]),f:n(u)}:(c=this.asPX(a),{from:c,to:f(c,this.asPX(a,d[2]+h)),f:e})}})(-10)}),r.plugin(function(n,r,i,s){var o=i.prototype,a=n.is;o.rect=function(e,t,n,r,i,s){var o;return null==s&&(s=i),a(e,"object")&&"[object Object]"==e?o=e:null!=e&&(o={x:e,y:t,width:n,height:r},null!=i&&(o.rx=i,o.ry=s)),this.el("rect",o)},o.circle=function(e,t,n){var r;return a(e,"object")&&"[object Object]"==e?r=e:null!=e&&(r={cx:e,cy:t,r:n}),this.el("circle",r)};var l=function(){function e(){this.parentNode.removeChild(this)}return function(t,n){var r=s.doc.createElement("img"),i=s.doc.body;r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){n.call(r),r.onload=r.onerror=null,i.removeChild(r)},r.onerror=e,i.appendChild(r),r.src=t}}();o.image=function(e,t,r,i,s){var o=this.el("image");if(a(e,"object")&&"src"in e)o.attr(e);else if(null!=e){var c={"xlink:href":e,preserveAspectRatio:"none"};null!=t&&null!=r&&(c.x=t,c.y=r),null!=i&&null!=s?(c.width=i,c.height=s):l(e,function(){n._.$(o.node,{width:this.offsetWidth,height:this.offsetHeight})}),n._.$(o.node,c)}return o},o.ellipse=function(e,t,n,r){var i;return a(e,"object")&&"[object Object]"==e?i=e:null!=e&&(i={cx:e,cy:t,rx:n,ry:r}),this.el("ellipse",i)},o.path=function(e){var t;return a(e,"object")&&!a(e,"array")?t=e:e&&(t={d:e}),this.el("path",t)},o.group=o.g=function(e){var t=this.el("g");return 1==arguments.length&&e&&!e.type?t.attr(e):arguments.length&&t.add(Array.prototype.slice.call(arguments,0)),t},o.svg=function(e,t,n,r,i,s,o,l){var c={};return a(e,"object")&&null==t?c=e:(null!=e&&(c.x=e),null!=t&&(c.y=t),null!=n&&(c.width=n),null!=r&&(c.height=r),null!=i&&null!=s&&null!=o&&null!=l&&(c.viewBox=[i,s,o,l])),this.el("svg",c)},o.mask=function(e){var t=this.el("mask");return 1==arguments.length&&e&&!e.type?t.attr(e):arguments.length&&t.add(Array.prototype.slice.call(arguments,0)),t},o.ptrn=function(e,t,n,r,i,s,o,l){if(a(e,"object"))var c=e;else c={patternUnits:"userSpaceOnUse"},e&&(c.x=e),t&&(c.y=t),null!=n&&(c.width=n),null!=r&&(c.height=r),null!=i&&null!=s&&null!=o&&null!=l?c.viewBox=[i,s,o,l]:c.viewBox=[e||0,t||0,n||0,r||0];return this.el("pattern",c)},o.use=function(e){return null!=e?(e instanceof r&&(e.attr("id")||e.attr({id:n._.id(e)}),e=e.attr("id")),"#"==String(e).charAt()&&(e=e.substring(1)),this.el("use",{"xlink:href":"#"+e})):r.prototype.use.call(this)},o.symbol=function(e,t,n,r){var i={};return null!=e&&null!=t&&null!=n&&null!=r&&(i.viewBox=[e,t,n,r]),this.el("symbol",i)},o.text=function(e,t,n){var r={};return a(e,"object")?r=e:null!=e&&(r={x:e,y:t,text:n||""}),this.el("text",r)},o.line=function(e,t,n,r){var i={};return a(e,"object")?i=e:null!=e&&(i={x1:e,x2:n,y1:t,y2:r}),this.el("line",i)},o.polyline=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};return a(e,"object")&&!a(e,"array")?t=e:null!=e&&(t={points:e}),this.el("polyline",t)},o.polygon=function(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments,0));var t={};return a(e,"object")&&!a(e,"array")?t=e:null!=e&&(t={points:e}),this.el("polygon",t)},function(){function r(){return this.selectAll("stop")}function i(e,t){var r=d("stop"),i={offset:+t+"%"};return e=n.color(e),i["stop-color"]=e.hex,e.opacity<1&&(i["stop-opacity"]=e.opacity),d(r,i),this.node.appendChild(r),this}function s(){if("linearGradient"==this.type){var e=d(this.node,"x1")||0,t=d(this.node,"x2")||1,r=d(this.node,"y1")||0,i=d(this.node,"y2")||0;return n._.box(e,r,math.abs(t-e),math.abs(i-r))}var s=this.node.cx||.5,o=this.node.cy||.5,a=this.node.r||0;return n._.box(s-a,o-a,2*a,2*a)}function a(e,n){function r(e,t){for(var n=(t-h)/(e-u),r=u;r<e;r++)o[r].offset=+(+h+n*(r-u)).toFixed(2);u=e,h=t}var i,s=t("snap.util.grad.parse",null,n).firstDefined();if(!s)return null;s.params.unshift(e),i="l"==s.type.toLowerCase()?l.apply(0,s.params):c.apply(0,s.params),s.type!=s.type.toLowerCase()&&d(i.node,{gradientUnits:"userSpaceOnUse"});var o=s.stops,a=o.length,h=0,u=0;a--;for(var f=0;f<a;f++)"offset"in o[f]&&r(f,o[f].offset);for(o[a].offset=o[a].offset||100,r(a,o[a].offset),f=0;f<=a;f++){var p=o[f];i.addStop(p.color,p.offset)}return i}function l(e,t,o,a,l){var c=n._.make("linearGradient",e);return c.stops=r,c.addStop=i,c.getBBox=s,null!=t&&d(c.node,{x1:t,y1:o,x2:a,y2:l}),c}function c(e,t,o,a,l,c){var h=n._.make("radialGradient",e);return h.stops=r,h.addStop=i,h.getBBox=s,null!=t&&d(h.node,{cx:t,cy:o,r:a}),null!=l&&null!=c&&d(h.node,{fx:l,fy:c}),h}var d=n._.$;o.gradient=function(e){return a(this.defs,e)},o.gradientLinear=function(e,t,n,r){return l(this.defs,e,t,n,r)},o.gradientRadial=function(e,t,n,r,i){return c(this.defs,e,t,n,r,i)},o.toString=function(){var e,t=this.node.ownerDocument,r=t.createDocumentFragment(),i=t.createElement("div"),s=this.node.cloneNode(!0);return r.appendChild(i),i.appendChild(s),n._.$(s,{xmlns:"http://www.w3.org/2000/svg"}),e=i.innerHTML,r.removeChild(r.firstChild),e},o.toDataURL=function(){if(e&&e.btoa)return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this)))},o.clear=function(){for(var e,t=this.node.firstChild;t;)e=t.nextSibling,"defs"!=t.tagName?t.parentNode.removeChild(t):o.clear.call({node:t}),t=e}}()}),r.plugin(function(e,t){function n(e){var t=n.ps=n.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[E](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]}function r(e,t,n,r){return null==e&&(e=t=n=r=0),null==t&&(t=e.y,n=e.width,r=e.height,e=e.x),{x:e,y:t,width:n,w:n,height:r,h:r,x2:e+n,y2:t+r,cx:e+n/2,cy:t+r/2,r1:z.min(n,r)/2,r2:z.max(n,r)/2,r0:z.sqrt(n*n+r*r)/2,path:k(e,t,n,r),vb:[e,t,n,r].join(" ")}}function i(){return this.join(",").replace(B,"$1")}function s(e){var t=q(e);return t.toString=i,t}function o(e,t,n,r,i,s,o,a,c){return null==c?f(e,t,n,r,i,s,o,a):l(e,t,n,r,i,s,o,a,p(e,t,n,r,i,s,o,a,c))}function a(n,r){function i(e){return+(+e).toFixed(3)}return e._.cacher(function(e,s,a){e instanceof t&&(e=e.attr("d")),e=N(e);for(var c,d,h,u,f,p="",g={},_=0,m=0,y=e.length;m<y;m++){if(h=e[m],"M"==h[0])c=+h[1],d=+h[2];else{if(u=o(c,d,h[1],h[2],h[3],h[4],h[5],h[6]),_+u>s){if(r&&!g.start){if(f=o(c,d,h[1],h[2],h[3],h[4],h[5],h[6],s-_),p+=["C"+i(f.start.x),i(f.start.y),i(f.m.x),i(f.m.y),i(f.x),i(f.y)],a)return p;g.start=p,p=["M"+i(f.x),i(f.y)+"C"+i(f.n.x),i(f.n.y),i(f.end.x),i(f.end.y),i(h[5]),i(h[6])].join(),_+=u,c=+h[5],d=+h[6];continue}if(!n&&!r)return f=o(c,d,h[1],h[2],h[3],h[4],h[5],h[6],s-_)}_+=u,c=+h[5],d=+h[6]}p+=h.shift()+h}return g.end=p,f=n?_:r?g:l(c,d,h[0],h[1],h[2],h[3],h[4],h[5],1);
},null,e._.clone)}function l(e,t,n,r,i,s,o,a,l){var c=1-l,d=G(c,3),h=G(c,2),u=l*l,f=u*l,p=d*e+3*h*l*n+3*c*l*l*i+f*o,g=d*t+3*h*l*r+3*c*l*l*s+f*a,_=e+2*l*(n-e)+u*(i-2*n+e),m=t+2*l*(r-t)+u*(s-2*r+t),y=n+2*l*(i-n)+u*(o-2*i+n),v=r+2*l*(s-r)+u*(a-2*s+r),b=c*e+l*n,x=c*t+l*r,k=c*i+l*o,j=c*s+l*a,w=90-180*z.atan2(_-y,m-v)/D;return{x:p,y:g,m:{x:_,y:m},n:{x:y,y:v},start:{x:b,y:x},end:{x:k,y:j},alpha:w}}function c(t,n,i,s,o,a,l,c){e.is(t,"array")||(t=[t,n,i,s,o,a,l,c]);var d=O.apply(null,t);return r(d.min.x,d.min.y,d.max.x-d.min.x,d.max.y-d.min.y)}function d(e,t,n){return t>=e.x&&t<=e.x+e.width&&n>=e.y&&n<=e.y+e.height}function h(e,t){return e=r(e),t=r(t),d(t,e.x,e.y)||d(t,e.x2,e.y)||d(t,e.x,e.y2)||d(t,e.x2,e.y2)||d(e,t.x,t.y)||d(e,t.x2,t.y)||d(e,t.x,t.y2)||d(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)}function u(e,t,n,r,i){var s=-3*t+9*n-9*r+3*i,o=e*s+6*t-12*n+6*r;return e*o-3*t+3*n}function f(e,t,n,r,i,s,o,a,l){null==l&&(l=1),l=l>1?1:l<0?0:l;for(var c=l/2,d=12,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],f=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,g=0;g<d;g++){var _=c*h[g]+c,m=u(_,e,n,i,o),y=u(_,t,r,s,a),v=m*m+y*y;p+=f[g]*z.sqrt(v)}return c*p}function p(e,t,n,r,i,s,o,a,l){if(!(l<0||f(e,t,n,r,i,s,o,a)<l)){var c,d=1,h=d/2,u=d-h,p=.01;for(c=f(e,t,n,r,i,s,o,a,u);$(c-l)>p;)h/=2,u+=(c<l?1:-1)*h,c=f(e,t,n,r,i,s,o,a,u);return u}}function g(e,t,n,r,i,s,o,a){if(!(H(e,n)<R(i,o)||R(e,n)>H(i,o)||H(t,r)<R(s,a)||R(t,r)>H(s,a))){var l=(e*r-t*n)*(i-o)-(e-n)*(i*a-s*o),c=(e*r-t*n)*(s-a)-(t-r)*(i*a-s*o),d=(e-n)*(s-a)-(t-r)*(i-o);if(d){var h=l/d,u=c/d,f=+h.toFixed(2),p=+u.toFixed(2);if(!(f<+R(e,n).toFixed(2)||f>+H(e,n).toFixed(2)||f<+R(i,o).toFixed(2)||f>+H(i,o).toFixed(2)||p<+R(t,r).toFixed(2)||p>+H(t,r).toFixed(2)||p<+R(s,a).toFixed(2)||p>+H(s,a).toFixed(2)))return{x:h,y:u}}}}function _(e,t,n){var r=c(e),i=c(t);if(!h(r,i))return n?0:[];for(var s=f.apply(0,e),o=f.apply(0,t),a=~~(s/8),d=~~(o/8),u=[],p=[],_={},m=n?0:[],y=0;y<a+1;y++){var v=l.apply(0,e.concat(y/a));u.push({x:v.x,y:v.y,t:y/a})}for(y=0;y<d+1;y++)v=l.apply(0,t.concat(y/d)),p.push({x:v.x,y:v.y,t:y/d});for(y=0;y<a;y++)for(var b=0;b<d;b++){var x=u[y],k=u[y+1],j=p[b],w=p[b+1],C=$(k.x-x.x)<.001?"y":"x",S=$(w.x-j.x)<.001?"y":"x",A=g(x.x,x.y,k.x,k.y,j.x,j.y,w.x,w.y);if(A){if(_[A.x.toFixed(4)]==A.y.toFixed(4))continue;_[A.x.toFixed(4)]=A.y.toFixed(4);var T=x.t+$((A[C]-x[C])/(k[C]-x[C]))*(k.t-x.t),O=j.t+$((A[S]-j[S])/(w[S]-j[S]))*(w.t-j.t);T>=0&&T<=1&&O>=0&&O<=1&&(n?m++:m.push({x:A.x,y:A.y,t1:T,t2:O}))}}return m}function m(e,t){return v(e,t)}function y(e,t){return v(e,t,1)}function v(e,t,n){e=N(e),t=N(t);for(var r,i,s,o,a,l,c,d,h,u,f=n?0:[],p=0,g=e.length;p<g;p++){var m=e[p];if("M"==m[0])r=a=m[1],i=l=m[2];else{"C"==m[0]?(h=[r,i].concat(m.slice(1)),r=h[6],i=h[7]):(h=[r,i,r,i,a,l,a,l],r=a,i=l);for(var y=0,v=t.length;y<v;y++){var b=t[y];if("M"==b[0])s=c=b[1],o=d=b[2];else{"C"==b[0]?(u=[s,o].concat(b.slice(1)),s=u[6],o=u[7]):(u=[s,o,s,o,c,d,c,d],s=c,o=d);var x=_(h,u,n);if(n)f+=x;else{for(var k=0,j=x.length;k<j;k++)x[k].segment1=p,x[k].segment2=y,x[k].bez1=h,x[k].bez2=u;f=f.concat(x)}}}}}return f}function b(e,t,n){var r=x(e);return d(r,t,n)&&v(e,[["M",t,n],["H",r.x2+10]],1)%2==1}function x(e){var t=n(e);if(t.bbox)return q(t.bbox);if(!e)return r();e=N(e);for(var i,s=0,o=0,a=[],l=[],c=0,d=e.length;c<d;c++)if(i=e[c],"M"==i[0])s=i[1],o=i[2],a.push(s),l.push(o);else{var h=O(s,o,i[1],i[2],i[3],i[4],i[5],i[6]);a=a.concat(h.min.x,h.max.x),l=l.concat(h.min.y,h.max.y),s=i[5],o=i[6]}var u=R.apply(0,a),f=R.apply(0,l),p=H.apply(0,a),g=H.apply(0,l),_=r(u,f,p-u,g-f);return t.bbox=q(_),_}function k(e,t,n,r,s){if(s)return[["M",+e+ +s,t],["l",n-2*s,0],["a",s,s,0,0,1,s,s],["l",0,r-2*s],["a",s,s,0,0,1,-s,s],["l",2*s-n,0],["a",s,s,0,0,1,-s,-s],["l",0,2*s-r],["a",s,s,0,0,1,s,-s],["z"]];var o=[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]];return o.toString=i,o}function j(e,t,n,r,s){if(null==s&&null==r&&(r=n),e=+e,t=+t,n=+n,r=+r,null!=s)var o=Math.PI/180,a=e+n*Math.cos(-r*o),l=e+n*Math.cos(-s*o),c=t+n*Math.sin(-r*o),d=t+n*Math.sin(-s*o),h=[["M",a,c],["A",n,n,0,+(s-r>180),0,l,d]];else h=[["M",e,t],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]];return h.toString=i,h}function w(t){var r=n(t),o=String.prototype.toLowerCase;if(r.rel)return s(r.rel);e.is(t,"array")&&e.is(t&&t[0],"array")||(t=e.parsePathString(t));var a=[],l=0,c=0,d=0,h=0,u=0;"M"==t[0][0]&&(l=t[0][1],c=t[0][2],d=l,h=c,u++,a.push(["M",l,c]));for(var f=u,p=t.length;f<p;f++){var g=a[f]=[],_=t[f];if(_[0]!=o.call(_[0]))switch(g[0]=o.call(_[0]),g[0]){case"a":g[1]=_[1],g[2]=_[2],g[3]=_[3],g[4]=_[4],g[5]=_[5],g[6]=+(_[6]-l).toFixed(3),g[7]=+(_[7]-c).toFixed(3);break;case"v":g[1]=+(_[1]-c).toFixed(3);break;case"m":d=_[1],h=_[2];default:for(var m=1,y=_.length;m<y;m++)g[m]=+(_[m]-(m%2?l:c)).toFixed(3)}else{g=a[f]=[],"m"==_[0]&&(d=_[1]+l,h=_[2]+c);for(var v=0,b=_.length;v<b;v++)a[f][v]=_[v]}var x=a[f].length;switch(a[f][0]){case"z":l=d,c=h;break;case"h":l+=+a[f][x-1];break;case"v":c+=+a[f][x-1];break;default:l+=+a[f][x-2],c+=+a[f][x-1]}}return a.toString=i,r.rel=s(a),a}function C(t){var r=n(t);if(r.abs)return s(r.abs);if(L(t,"array")&&L(t&&t[0],"array")||(t=e.parsePathString(t)),!t||!t.length)return[["M",0,0]];var o,a=[],l=0,c=0,d=0,h=0,u=0;"M"==t[0][0]&&(l=+t[0][1],c=+t[0][2],d=l,h=c,u++,a[0]=["M",l,c]);for(var f,p,g=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),_=u,m=t.length;_<m;_++){if(a.push(f=[]),p=t[_],o=p[0],o!=o.toUpperCase())switch(f[0]=o.toUpperCase(),f[0]){case"A":f[1]=p[1],f[2]=p[2],f[3]=p[3],f[4]=p[4],f[5]=p[5],f[6]=+p[6]+l,f[7]=+p[7]+c;break;case"V":f[1]=+p[1]+c;break;case"H":f[1]=+p[1]+l;break;case"R":for(var y=[l,c].concat(p.slice(1)),v=2,b=y.length;v<b;v++)y[v]=+y[v]+l,y[++v]=+y[v]+c;a.pop(),a=a.concat(M(y,g));break;case"O":a.pop(),y=j(l,c,p[1],p[2]),y.push(y[0]),a=a.concat(y);break;case"U":a.pop(),a=a.concat(j(l,c,p[1],p[2],p[3])),f=["U"].concat(a[a.length-1].slice(-2));break;case"M":d=+p[1]+l,h=+p[2]+c;default:for(v=1,b=p.length;v<b;v++)f[v]=+p[v]+(v%2?l:c)}else if("R"==o)y=[l,c].concat(p.slice(1)),a.pop(),a=a.concat(M(y,g)),f=["R"].concat(p.slice(-2));else if("O"==o)a.pop(),y=j(l,c,p[1],p[2]),y.push(y[0]),a=a.concat(y);else if("U"==o)a.pop(),a=a.concat(j(l,c,p[1],p[2],p[3])),f=["U"].concat(a[a.length-1].slice(-2));else for(var x=0,k=p.length;x<k;x++)f[x]=p[x];if(o=o.toUpperCase(),"O"!=o)switch(f[0]){case"Z":l=+d,c=+h;break;case"H":l=f[1];break;case"V":c=f[1];break;case"M":d=f[f.length-2],h=f[f.length-1];default:l=f[f.length-2],c=f[f.length-1]}}return a.toString=i,r.abs=s(a),a}function S(e,t,n,r){return[e,t,n,r,n,r]}function A(e,t,n,r,i,s){var o=1/3,a=2/3;return[o*e+a*n,o*t+a*r,o*i+a*n,o*s+a*r,i,s]}function T(t,n,r,i,s,o,a,l,c,d){var h,u=120*D/180,f=D/180*(+s||0),p=[],g=e._.cacher(function(e,t,n){var r=e*z.cos(n)-t*z.sin(n),i=e*z.sin(n)+t*z.cos(n);return{x:r,y:i}});if(d)w=d[0],C=d[1],k=d[2],j=d[3];else{h=g(t,n,-f),t=h.x,n=h.y,h=g(l,c,-f),l=h.x,c=h.y;var _=(z.cos(D/180*s),z.sin(D/180*s),(t-l)/2),m=(n-c)/2,y=_*_/(r*r)+m*m/(i*i);y>1&&(y=z.sqrt(y),r=y*r,i=y*i);var v=r*r,b=i*i,x=(o==a?-1:1)*z.sqrt($((v*b-v*m*m-b*_*_)/(v*m*m+b*_*_))),k=x*r*m/i+(t+l)/2,j=x*-i*_/r+(n+c)/2,w=z.asin(((n-j)/i).toFixed(9)),C=z.asin(((c-j)/i).toFixed(9));w=t<k?D-w:w,C=l<k?D-C:C,w<0&&(w=2*D+w),C<0&&(C=2*D+C),a&&w>C&&(w-=2*D),!a&&C>w&&(C-=2*D)}var S=C-w;if($(S)>u){var A=C,O=l,N=c;C=w+u*(a&&C>w?1:-1),l=k+r*z.cos(C),c=j+i*z.sin(C),p=T(l,c,r,i,s,0,a,O,N,[C,A,k,j])}S=C-w;var P=z.cos(w),M=z.sin(w),F=z.cos(C),L=z.sin(C),q=z.tan(S/4),E=4/3*r*q,B=4/3*i*q,I=[t,n],R=[t+E*M,n-B*P],H=[l+E*L,c-B*F],G=[l,c];if(R[0]=2*I[0]-R[0],R[1]=2*I[1]-R[1],d)return[R,H,G].concat(p);p=[R,H,G].concat(p).join().split(",");for(var V=[],K=0,X=p.length;K<X;K++)V[K]=K%2?g(p[K-1],p[K],f).y:g(p[K],p[K+1],f).x;return V}function O(e,t,n,r,i,s,o,a){for(var l,c,d,h,u,f,p,g,_=[],m=[[],[]],y=0;y<2;++y)if(0==y?(c=6*e-12*n+6*i,l=-3*e+9*n-9*i+3*o,d=3*n-3*e):(c=6*t-12*r+6*s,l=-3*t+9*r-9*s+3*a,d=3*r-3*t),$(l)<1e-12){if($(c)<1e-12)continue;h=-d/c,0<h&&h<1&&_.push(h)}else p=c*c-4*d*l,g=z.sqrt(p),p<0||(u=(-c+g)/(2*l),0<u&&u<1&&_.push(u),f=(-c-g)/(2*l),0<f&&f<1&&_.push(f));for(var v,b=_.length,x=b;b--;)h=_[b],v=1-h,m[0][b]=v*v*v*e+3*v*v*h*n+3*v*h*h*i+h*h*h*o,m[1][b]=v*v*v*t+3*v*v*h*r+3*v*h*h*s+h*h*h*a;return m[0][x]=e,m[1][x]=t,m[0][x+1]=o,m[1][x+1]=a,m[0].length=m[1].length=x+2,{min:{x:R.apply(0,m[0]),y:R.apply(0,m[1])},max:{x:H.apply(0,m[0]),y:H.apply(0,m[1])}}}function N(e,t){var r=!t&&n(e);if(!t&&r.curve)return s(r.curve);for(var i=C(e),o=t&&C(t),a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c=(function(e,t,n){var r,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(T.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*t.x-t.bx,i=2*t.y-t.by):(r=t.x,i=t.y),e=["C",r,i].concat(e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(A(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(A(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(S(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(S(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(S(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(S(t.x,t.y,t.X,t.Y))}return e}),d=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)u[t]="A",o&&(f[t]="A"),e.splice(t++,0,["C"].concat(n.splice(0,6)));e.splice(t,1),m=H(i.length,o&&o.length||0)}},h=function(e,t,n,r,s){e&&t&&"M"==e[s][0]&&"M"!=t[s][0]&&(t.splice(s,0,["M",r.x,r.y]),n.bx=0,n.by=0,n.x=e[s][1],n.y=e[s][2],m=H(i.length,o&&o.length||0))},u=[],f=[],p="",g="",_=0,m=H(i.length,o&&o.length||0);_<m;_++){i[_]&&(p=i[_][0]),"C"!=p&&(u[_]=p,_&&(g=u[_-1])),i[_]=c(i[_],a,g),"A"!=u[_]&&"C"==p&&(u[_]="C"),d(i,_),o&&(o[_]&&(p=o[_][0]),"C"!=p&&(f[_]=p,_&&(g=f[_-1])),o[_]=c(o[_],l,g),"A"!=f[_]&&"C"==p&&(f[_]="C"),d(o,_)),h(i,o,a,l,_),h(o,i,l,a,_);var y=i[_],v=o&&o[_],b=y.length,x=o&&v.length;a.x=y[b-2],a.y=y[b-1],a.bx=I(y[b-4])||a.x,a.by=I(y[b-3])||a.y,l.bx=o&&(I(v[x-4])||l.x),l.by=o&&(I(v[x-3])||l.y),l.x=o&&v[x-2],l.y=o&&v[x-1]}return o||(r.curve=s(i)),o?[i,o]:i}function P(e,t){if(!t)return e;var n,r,i,s,o,a,l;for(e=N(e),i=0,o=e.length;i<o;i++)for(l=e[i],s=1,a=l.length;s<a;s+=2)n=t.x(l[s],l[s+1]),r=t.y(l[s],l[s+1]),l[s]=n,l[s+1]=r;return e}function M(e,t){for(var n=[],r=0,i=e.length;i-2*!t>r;r+=2){var s=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];t?r?i-4==r?s[3]={x:+e[0],y:+e[1]}:i-2==r&&(s[2]={x:+e[0],y:+e[1]},s[3]={x:+e[2],y:+e[3]}):s[0]={x:+e[i-2],y:+e[i-1]}:i-4==r?s[3]=s[2]:r||(s[0]={x:+e[r],y:+e[r+1]}),n.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return n}var F=t.prototype,L=e.is,q=e._.clone,E="hasOwnProperty",B=/,?([a-z]),?/gi,I=parseFloat,z=Math,D=z.PI,R=z.min,H=z.max,G=z.pow,$=z.abs,V=a(1),K=a(),X=a(0,1),U=e._unit2px,W={path:function(e){return e.attr("path")},circle:function(e){var t=U(e);return j(t.cx,t.cy,t.r)},ellipse:function(e){var t=U(e);return j(t.cx||0,t.cy||0,t.rx,t.ry)},rect:function(e){var t=U(e);return k(t.x||0,t.y||0,t.width,t.height,t.rx,t.ry)},image:function(e){var t=U(e);return k(t.x||0,t.y||0,t.width,t.height)},line:function(e){return"M"+[e.attr("x1")||0,e.attr("y1")||0,e.attr("x2"),e.attr("y2")]},polyline:function(e){return"M"+e.attr("points")},polygon:function(e){return"M"+e.attr("points")+"z"},deflt:function(e){var t=e.node.getBBox();return k(t.x,t.y,t.width,t.height)}};e.path=n,e.path.getTotalLength=V,e.path.getPointAtLength=K,e.path.getSubpath=function(e,t,n){if(this.getTotalLength(e)-n<1e-6)return X(e,t).end;var r=X(e,n,1);return t?X(r,t).end:r},F.getTotalLength=function(){if(this.node.getTotalLength)return this.node.getTotalLength()},F.getPointAtLength=function(e){return K(this.attr("d"),e)},F.getSubpath=function(t,n){return e.path.getSubpath(this.attr("d"),t,n)},e._.box=r,e.path.findDotsAtSegment=l,e.path.bezierBBox=c,e.path.isPointInsideBBox=d,e.closest=function(t,n,i,s){for(var o=100,a=r(t-o/2,n-o/2,o,o),l=[],c=i[0].hasOwnProperty("x")?function(e){return{x:i[e].x,y:i[e].y}}:function(e){return{x:i[e],y:s[e]}},h=0;o<=1e6&&!h;){for(var u=0,f=i.length;u<f;u++){var p=c(u);if(d(a,p.x,p.y)){h++,l.push(p);break}}h||(o*=2,a=r(t-o/2,n-o/2,o,o))}if(1e6!=o){var g,_=1/0;for(u=0,f=l.length;u<f;u++){var m=e.len(t,n,l[u].x,l[u].y);_>m&&(_=m,l[u].len=m,g=l[u])}return g}},e.path.isBBoxIntersect=h,e.path.intersection=m,e.path.intersectionNumber=y,e.path.isPointInside=b,e.path.getBBox=x,e.path.get=W,e.path.toRelative=w,e.path.toAbsolute=C,e.path.toCubic=N,e.path.map=P,e.path.toString=i,e.path.clone=s}),r.plugin(function(e){var r=Math.max,i=Math.min,s=function(e){if(this.items=[],this.bindings={},this.length=0,this.type="set",e)for(var t=0,n=e.length;t<n;t++)e[t]&&(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},o=s.prototype;o.push=function(){for(var e,t,n=0,r=arguments.length;n<r;n++)e=arguments[n],e&&(t=this.items.length,this[t]=this.items[t]=e,this.length++);return this},o.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},o.forEach=function(e,t){for(var n=0,r=this.items.length;n<r;n++)if(e.call(t,this.items[n],n)===!1)return this;return this},o.animate=function(r,i,s,o){"function"!=typeof s||s.length||(o=s,s=n.linear),r instanceof e._.Animation&&(o=r.callback,s=r.easing,i=s.dur,r=r.attr);var a=arguments;if(e.is(r,"array")&&e.is(a[a.length-1],"array"))var l=!0;var c,d=function(){c?this.b=c:c=this.b},h=0,u=this,f=o&&function(){++h==u.length&&o.call(this)};return this.forEach(function(e,n){t.once("snap.animcreated."+e.id,d),l?a[n]&&e.animate.apply(e,a[n]):e.animate(r,i,s,f)})},o.remove=function(){for(;this.length;)this.pop().remove();return this},o.bind=function(e,t,n){var r={};if("function"==typeof t)this.bindings[e]=t;else{var i=n||e;this.bindings[e]=function(e){r[i]=e,t.attr(r)}}return this},o.attr=function(e){var t={};for(var n in e)this.bindings[n]?this.bindings[n](e[n]):t[n]=e[n];for(var r=0,i=this.items.length;r<i;r++)this.items[r].attr(t);return this},o.clear=function(){for(;this.length;)this.pop()},o.splice=function(e,t){e=e<0?r(this.length+e,0):e,t=r(0,i(this.length-e,t));var n,o=[],a=[],l=[];for(n=2;n<arguments.length;n++)l.push(arguments[n]);for(n=0;n<t;n++)a.push(this[e+n]);for(;n<this.length-e;n++)o.push(this[e+n]);var c=l.length;for(n=0;n<c+o.length;n++)this.items[e+n]=this[e+n]=n<c?l[n]:o[n-c];for(n=this.items.length=this.length-=t-c;this[n];)delete this[n++];return new s(a)},o.exclude=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]==e)return this.splice(t,1),!0;return!1},o.insertAfter=function(e){for(var t=this.items.length;t--;)this.items[t].insertAfter(e);return this},o.getBBox=function(){for(var e=[],t=[],n=[],s=[],o=this.items.length;o--;)if(!this.items[o].removed){var a=this.items[o].getBBox();e.push(a.x),t.push(a.y),n.push(a.x+a.width),s.push(a.y+a.height)}return e=i.apply(0,e),t=i.apply(0,t),n=r.apply(0,n),s=r.apply(0,s),{x:e,y:t,x2:n,y2:s,width:n-e,height:s-t,cx:e+(n-e)/2,cy:t+(s-t)/2}},o.clone=function(e){e=new s;for(var t=0,n=this.items.length;t<n;t++)e.push(this.items[t].clone());return e},o.toString=function(){return"Snap\u2018s set"},o.type="set",e.Set=s,e.set=function(){var e=new s;return arguments.length&&e.push.apply(e,Array.prototype.slice.call(arguments,0)),e}}),r.plugin(function(e,n){function r(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return 4==e.length?[t,0,e[2],e[3]]:[t,0];case"s":return 5==e.length?[t,1,1,e[3],e[4]]:3==e.length?[t,1,1]:[t,1]}}function i(t,n,i){n=g(n).replace(/\.{3}|\u2026/g,t),t=e.parseTransformString(t)||[],n=e.parseTransformString(n)||[];for(var s,o,a,l,h=Math.max(t.length,n.length),u=[],f=[],p=0;p<h;p++){if(a=t[p]||r(n[p]),l=n[p]||r(a),a[0]!=l[0]||"r"==a[0].toLowerCase()&&(a[2]!=l[2]||a[3]!=l[3])||"s"==a[0].toLowerCase()&&(a[3]!=l[3]||a[4]!=l[4])){t=e._.transform2matrix(t,i()),n=e._.transform2matrix(n,i()),u=[["m",t.a,t.b,t.c,t.d,t.e,t.f]],f=[["m",n.a,n.b,n.c,n.d,n.e,n.f]];break}for(u[p]=[],f[p]=[],s=0,o=Math.max(a.length,l.length);s<o;s++)s in a&&(u[p][s]=a[s]),s in l&&(f[p][s]=l[s])}return{from:d(u),to:d(f),f:c(u)}}function s(e){return e}function o(e){return function(t){return+t.toFixed(3)+e}}function a(e){return e.join(" ")}function l(t){return e.rgb(t[0],t[1],t[2])}function c(e){var t,n,r,i,s,o,a=0,l=[];for(t=0,n=e.length;t<n;t++){for(s="[",o=['"'+e[t][0]+'"'],r=1,i=e[t].length;r<i;r++)o[r]="val["+a++ +"]";s+=o+"]",l[t]=s}return Function("val","return Snap.path.toString.call(["+l+"])")}function d(e){for(var t=[],n=0,r=e.length;n<r;n++)for(var i=1,s=e[n].length;i<s;i++)t.push(e[n][i]);return t}function h(e){return isFinite(parseFloat(e))}function u(t,n){return!(!e.is(t,"array")||!e.is(n,"array"))&&t.toString()==n.toString()}var f={},p=/[a-z]+$/i,g=String;f.stroke=f.fill="colour",n.prototype.equal=function(e,n){return t("snap.util.equal",this,e,n).firstDefined()},t.on("snap.util.equal",function(t,n){var r,_,m=g(this.attr(t)||""),y=this;if(h(m)&&h(n))return{from:parseFloat(m),to:parseFloat(n),f:s};if("colour"==f[t])return r=e.color(m),_=e.color(n),{from:[r.r,r.g,r.b,r.opacity],to:[_.r,_.g,_.b,_.opacity],f:l};if("viewBox"==t)return r=this.attr(t).vb.split(" ").map(Number),_=n.split(" ").map(Number),{from:r,to:_,f:a};if("transform"==t||"gradientTransform"==t||"patternTransform"==t)return n instanceof e.Matrix&&(n=n.toTransformString()),e._.rgTransform.test(n)||(n=e._.svgTransform2string(n)),i(m,n,function(){return y.getBBox(1)});if("d"==t||"path"==t)return r=e.path.toCubic(m,n),{from:d(r[0]),to:d(r[1]),f:c(r[0])};if("points"==t)return r=g(m).split(e._.separator),_=g(n).split(e._.separator),{from:r,to:_,f:function(e){return e}};var v=m.match(p),b=g(n).match(p);return v&&u(v,b)?{from:parseFloat(m),to:parseFloat(n),f:o(v)}:{from:this.asPX(t),to:this.asPX(t,n),f:s}})}),r.plugin(function(e,n,r,i){for(var s=n.prototype,o="hasOwnProperty",a=("createTouch"in i.doc),l=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],c={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},d=(function(e,t){var n="y"==e?"scrollTop":"scrollLeft",r=t&&t.node?t.node.ownerDocument:i.doc;return r[n in r.documentElement?"documentElement":"body"][n]}),h=function(){return this.originalEvent.preventDefault()},u=function(){return this.originalEvent.stopPropagation()},f=function(e,t,n,r){var i=a&&c[t]?c[t]:t,s=function(i){var s=d("y",r),l=d("x",r);if(a&&c[o](t))for(var f=0,p=i.targetTouches&&i.targetTouches.length;f<p;f++)if(i.targetTouches[f].target==e||e.contains(i.targetTouches[f].target)){var g=i;i=i.targetTouches[f],i.originalEvent=g,i.preventDefault=h,i.stopPropagation=u;break}var _=i.clientX+l,m=i.clientY+s;return n.call(r,i,_,m)};return t!==i&&e.addEventListener(t,s,!1),e.addEventListener(i,s,!1),function(){return t!==i&&e.removeEventListener(t,s,!1),e.removeEventListener(i,s,!1),!0}},p=[],g=function(e){for(var n,r=e.clientX,i=e.clientY,s=d("y"),o=d("x"),l=p.length;l--;){if(n=p[l],a){for(var c,h=e.touches&&e.touches.length;h--;)if(c=e.touches[h],c.identifier==n.el._drag.id||n.el.node.contains(c.target)){r=c.clientX,i=c.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var u=n.el.node;u.nextSibling,u.parentNode,u.style.display;r+=o,i+=s,t("snap.drag.move."+n.el.id,n.move_scope||n.el,r-n.el._drag.x,i-n.el._drag.y,r,i,e)}},_=function(n){e.unmousemove(g).unmouseup(_);for(var r,i=p.length;i--;)r=p[i],r.el._drag={},t("snap.drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,n),t.off("snap.drag.*."+r.el.id);p=[]},m=l.length;m--;)!function(t){e[t]=s[t]=function(n,r){if(e.is(n,"function"))this.events=this.events||[],this.events.push({name:t,f:n,unbind:f(this.node||document,t,n,r||this)});else for(var i=0,s=this.events.length;i<s;i++)if(this.events[i].name==t)try{this.events[i].f.call(this)}catch(e){}return this},e["un"+t]=s["un"+t]=function(e){for(var n=this.events||[],r=n.length;r--;)if(n[r].name==t&&(n[r].f==e||!e))return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}}(l[m]);s.hover=function(e,t,n,r){return this.mouseover(e,n).mouseout(t,r||n)},s.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var y=[];s.drag=function(n,r,i,s,o,a){function l(l,c,h){(l.originalEvent||l).preventDefault(),d._drag.x=c,d._drag.y=h,d._drag.id=l.identifier,!p.length&&e.mousemove(g).mouseup(_),p.push({el:d,move_scope:s,start_scope:o,end_scope:a}),r&&t.on("snap.drag.start."+d.id,r),n&&t.on("snap.drag.move."+d.id,n),i&&t.on("snap.drag.end."+d.id,i),t("snap.drag.start."+d.id,o||s||d,c,h,l)}function c(e,n,r){t("snap.draginit."+d.id,d,e,n,r)}var d=this;if(!arguments.length){var h;return d.drag(function(e,t){this.attr({transform:h+(h?"T":"t")+[e,t]})},function(){h=this.transform().local})}return t.on("snap.draginit."+d.id,l),d._drag={},y.push({el:d,start:l,init:c}),d.mousedown(c),d},s.undrag=function(){for(var n=y.length;n--;)y[n].el==this&&(this.unmousedown(y[n].init),y.splice(n,1),t.unbind("snap.drag.*."+this.id),t.unbind("snap.draginit."+this.id));return!y.length&&e.unmousemove(g).unmouseup(_),this}}),r.plugin(function(e,n,r){var i=(n.prototype,r.prototype),s=/^\s*url\((.+)\)/,o=String,a=e._.$;e.filter={},i.filter=function(t){var r=this;"svg"!=r.type&&(r=r.paper);var i=e.parse(o(t)),s=e._.id(),l=(r.node.offsetWidth,r.node.offsetHeight,a("filter"));return a(l,{id:s,filterUnits:"userSpaceOnUse"}),l.appendChild(i.node),r.defs.appendChild(l),new n(l)},t.on("snap.util.getattr.filter",function(){t.stop();var n=a(this.node,"filter");if(n){var r=o(n).match(s);return r&&e.select(r[1])}}),t.on("snap.util.attr.filter",function(r){if(r instanceof n&&"filter"==r.type){t.stop();var i=r.node.id;i||(a(r.node,{id:r.id}),i=r.id),a(this.node,{filter:e.url(i)})}r&&"none"!=r||(t.stop(),this.node.removeAttribute("filter"))}),e.filter.blur=function(t,n){null==t&&(t=2);var r=null==n?t:[t,n];return e.format('<feGaussianBlur stdDeviation="{def}"/>',{def:r})},e.filter.blur.toString=function(){return this()},e.filter.shadow=function(t,n,r,i,s){return"string"==typeof r&&(i=r,s=i,r=4),"string"!=typeof i&&(s=i,i="#000"),i=i||"#000",null==r&&(r=4),null==s&&(s=1),null==t&&(t=0,n=2),null==n&&(n=t),i=e.color(i),e.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:i,dx:t,dy:n,blur:r,opacity:s})},e.filter.shadow.toString=function(){return this()},e.filter.grayscale=function(t){return null==t&&(t=1),e.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-t),b:.7152-.7152*(1-t),c:.0722-.0722*(1-t),d:.2126-.2126*(1-t),e:.7152+.2848*(1-t),f:.0722-.0722*(1-t),g:.2126-.2126*(1-t),h:.0722+.9278*(1-t)})},e.filter.grayscale.toString=function(){return this()},e.filter.sepia=function(t){return null==t&&(t=1),e.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-t),b:.769-.769*(1-t),c:.189-.189*(1-t),d:.349-.349*(1-t),e:.686+.314*(1-t),f:.168-.168*(1-t),g:.272-.272*(1-t),h:.534-.534*(1-t),i:.131+.869*(1-t)})},e.filter.sepia.toString=function(){return this()},e.filter.saturate=function(t){return null==t&&(t=1),e.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-t})},e.filter.saturate.toString=function(){return this()},e.filter.hueRotate=function(t){return t=t||0,e.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:t})},e.filter.hueRotate.toString=function(){return this()},e.filter.invert=function(t){return null==t&&(t=1),e.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:t,amount2:1-t})},e.filter.invert.toString=function(){return this()},e.filter.brightness=function(t){return null==t&&(t=1),e.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:t})},e.filter.brightness.toString=function(){return this()},e.filter.contrast=function(t){return null==t&&(t=1),e.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:t,amount2:.5-t/2})},e.filter.contrast.toString=function(){return this()}}),r.plugin(function(e,t){var n=e._.box,r=e.is,i=/^[^a-z]*([tbmlrc])/i,s=function(){return"T"+this.dx+","+this.dy};t.prototype.getAlign=function(e,t){null==t&&r(e,"string")&&(t=e,e=null),e=e||this.paper;var o=e.getBBox?e.getBBox():n(e),a=this.getBBox(),l={};switch(t=t&&t.match(i),t=t?t[1].toLowerCase():"c"){case"t":l.dx=0,l.dy=o.y-a.y;break;case"b":l.dx=0,l.dy=o.y2-a.y2;break;case"m":l.dx=0,l.dy=o.cy-a.cy;break;case"l":l.dx=o.x-a.x,l.dy=0;break;case"r":l.dx=o.x2-a.x2,l.dy=0;break;default:l.dx=o.cx-a.cx,l.dy=0}return l.toString=s,l},t.prototype.align=function(e,t){return this.transform("..."+this.getAlign(e,t))}}),r}),function(){}.call(this);